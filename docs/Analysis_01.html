<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Supplementary Material : A multiplex bead-based immunoassay and data analysis pipeline for 12 markers of fever severity in dried blood spots - 14&nbsp; Data Analysis - A Tutorial based on the Mos-Def study</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./appendix.html" rel="next">
<link href="./Specimen_Testing.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Analysis_01.html"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Data Analysis - A Tutorial based on the Mos-Def study</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Supplementary Material : A multiplex bead-based immunoassay and data analysis pipeline for 12 markers of fever severity in dried blood spots</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A multiplex bead-based immunoassay and data analysis pipeline for 12 markers of fever severity in dried blood spots</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Marker_List.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">List of Markers</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Buffers_and_Reagents.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Buffers &amp; Reagents</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Capture_Antibody_Prep.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Capture Antibody Preparation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Bead_Coupling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Bead Coupling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Coupling_Confirmation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Coupling Confirmation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Detection_Antibody_Prep.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Detection Antibody Prep</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./antigens.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Antigens</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./antibody_pairs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Antibody pair screening</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Cross_Reactivity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Cross-reactivity Testing</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Standards_Prep.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Standard curves</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Magpix_Protocol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">MagPix Protocol</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Coefficients_of_Variation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Coefficients of Variation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Specimen_Testing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Specimen Testing</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Analysis_01.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Data Analysis - A Tutorial based on the Mos-Def study</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Funding &amp; Declarations</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./CRediT.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">CRediT Framework</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">14.1</span> Introduction</a></li>
  <li><a href="#note" id="toc-note" class="nav-link" data-scroll-target="#note"><span class="header-section-number">14.2</span> Note</a></li>
  <li><a href="#libraries" id="toc-libraries" class="nav-link" data-scroll-target="#libraries"><span class="header-section-number">14.3</span> Libraries</a></li>
  <li><a href="#define-functions" id="toc-define-functions" class="nav-link" data-scroll-target="#define-functions"><span class="header-section-number">14.4</span> Define Functions</a>
  <ul class="collapse">
  <li><a href="#read-and-analyse-luminex-plates" id="toc-read-and-analyse-luminex-plates" class="nav-link" data-scroll-target="#read-and-analyse-luminex-plates"><span class="header-section-number">14.4.1</span> Read and analyse Luminex Plates</a></li>
  </ul></li>
  <li><a href="#plate-setup-and-data-reading" id="toc-plate-setup-and-data-reading" class="nav-link" data-scroll-target="#plate-setup-and-data-reading"><span class="header-section-number">14.5</span> Plate Setup and data reading</a>
  <ul class="collapse">
  <li><a href="#setup-plate-data" id="toc-setup-plate-data" class="nav-link" data-scroll-target="#setup-plate-data"><span class="header-section-number">14.5.1</span> Setup Plate data</a></li>
  <li><a href="#run-first-plate" id="toc-run-first-plate" class="nav-link" data-scroll-target="#run-first-plate"><span class="header-section-number">14.5.2</span> Run first plate</a></li>
  <li><a href="#look-at-the-plate-1-standards-and-specimens" id="toc-look-at-the-plate-1-standards-and-specimens" class="nav-link" data-scroll-target="#look-at-the-plate-1-standards-and-specimens"><span class="header-section-number">14.5.3</span> Look at the plate 1 standards and specimens</a></li>
  <li><a href="#read-in-the-rest-of-the-plates" id="toc-read-in-the-rest-of-the-plates" class="nav-link" data-scroll-target="#read-in-the-rest-of-the-plates"><span class="header-section-number">14.5.4</span> Read in the rest of the plates</a></li>
  <li><a href="#chart-the-results-for-all-assays-on-all-plates" id="toc-chart-the-results-for-all-assays-on-all-plates" class="nav-link" data-scroll-target="#chart-the-results-for-all-assays-on-all-plates"><span class="header-section-number">14.5.5</span> Chart the results for all assays on all plates</a></li>
  </ul></li>
  <li><a href="#visualisation" id="toc-visualisation" class="nav-link" data-scroll-target="#visualisation"><span class="header-section-number">14.6</span> Visualisation</a>
  <ul class="collapse">
  <li><a href="#define-a-function-that-will-draw-a-chart-for-each-assay-showing-effects-of-normalisation-on-a-plate-by-plate-basis" id="toc-define-a-function-that-will-draw-a-chart-for-each-assay-showing-effects-of-normalisation-on-a-plate-by-plate-basis" class="nav-link" data-scroll-target="#define-a-function-that-will-draw-a-chart-for-each-assay-showing-effects-of-normalisation-on-a-plate-by-plate-basis"><span class="header-section-number">14.6.1</span> Define a function that will draw a chart for each assay, showing effects of normalisation on a plate-by-plate basis</a></li>
  <li><a href="#apply-the-function-to-all-assays" id="toc-apply-the-function-to-all-assays" class="nav-link" data-scroll-target="#apply-the-function-to-all-assays"><span class="header-section-number">14.6.2</span> Apply the function to all assays</a></li>
  </ul></li>
  <li><a href="#clinical-data" id="toc-clinical-data" class="nav-link" data-scroll-target="#clinical-data"><span class="header-section-number">14.7</span> Clinical data</a></li>
  <li><a href="#removing-bad-plates" id="toc-removing-bad-plates" class="nav-link" data-scroll-target="#removing-bad-plates"><span class="header-section-number">14.8</span> Removing bad plates</a></li>
  <li><a href="#reality-check" id="toc-reality-check" class="nav-link" data-scroll-target="#reality-check"><span class="header-section-number">14.9</span> Reality check</a></li>
  <li><a href="#analysis" id="toc-analysis" class="nav-link" data-scroll-target="#analysis"><span class="header-section-number">14.10</span> Analysis</a>
  <ul class="collapse">
  <li><a href="#expression-of-markers-in-different-clinical-classes-at-day-0" id="toc-expression-of-markers-in-different-clinical-classes-at-day-0" class="nav-link" data-scroll-target="#expression-of-markers-in-different-clinical-classes-at-day-0"><span class="header-section-number">14.10.1</span> Expression of markers in different clinical classes at day 0</a></li>
  <li><a href="#expression-of-markers-at-different-time-points" id="toc-expression-of-markers-at-different-time-points" class="nav-link" data-scroll-target="#expression-of-markers-at-different-time-points"><span class="header-section-number">14.10.2</span> Expression of markers at different time points</a></li>
  <li><a href="#towards-a-rapid-prognostic-test" id="toc-towards-a-rapid-prognostic-test" class="nav-link" data-scroll-target="#towards-a-rapid-prognostic-test"><span class="header-section-number">14.10.3</span> Towards a rapid prognostic test</a></li>
  </ul></li>
  <li><a href="#example-analysis-4-identifying-clusters-via-expectation-maximisation" id="toc-example-analysis-4-identifying-clusters-via-expectation-maximisation" class="nav-link" data-scroll-target="#example-analysis-4-identifying-clusters-via-expectation-maximisation"><span class="header-section-number">15</span> Example Analysis 4 : Identifying clusters via Expectation Maximisation</a></li>
  <li><a href="#example-analysis-5-identifying-clusters-via-principal-components-analysis-timepoints" id="toc-example-analysis-5-identifying-clusters-via-principal-components-analysis-timepoints" class="nav-link" data-scroll-target="#example-analysis-5-identifying-clusters-via-principal-components-analysis-timepoints"><span class="header-section-number">16</span> Example Analysis 5 : Identifying clusters via Principal Components Analysis : Timepoints</a></li>
  <li><a href="#example-analysis-6-identifying-clusters-via-principal-components-analysis-outcomes" id="toc-example-analysis-6-identifying-clusters-via-principal-components-analysis-outcomes" class="nav-link" data-scroll-target="#example-analysis-6-identifying-clusters-via-principal-components-analysis-outcomes"><span class="header-section-number">17</span> Example Analysis 6 : Identifying clusters via Principal Components Analysis : Outcomes</a>
  <ul class="collapse">
  <li><a href="#roc-analysis-with-pcs" id="toc-roc-analysis-with-pcs" class="nav-link" data-scroll-target="#roc-analysis-with-pcs"><span class="header-section-number">17.0.1</span> ROC analysis with PCs</a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">18</span> Summary</a></li>
  <li><a href="#acknowledgements" id="toc-acknowledgements" class="nav-link" data-scroll-target="#acknowledgements"><span class="header-section-number">19</span> Acknowledgements</a>
  <ul class="collapse">
  <li><a href="#note-on-open-licences" id="toc-note-on-open-licences" class="nav-link" data-scroll-target="#note-on-open-licences"><span class="header-section-number">19.1</span> Note on open licences</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Data Analysis - A Tutorial based on the Mos-Def study</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="introduction" class="level2" data-number="14.1">
<h2 data-number="14.1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">14.1</span> Introduction</h2>
<p>The first part of this analysis defines functions to read in a Luminex MagPix data file and analyse the data one assay at a time.</p>
<p>This requires a standards file to be provided (MOSDEF_Standard_Concs). It should look like the one below. Beware that the names of the assays and the names of the standards both need to match exactly to those in the data sets. Standard 8 is a background control (i.e.&nbsp;buffer blank). You could manually build this if you wanted to with the tibble command.</p>
<hr>
</section>
<section id="note" class="level2" data-number="14.2">
<h2 data-number="14.2" class="anchored" data-anchor-id="note"><span class="header-section-number">14.2</span> Note</h2>
<p>In this analysis, you will note that we sometimes refer to the marker <strong>CHI3L1</strong> as <strong>Chit.</strong> This was a local name for the marker which just made it easier for us to label tubes in the lab. The name Chit has no formal recognition and you should refer to this marker only by its correct name.</p>
</section>
<section id="libraries" class="level2" data-number="14.3">
<h2 data-number="14.3" class="anchored" data-anchor-id="libraries"><span class="header-section-number">14.3</span> Libraries</h2>
<p>Load the libraries used in this analysis and set a seed so that this is fully reproducible.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>standards <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">"data/MOSDEF_Standard_Concs.csv"</span>,<span class="at">show_col_types =</span> F)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(standards)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 10%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 10%">
<col style="width: 12%">
<col style="width: 13%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 3%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">assay</th>
<th style="text-align: left;">unit</th>
<th style="text-align: right;">S1</th>
<th style="text-align: right;">S2</th>
<th style="text-align: right;">S3</th>
<th style="text-align: right;">S4</th>
<th style="text-align: right;">S5</th>
<th style="text-align: right;">S6</th>
<th style="text-align: right;">S7</th>
<th style="text-align: right;">S8</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">CRP</td>
<td style="text-align: left;">pg_ml</td>
<td style="text-align: right;">10000</td>
<td style="text-align: right;">2500.0</td>
<td style="text-align: right;">625.000</td>
<td style="text-align: right;">156.25000</td>
<td style="text-align: right;">39.0625000</td>
<td style="text-align: right;">9.7656250</td>
<td style="text-align: right;">2.4414062</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">sTREM1</td>
<td style="text-align: left;">pg_ml</td>
<td style="text-align: right;">10000</td>
<td style="text-align: right;">2500.0</td>
<td style="text-align: right;">625.000</td>
<td style="text-align: right;">156.25000</td>
<td style="text-align: right;">39.0625000</td>
<td style="text-align: right;">9.7656250</td>
<td style="text-align: right;">2.4414062</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ang-2</td>
<td style="text-align: left;">ng_ml</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">25.0</td>
<td style="text-align: right;">6.250</td>
<td style="text-align: right;">1.56250</td>
<td style="text-align: right;">0.3906250</td>
<td style="text-align: right;">0.0976562</td>
<td style="text-align: right;">0.0244141</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ang-1</td>
<td style="text-align: left;">ng_ml</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">12.5</td>
<td style="text-align: right;">3.125</td>
<td style="text-align: right;">0.78125</td>
<td style="text-align: right;">0.1953125</td>
<td style="text-align: right;">0.0488281</td>
<td style="text-align: right;">0.0122070</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sTNF-R1</td>
<td style="text-align: left;">pg_ml</td>
<td style="text-align: right;">2500</td>
<td style="text-align: right;">625.0</td>
<td style="text-align: right;">156.250</td>
<td style="text-align: right;">39.06250</td>
<td style="text-align: right;">9.7656250</td>
<td style="text-align: right;">2.4414062</td>
<td style="text-align: right;">0.6103516</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">IL-6</td>
<td style="text-align: left;">pg_ml</td>
<td style="text-align: right;">10000</td>
<td style="text-align: right;">2500.0</td>
<td style="text-align: right;">625.000</td>
<td style="text-align: right;">156.25000</td>
<td style="text-align: right;">39.0625000</td>
<td style="text-align: right;">9.7656250</td>
<td style="text-align: right;">2.4414062</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TRAIL</td>
<td style="text-align: left;">pg_ml</td>
<td style="text-align: right;">10000</td>
<td style="text-align: right;">2500.0</td>
<td style="text-align: right;">625.000</td>
<td style="text-align: right;">156.25000</td>
<td style="text-align: right;">39.0625000</td>
<td style="text-align: right;">9.7656250</td>
<td style="text-align: right;">2.4414062</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">IL-10</td>
<td style="text-align: left;">pg_ml</td>
<td style="text-align: right;">4000</td>
<td style="text-align: right;">1000.0</td>
<td style="text-align: right;">250.000</td>
<td style="text-align: right;">62.50000</td>
<td style="text-align: right;">15.6250000</td>
<td style="text-align: right;">3.9062500</td>
<td style="text-align: right;">0.9765625</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Azu</td>
<td style="text-align: left;">ng_ml</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">50.0</td>
<td style="text-align: right;">12.500</td>
<td style="text-align: right;">3.12500</td>
<td style="text-align: right;">0.7812500</td>
<td style="text-align: right;">0.1953125</td>
<td style="text-align: right;">0.0488281</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">MxA</td>
<td style="text-align: left;">ng_ml</td>
<td style="text-align: right;">300</td>
<td style="text-align: right;">75.0</td>
<td style="text-align: right;">18.750</td>
<td style="text-align: right;">4.68750</td>
<td style="text-align: right;">1.1718750</td>
<td style="text-align: right;">0.2929688</td>
<td style="text-align: right;">0.0732422</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IP-10</td>
<td style="text-align: left;">pg_ml</td>
<td style="text-align: right;">10000</td>
<td style="text-align: right;">2500.0</td>
<td style="text-align: right;">625.000</td>
<td style="text-align: right;">156.25000</td>
<td style="text-align: right;">39.0625000</td>
<td style="text-align: right;">9.7656250</td>
<td style="text-align: right;">2.4414062</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Chit</td>
<td style="text-align: left;">ng_ml</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">25.0</td>
<td style="text-align: right;">6.250</td>
<td style="text-align: right;">1.56250</td>
<td style="text-align: right;">0.3906250</td>
<td style="text-align: right;">0.0976562</td>
<td style="text-align: right;">0.0244141</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IL-8</td>
<td style="text-align: left;">pg_ml</td>
<td style="text-align: right;">2500</td>
<td style="text-align: right;">625.0</td>
<td style="text-align: right;">156.250</td>
<td style="text-align: right;">39.06250</td>
<td style="text-align: right;">9.7656250</td>
<td style="text-align: right;">2.4414062</td>
<td style="text-align: right;">0.6103516</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(standards)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="define-functions" class="level2" data-number="14.4">
<h2 data-number="14.4" class="anchored" data-anchor-id="define-functions"><span class="header-section-number">14.4</span> Define Functions</h2>
<section id="read-and-analyse-luminex-plates" class="level3" data-number="14.4.1">
<h3 data-number="14.4.1" class="anchored" data-anchor-id="read-and-analyse-luminex-plates"><span class="header-section-number">14.4.1</span> Read and analyse Luminex Plates</h3>
<p>Note that there’s a section in this which creates a median/range normalised value. This could be useful under some circumstances, but you should think about the underlying assumptions if you are using something like this. For the most part, we can’t imagine that it would be helpful unless you were using a very high multiplex and/or had very rare cases among a huge control data set. For the most part, calibrating using the standard curve should be sufficient and the underlying assumption is not that the median values should be normalised/homogenised. You should therefore use <code>Estimate</code> rather than <code>Estimate.norm</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>luminex.process.data<span class="ot">&lt;-</span><span class="cf">function</span>(file,<span class="at">standards.file=</span><span class="st">"data/MOSDEF_Standard_Concs.csv"</span>){</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="do">######################################################################</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in data from luminex machine</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="do">######################################################################</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  df<span class="ot">&lt;-</span><span class="fu">read_csv</span>(file,<span class="at">skip =</span> <span class="dv">41</span>,<span class="at">na =</span> <span class="fu">c</span>(<span class="st">""</span>,<span class="st">"NA"</span>,<span class="st">"NaN"</span>),<span class="at">show_col_types =</span> F)<span class="sc">%&gt;%</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">setNames</span>(<span class="fu">tolower</span>(<span class="fu">gsub</span>(<span class="st">"-"</span>,<span class="st">"_"</span>,<span class="fu">names</span>(.)))) <span class="sc">%&gt;%</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mutate</span>(<span class="at">sample=</span> <span class="fu">fct_explicit_na</span>(sample)) <span class="sc">%&gt;%</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>                <span class="fu">select_if</span>(<span class="sc">!</span><span class="fu">names</span>(.) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">'...17'</span>, <span class="st">'location'</span>, <span class="st">'total events'</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>                <span class="fu">rename_at</span>(<span class="fu">vars</span>(<span class="fu">matches</span>(<span class="st">"^ch3l1$"</span>)), <span class="cf">function</span>(x) <span class="st">"chit"</span>)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="st">'crp'</span> <span class="sc">%in%</span> <span class="fu">names</span>(df) <span class="sc">==</span> <span class="cn">FALSE</span>){df<span class="sc">$</span>crp <span class="ot">&lt;-</span> <span class="cn">NA</span>} </span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="do">######################################################################</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Make function to create a unique ID for each test</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="do">######################################################################</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  randomid <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">n =</span> <span class="dv">1</span>) {</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">&lt;-</span> <span class="fu">do.call</span>(paste0, <span class="fu">replicate</span>(<span class="dv">5</span>, <span class="fu">sample</span>(LETTERS, n, <span class="cn">TRUE</span>), <span class="cn">FALSE</span>))</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(a, <span class="fu">sprintf</span>(<span class="st">"%04d"</span>, <span class="fu">sample</span>(<span class="dv">9999</span>, n, <span class="cn">TRUE</span>)), <span class="fu">sample</span>(LETTERS, n, <span class="cn">TRUE</span>))</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="do">######################################################################</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Make data tidy and then remove when beadcount is below 15 or when sample ID is missing</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Also assign a unique random ID to each test (deals with issues of duplicate names or replicate tests)</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="do">######################################################################</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>  MFI.medians<span class="ot">&lt;-</span> df[<span class="dv">1</span><span class="sc">:</span>(<span class="fu">which</span>(<span class="fu">str_detect</span>(<span class="at">string =</span> df<span class="sc">$</span>sample,<span class="at">pattern =</span> <span class="st">"Net MFI"</span>))[<span class="dv">1</span>]<span class="sc">-</span><span class="dv">1</span>),]  <span class="sc">%&gt;%</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mutate</span>(<span class="at">test.id=</span><span class="fu">randomid</span>(<span class="at">n=</span><span class="fu">nrow</span>(.))) <span class="sc">%&gt;%</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>                <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">14</span>, <span class="at">names_to =</span> <span class="st">"assay"</span>, <span class="at">values_to =</span> <span class="st">"mfi"</span>)</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>  MFI.counts<span class="ot">&lt;-</span> df[((<span class="fu">which</span>(<span class="fu">str_detect</span>(<span class="at">string =</span> df<span class="sc">$</span>sample,<span class="at">pattern =</span> <span class="st">"Count"</span>)))[<span class="dv">1</span>]<span class="sc">+</span><span class="dv">2</span>)<span class="sc">:</span>(<span class="fu">which</span>(<span class="fu">str_detect</span>(<span class="at">string =</span> df<span class="sc">$</span>sample,<span class="at">pattern =</span> <span class="st">"Avg Net MFI"</span>))[<span class="dv">1</span>]<span class="sc">-</span><span class="dv">1</span>),] <span class="sc">%&gt;%</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>                <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">14</span>, <span class="at">names_to =</span> <span class="st">"assay"</span>, <span class="at">values_to =</span> <span class="st">"bead.count"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mutate</span>(<span class="at">test.id=</span>MFI.medians<span class="sc">$</span>test.id)</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>  df<span class="ot">&lt;-</span> <span class="fu">full_join</span>(MFI.medians,MFI.counts) <span class="sc">%&gt;%</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mutate</span>(</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>                      <span class="at">mfi =</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(mfi)),</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>                      <span class="at">bead.count =</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(bead.count))</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>                      ) <span class="sc">%&gt;%</span></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>                      sample<span class="sc">!=</span><span class="st">"(Missing)"</span>,</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>                      sample<span class="sc">!=</span><span class="st">"NA"</span>,</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>                      sample<span class="sc">!=</span><span class="st">"Na"</span>,</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>                      sample<span class="sc">!=</span><span class="st">"NULL"</span>,</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>                      bead.count<span class="sc">&gt;</span><span class="dv">15</span>,</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>                      <span class="sc">!</span><span class="fu">is.na</span>(mfi)</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>                      )</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>  <span class="do">######################################################################</span></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Bind standards from file</span></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>  <span class="do">######################################################################</span></span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>   standards<span class="ot">&lt;-</span><span class="fu">read_csv</span>(standards.file,<span class="at">show_col_types =</span> F) <span class="sc">%&gt;%</span></span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">pivot_longer</span>(<span class="at">cols=</span>S1<span class="sc">:</span>S8, <span class="at">names_to =</span> <span class="st">"sample"</span>, <span class="at">values_to =</span> <span class="st">"conc"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">mutate</span>(</span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>                            <span class="at">conc =</span> <span class="fu">as.numeric</span>(</span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>                                              <span class="fu">case_when</span>(</span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>                                                        unit<span class="sc">==</span><span class="st">'ng_ml'</span> <span class="sc">~</span> conc <span class="sc">*</span> <span class="dv">1000</span>,</span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>                                                        <span class="cn">TRUE</span> <span class="sc">~</span> conc</span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>                                                        )</span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>                                              ),</span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>                            <span class="at">assay=</span><span class="fu">tolower</span>(assay),</span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>                            <span class="at">assay=</span><span class="fu">gsub</span>(<span class="at">x =</span> assay,<span class="at">pattern =</span> <span class="st">"-"</span>,<span class="at">replacement =</span> <span class="st">"_"</span>)</span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>                            ) <span class="sc">%&gt;%</span></span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">select</span>(<span class="sc">-</span>unit) <span class="sc">%&gt;%</span></span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">mutate</span>(<span class="at">class=</span><span class="st">"standard"</span>)</span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">left_join</span>(df,standards)</span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>  df<span class="sc">$</span>class[<span class="fu">which</span>(<span class="fu">is.na</span>(df<span class="sc">$</span>class))]<span class="ot">&lt;-</span><span class="st">"specimen"</span> </span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a>  <span class="do">################################################################################</span></span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a>  <span class="do">################################################################################</span></span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Nested function to predict relative concentrations in a curve</span></span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a>  <span class="do">################################################################################</span></span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a>  <span class="do">################################################################################</span></span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a>  luminex.standard.curve.estimator<span class="ot">&lt;-</span><span class="cf">function</span>(data,test.assay){</span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">filter</span>(data,assay <span class="sc">==</span> test.assay)       <span class="co"># filter the data to the current assay (test.assay)</span></span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a>  bg <span class="ot">&lt;-</span> <span class="fu">filter</span>(x,sample<span class="sc">==</span><span class="st">"S8"</span>)              <span class="co"># get value of background from standard 8 (buffer blank)</span></span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span> <span class="fu">mutate</span>(x, <span class="at">bg=</span> <span class="fu">min</span>(bg<span class="sc">$</span>mfi,<span class="at">na.rm =</span> T))  <span class="co"># set the background value for all lines of data to the minium value of standard 8</span></span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a>  tp <span class="ot">&lt;-</span> <span class="fu">filter</span>(x,sample<span class="sc">==</span><span class="st">"S1"</span>)              <span class="co"># get highest value of the curve from standard 1</span></span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">mutate</span>(x,<span class="at">tp=</span><span class="fu">max</span>(tp<span class="sc">$</span>mfi,<span class="at">na.rm =</span> T))   <span class="co"># set the top value for all lines of data using tp</span></span>
<span id="cb3-85"><a href="#cb3-85" aria-hidden="true" tabindex="-1"></a>  mn <span class="ot">&lt;-</span> <span class="fu">filter</span>(x,sample<span class="sc">==</span><span class="st">"S7"</span>)              <span class="co"># get lowest value of the curve from standard 7</span></span>
<span id="cb3-86"><a href="#cb3-86" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">mutate</span>(x,<span class="at">mn=</span><span class="fu">min</span>(mn<span class="sc">$</span>mfi,<span class="at">na.rm =</span> T))   <span class="co"># set the bottom value for all lines of data using mn</span></span>
<span id="cb3-87"><a href="#cb3-87" aria-hidden="true" tabindex="-1"></a>  <span class="co"># DON'T subtract background from MFI - In tests it worked better this way</span></span>
<span id="cb3-88"><a href="#cb3-88" aria-hidden="true" tabindex="-1"></a>  <span class="co"># For other data sets, it may be worth doing this</span></span>
<span id="cb3-89"><a href="#cb3-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-90"><a href="#cb3-90" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> x <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb3-91"><a href="#cb3-91" aria-hidden="true" tabindex="-1"></a>                    <span class="at">log10.mfi =</span> <span class="fu">log10</span>(mfi), <span class="co"># log transform mfi data</span></span>
<span id="cb3-92"><a href="#cb3-92" aria-hidden="true" tabindex="-1"></a>                    <span class="at">conc=</span><span class="fu">log10</span>(conc)        <span class="co"># log transform the standard concentration data</span></span>
<span id="cb3-93"><a href="#cb3-93" aria-hidden="true" tabindex="-1"></a>                    ) <span class="sc">%&gt;%</span></span>
<span id="cb3-94"><a href="#cb3-94" aria-hidden="true" tabindex="-1"></a>             <span class="fu">filter</span>(sample<span class="sc">!=</span><span class="st">"S8"</span>)           <span class="co"># remove standard 8 (background, which isn't used again)   </span></span>
<span id="cb3-95"><a href="#cb3-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-96"><a href="#cb3-96" aria-hidden="true" tabindex="-1"></a>    x.standards<span class="ot">&lt;-</span>x <span class="sc">%&gt;%</span> <span class="fu">filter</span>(class<span class="sc">==</span><span class="st">"standard"</span>,log10.mfi<span class="sc">&gt;=</span><span class="dv">0</span>) <span class="co"># Get standards only, and remove any spurious values with negative mfi</span></span>
<span id="cb3-97"><a href="#cb3-97" aria-hidden="true" tabindex="-1"></a>    <span class="co"># in practice this will only happen if subtracting background from mfi, which isn't done here. This line is to remind future users</span></span>
<span id="cb3-98"><a href="#cb3-98" aria-hidden="true" tabindex="-1"></a>    <span class="co"># that they should probably do this, or do something bout negative values, like set them to zero.</span></span>
<span id="cb3-99"><a href="#cb3-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-100"><a href="#cb3-100" aria-hidden="true" tabindex="-1"></a>    x.samples<span class="ot">&lt;-</span>x <span class="sc">%&gt;%</span> <span class="fu">filter</span>(class<span class="sc">!=</span><span class="st">"standard"</span>,log10.mfi<span class="sc">&gt;=</span><span class="dv">0</span>)   <span class="co"># Get specimens only</span></span>
<span id="cb3-101"><a href="#cb3-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-102"><a href="#cb3-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-103"><a href="#cb3-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-104"><a href="#cb3-104" aria-hidden="true" tabindex="-1"></a>  <span class="co"># run dose response model (drm command from drc package, see helpfiles for info)</span></span>
<span id="cb3-105"><a href="#cb3-105" aria-hidden="true" tabindex="-1"></a>  model1<span class="ot">&lt;-</span><span class="fu">drm</span>(conc<span class="sc">~</span>log10.mfi,</span>
<span id="cb3-106"><a href="#cb3-106" aria-hidden="true" tabindex="-1"></a>              <span class="at">fct=</span><span class="fu">LL.4</span>(<span class="at">names=</span><span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower"</span>, <span class="st">"Upper"</span>, <span class="st">"ED50"</span>)),</span>
<span id="cb3-107"><a href="#cb3-107" aria-hidden="true" tabindex="-1"></a>              <span class="at">data=</span>x.standards)</span>
<span id="cb3-108"><a href="#cb3-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-109"><a href="#cb3-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-110"><a href="#cb3-110" aria-hidden="true" tabindex="-1"></a>  <span class="co"># get the predicted values of concentration from the measured values of the experimental specimens</span></span>
<span id="cb3-111"><a href="#cb3-111" aria-hidden="true" tabindex="-1"></a>  <span class="co"># also create the normalised estimate of the same. </span></span>
<span id="cb3-112"><a href="#cb3-112" aria-hidden="true" tabindex="-1"></a>  <span class="co"># normalisation used here is (Estimate - median of all Estimates) / 95th centile of range of values</span></span>
<span id="cb3-113"><a href="#cb3-113" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span>x <span class="sc">%&gt;%</span></span>
<span id="cb3-114"><a href="#cb3-114" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb3-115"><a href="#cb3-115" aria-hidden="true" tabindex="-1"></a>      <span class="at">Estimate =</span> <span class="fu">predict</span>(model1,<span class="fu">data.frame</span>(<span class="at">log10.mfi=</span>x<span class="sc">$</span>log10.mfi)),</span>
<span id="cb3-116"><a href="#cb3-116" aria-hidden="true" tabindex="-1"></a>      <span class="at">Estimate.norm =</span> (Estimate <span class="sc">-</span> <span class="fu">median</span>(Estimate,<span class="at">na.rm=</span>T))<span class="sc">/</span>(<span class="fu">quantile</span>(Estimate,<span class="fl">0.95</span>) <span class="sc">-</span> <span class="fu">quantile</span>(Estimate,<span class="fl">0.05</span>))</span>
<span id="cb3-117"><a href="#cb3-117" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb3-118"><a href="#cb3-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-119"><a href="#cb3-119" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(x) <span class="co"># Return the estimate and normalised estimate to the parent function</span></span>
<span id="cb3-120"><a href="#cb3-120" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-121"><a href="#cb3-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-122"><a href="#cb3-122" aria-hidden="true" tabindex="-1"></a>  <span class="do">######################################################################</span></span>
<span id="cb3-123"><a href="#cb3-123" aria-hidden="true" tabindex="-1"></a>  <span class="co"># run the standard curves for all assays</span></span>
<span id="cb3-124"><a href="#cb3-124" aria-hidden="true" tabindex="-1"></a>  <span class="do">######################################################################</span></span>
<span id="cb3-125"><a href="#cb3-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-126"><a href="#cb3-126" aria-hidden="true" tabindex="-1"></a>  unique.assays<span class="ot">&lt;-</span><span class="fu">unique</span>(df<span class="sc">$</span>assay) <span class="co"># gets a list of the unique assays in the study</span></span>
<span id="cb3-127"><a href="#cb3-127" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-128"><a href="#cb3-128" aria-hidden="true" tabindex="-1"></a>  <span class="co">#run the luminex.standard.curve.estimator function on assay 1, creating a data set called df.out</span></span>
<span id="cb3-129"><a href="#cb3-129" aria-hidden="true" tabindex="-1"></a>  df.out<span class="ot">&lt;-</span><span class="fu">luminex.standard.curve.estimator</span>(<span class="at">data =</span> df,<span class="at">test.assay =</span> unique.assays[<span class="dv">1</span>]) </span>
<span id="cb3-130"><a href="#cb3-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-131"><a href="#cb3-131" aria-hidden="true" tabindex="-1"></a>  <span class="co">#run the luminex.standard.curve.estimator function on assays 2-n, binding returned dfs to df.out</span></span>
<span id="cb3-132"><a href="#cb3-132" aria-hidden="true" tabindex="-1"></a> <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(unique.assays)){</span>
<span id="cb3-133"><a href="#cb3-133" aria-hidden="true" tabindex="-1"></a>                                  df.out<span class="ot">&lt;-</span><span class="fu">bind_rows</span>(df.out,<span class="fu">luminex.standard.curve.estimator</span>(<span class="at">data =</span> df,<span class="at">test.assay =</span> unique.assays[i]))</span>
<span id="cb3-134"><a href="#cb3-134" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb3-135"><a href="#cb3-135" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-136"><a href="#cb3-136" aria-hidden="true" tabindex="-1"></a>  <span class="do">######################################################################</span></span>
<span id="cb3-137"><a href="#cb3-137" aria-hidden="true" tabindex="-1"></a>  <span class="co"># get plate name from file name</span></span>
<span id="cb3-138"><a href="#cb3-138" aria-hidden="true" tabindex="-1"></a>  <span class="do">######################################################################</span></span>
<span id="cb3-139"><a href="#cb3-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-140"><a href="#cb3-140" aria-hidden="true" tabindex="-1"></a>  plate <span class="ot">=</span> <span class="fu">str_replace</span>(<span class="at">string =</span> file,<span class="at">pattern =</span>  <span class="st">"data_in//"</span>,<span class="at">replacement =</span> <span class="st">""</span>) <span class="co"># remove pathname</span></span>
<span id="cb3-141"><a href="#cb3-141" aria-hidden="true" tabindex="-1"></a>  plate <span class="ot">=</span> <span class="fu">str_replace</span>(<span class="at">string =</span> plate,<span class="at">pattern =</span>  <span class="st">".csv"</span>,<span class="at">replacement =</span> <span class="st">""</span>)     <span class="co"># remove file extension</span></span>
<span id="cb3-142"><a href="#cb3-142" aria-hidden="true" tabindex="-1"></a>  df.out<span class="sc">$</span>plate<span class="ot">&lt;-</span>plate                                                        <span class="co"># add plate name to the df</span></span>
<span id="cb3-143"><a href="#cb3-143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df.out)                                                             <span class="co"># return df, which has processed all assays for the plate</span></span>
<span id="cb3-144"><a href="#cb3-144" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="plate-setup-and-data-reading" class="level2" data-number="14.5">
<h2 data-number="14.5" class="anchored" data-anchor-id="plate-setup-and-data-reading"><span class="header-section-number">14.5</span> Plate Setup and data reading</h2>
<section id="setup-plate-data" class="level3" data-number="14.5.1">
<h3 data-number="14.5.1" class="anchored" data-anchor-id="setup-plate-data"><span class="header-section-number">14.5.1</span> Setup Plate data</h3>
<p>List all the Luminex plate data files in a folder</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>c.files<span class="ot">&lt;-</span><span class="fu">list.files</span>(<span class="st">"data/luminex_files/"</span>,<span class="at">pattern =</span> <span class="st">".csv"</span>,<span class="at">full.names =</span> T)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">unlist</span>(c.files))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">data/luminex_files//plate_01.csv</td>
</tr>
<tr class="even">
<td style="text-align: left;">data/luminex_files//plate_02.csv</td>
</tr>
<tr class="odd">
<td style="text-align: left;">data/luminex_files//plate_03.csv</td>
</tr>
<tr class="even">
<td style="text-align: left;">data/luminex_files//plate_04.csv</td>
</tr>
<tr class="odd">
<td style="text-align: left;">data/luminex_files//plate_05.csv</td>
</tr>
<tr class="even">
<td style="text-align: left;">data/luminex_files//plate_06.csv</td>
</tr>
<tr class="odd">
<td style="text-align: left;">data/luminex_files//plate_07.csv</td>
</tr>
<tr class="even">
<td style="text-align: left;">data/luminex_files//plate_08.csv</td>
</tr>
<tr class="odd">
<td style="text-align: left;">data/luminex_files//plate_09.csv</td>
</tr>
<tr class="even">
<td style="text-align: left;">data/luminex_files//plate_10.csv</td>
</tr>
<tr class="odd">
<td style="text-align: left;">data/luminex_files//plate_11.csv</td>
</tr>
<tr class="even">
<td style="text-align: left;">data/luminex_files//plate_12.csv</td>
</tr>
<tr class="odd">
<td style="text-align: left;">data/luminex_files//plate_13.csv</td>
</tr>
<tr class="even">
<td style="text-align: left;">data/luminex_files//plate_14.csv</td>
</tr>
<tr class="odd">
<td style="text-align: left;">data/luminex_files//plate_15.csv</td>
</tr>
<tr class="even">
<td style="text-align: left;">data/luminex_files//plate_16.csv</td>
</tr>
<tr class="odd">
<td style="text-align: left;">data/luminex_files//plate_17.csv</td>
</tr>
<tr class="even">
<td style="text-align: left;">data/luminex_files//plate_18.csv</td>
</tr>
<tr class="odd">
<td style="text-align: left;">data/luminex_files//plate_19.csv</td>
</tr>
<tr class="even">
<td style="text-align: left;">data/luminex_files//plate_20.csv</td>
</tr>
<tr class="odd">
<td style="text-align: left;">data/luminex_files//plate_21.csv</td>
</tr>
<tr class="even">
<td style="text-align: left;">data/luminex_files//plate_22.csv</td>
</tr>
<tr class="odd">
<td style="text-align: left;">data/luminex_files//plate_23.csv</td>
</tr>
<tr class="even">
<td style="text-align: left;">data/luminex_files//plate_24.csv</td>
</tr>
<tr class="odd">
<td style="text-align: left;">data/luminex_files//plate_25.csv</td>
</tr>
<tr class="even">
<td style="text-align: left;">data/luminex_files//plate_26.csv</td>
</tr>
<tr class="odd">
<td style="text-align: left;">data/luminex_files//plate_27.csv</td>
</tr>
<tr class="even">
<td style="text-align: left;">data/luminex_files//plate_28.csv</td>
</tr>
<tr class="odd">
<td style="text-align: left;">data/luminex_files//plate_29.csv</td>
</tr>
<tr class="even">
<td style="text-align: left;">data/luminex_files//plate_30.csv</td>
</tr>
<tr class="odd">
<td style="text-align: left;">data/luminex_files//plate_31.csv</td>
</tr>
<tr class="even">
<td style="text-align: left;">data/luminex_files//plate_32.csv</td>
</tr>
<tr class="odd">
<td style="text-align: left;">data/luminex_files//plate_33.csv</td>
</tr>
<tr class="even">
<td style="text-align: left;">data/luminex_files//plate_34.csv</td>
</tr>
<tr class="odd">
<td style="text-align: left;">data/luminex_files//plate_40.csv</td>
</tr>
<tr class="even">
<td style="text-align: left;">data/luminex_files//plate_41.csv</td>
</tr>
<tr class="odd">
<td style="text-align: left;">data/luminex_files//plate_42.csv</td>
</tr>
<tr class="even">
<td style="text-align: left;">data/luminex_files//plate_43.csv</td>
</tr>
<tr class="odd">
<td style="text-align: left;">data/luminex_files//plate_44.csv</td>
</tr>
<tr class="even">
<td style="text-align: left;">data/luminex_files//plate_45.csv</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="run-first-plate" class="level3" data-number="14.5.2">
<h3 data-number="14.5.2" class="anchored" data-anchor-id="run-first-plate"><span class="header-section-number">14.5.2</span> Run first plate</h3>
<div class="cell" data-paged.print="true">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">suppressMessages</span>(<span class="fu">luminex.process.data</span>(<span class="at">file =</span> c.files[<span class="dv">1</span>],<span class="at">standards.file =</span> <span class="st">"data/MOSDEF_Standard_Concs.csv"</span>))</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">tail</span>(a,<span class="dv">100</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 4%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 5%">
<col style="width: 6%">
<col style="width: 2%">
<col style="width: 4%">
<col style="width: 2%">
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 10%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">sample</th>
<th style="text-align: left;">test.id</th>
<th style="text-align: left;">assay</th>
<th style="text-align: right;">mfi</th>
<th style="text-align: right;">bead.count</th>
<th style="text-align: right;">conc</th>
<th style="text-align: left;">class</th>
<th style="text-align: right;">bg</th>
<th style="text-align: right;">tp</th>
<th style="text-align: right;">mn</th>
<th style="text-align: right;">log10.mfi</th>
<th style="text-align: right;">Estimate</th>
<th style="text-align: right;">Estimate.norm</th>
<th style="text-align: left;">plate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">LA13044CFP</td>
<td style="text-align: left;">SWXZA6598N</td>
<td style="text-align: left;">mxa</td>
<td style="text-align: right;">400.0</td>
<td style="text-align: right;">147</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">130</td>
<td style="text-align: right;">21363</td>
<td style="text-align: right;">173</td>
<td style="text-align: right;">2.602060</td>
<td style="text-align: right;">2.403529</td>
<td style="text-align: right;">-0.0233599</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA13047CFP</td>
<td style="text-align: left;">NPDXB8563J</td>
<td style="text-align: left;">mxa</td>
<td style="text-align: right;">279.0</td>
<td style="text-align: right;">134</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">130</td>
<td style="text-align: right;">21363</td>
<td style="text-align: right;">173</td>
<td style="text-align: right;">2.445604</td>
<td style="text-align: right;">2.228882</td>
<td style="text-align: right;">-0.0966426</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA13044FP</td>
<td style="text-align: left;">PEVIK2267H</td>
<td style="text-align: left;">mxa</td>
<td style="text-align: right;">705.0</td>
<td style="text-align: right;">212</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">130</td>
<td style="text-align: right;">21363</td>
<td style="text-align: right;">173</td>
<td style="text-align: right;">2.848189</td>
<td style="text-align: right;">2.708080</td>
<td style="text-align: right;">0.1044319</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA13046FP</td>
<td style="text-align: left;">XFJNU8182S</td>
<td style="text-align: left;">mxa</td>
<td style="text-align: right;">1274.0</td>
<td style="text-align: right;">195</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">130</td>
<td style="text-align: right;">21363</td>
<td style="text-align: right;">173</td>
<td style="text-align: right;">3.105169</td>
<td style="text-align: right;">3.064583</td>
<td style="text-align: right;">0.2540229</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA13046CFP</td>
<td style="text-align: left;">OQKJI1993Q</td>
<td style="text-align: left;">mxa</td>
<td style="text-align: right;">433.0</td>
<td style="text-align: right;">162</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">130</td>
<td style="text-align: right;">21363</td>
<td style="text-align: right;">173</td>
<td style="text-align: right;">2.636488</td>
<td style="text-align: right;">2.443939</td>
<td style="text-align: right;">-0.0064036</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA12587CFP</td>
<td style="text-align: left;">DYKJQ0547B</td>
<td style="text-align: left;">mxa</td>
<td style="text-align: right;">332.5</td>
<td style="text-align: right;">166</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">130</td>
<td style="text-align: right;">21363</td>
<td style="text-align: right;">173</td>
<td style="text-align: right;">2.521792</td>
<td style="text-align: right;">2.312086</td>
<td style="text-align: right;">-0.0617298</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">S1</td>
<td style="text-align: left;">KUGAX1968M</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">47395.0</td>
<td style="text-align: right;">164</td>
<td style="text-align: right;">5.00000</td>
<td style="text-align: left;">standard</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.675732</td>
<td style="text-align: right;">4.596514</td>
<td style="text-align: right;">0.2284418</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="even">
<td style="text-align: left;">S2</td>
<td style="text-align: left;">YCIPI4839P</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">43295.5</td>
<td style="text-align: right;">146</td>
<td style="text-align: right;">4.39794</td>
<td style="text-align: left;">standard</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.636443</td>
<td style="text-align: right;">4.534911</td>
<td style="text-align: right;">0.1997272</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">S3</td>
<td style="text-align: left;">HXARC3921M</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">24411.5</td>
<td style="text-align: right;">162</td>
<td style="text-align: right;">3.79588</td>
<td style="text-align: left;">standard</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.387594</td>
<td style="text-align: right;">4.154074</td>
<td style="text-align: right;">0.0222096</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="even">
<td style="text-align: left;">S4</td>
<td style="text-align: left;">RENFU0997O</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">5922.0</td>
<td style="text-align: right;">184</td>
<td style="text-align: right;">3.19382</td>
<td style="text-align: left;">standard</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">3.772468</td>
<td style="text-align: right;">3.288581</td>
<td style="text-align: right;">-0.3812183</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">S5</td>
<td style="text-align: left;">FAPGM9685C</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">957.0</td>
<td style="text-align: right;">169</td>
<td style="text-align: right;">2.59176</td>
<td style="text-align: left;">standard</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">2.980912</td>
<td style="text-align: right;">2.356713</td>
<td style="text-align: right;">-0.8155851</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="even">
<td style="text-align: left;">S6</td>
<td style="text-align: left;">HYMGE3339V</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">266.0</td>
<td style="text-align: right;">77</td>
<td style="text-align: right;">1.98970</td>
<td style="text-align: left;">standard</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">2.424882</td>
<td style="text-align: right;">1.838670</td>
<td style="text-align: right;">-1.0570577</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">S7</td>
<td style="text-align: left;">VVBAO6795F</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">126.5</td>
<td style="text-align: right;">174</td>
<td style="text-align: right;">1.38764</td>
<td style="text-align: left;">standard</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">2.102091</td>
<td style="text-align: right;">1.592458</td>
<td style="text-align: right;">-1.1718236</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="even">
<td style="text-align: left;">S1</td>
<td style="text-align: left;">LVIWY2295U</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">45946.0</td>
<td style="text-align: right;">127</td>
<td style="text-align: right;">5.00000</td>
<td style="text-align: left;">standard</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.662248</td>
<td style="text-align: right;">4.575327</td>
<td style="text-align: right;">0.2185661</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">S2</td>
<td style="text-align: left;">LJANW6592I</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">44417.0</td>
<td style="text-align: right;">139</td>
<td style="text-align: right;">4.39794</td>
<td style="text-align: left;">standard</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.647549</td>
<td style="text-align: right;">4.552285</td>
<td style="text-align: right;">0.2078258</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="even">
<td style="text-align: left;">S3</td>
<td style="text-align: left;">UKRAL2169L</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">22638.0</td>
<td style="text-align: right;">110</td>
<td style="text-align: right;">3.79588</td>
<td style="text-align: left;">standard</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.354838</td>
<td style="text-align: right;">4.105187</td>
<td style="text-align: right;">-0.0005778</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">S4</td>
<td style="text-align: left;">EGSNN8900J</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">5999.0</td>
<td style="text-align: right;">159</td>
<td style="text-align: right;">3.19382</td>
<td style="text-align: left;">standard</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">3.778079</td>
<td style="text-align: right;">3.295948</td>
<td style="text-align: right;">-0.3777844</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="even">
<td style="text-align: left;">S5</td>
<td style="text-align: left;">JBVKY4698E</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">1022.5</td>
<td style="text-align: right;">208</td>
<td style="text-align: right;">2.59176</td>
<td style="text-align: left;">standard</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">3.009663</td>
<td style="text-align: right;">2.386661</td>
<td style="text-align: right;">-0.8016254</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">S6</td>
<td style="text-align: left;">KOCQE8393Q</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">274.5</td>
<td style="text-align: right;">210</td>
<td style="text-align: right;">1.98970</td>
<td style="text-align: left;">standard</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">2.438542</td>
<td style="text-align: right;">1.849982</td>
<td style="text-align: right;">-1.0517849</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="even">
<td style="text-align: left;">S7</td>
<td style="text-align: left;">UGOYG8637W</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">124.0</td>
<td style="text-align: right;">172</td>
<td style="text-align: right;">1.38764</td>
<td style="text-align: left;">standard</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">2.093422</td>
<td style="text-align: right;">1.586405</td>
<td style="text-align: right;">-1.1746450</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA11033FP</td>
<td style="text-align: left;">SHGKD1852U</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">9166.0</td>
<td style="text-align: right;">176</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">3.962180</td>
<td style="text-align: right;">3.543253</td>
<td style="text-align: right;">-0.2625092</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA11039FP</td>
<td style="text-align: left;">ILAID4151N</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">31025.5</td>
<td style="text-align: right;">196</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.491719</td>
<td style="text-align: right;">4.311424</td>
<td style="text-align: right;">0.0955542</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA11037CFP</td>
<td style="text-align: left;">VGHJM4359F</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">11562.0</td>
<td style="text-align: right;">196</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.063033</td>
<td style="text-align: right;">3.683213</td>
<td style="text-align: right;">-0.1972705</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA11039CFP</td>
<td style="text-align: left;">KOANM9309M</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">22870.0</td>
<td style="text-align: right;">196</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.359266</td>
<td style="text-align: right;">4.111778</td>
<td style="text-align: right;">0.0024946</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA11037FP</td>
<td style="text-align: left;">EGPPE6968D</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">15636.5</td>
<td style="text-align: right;">218</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.194140</td>
<td style="text-align: right;">3.869739</td>
<td style="text-align: right;">-0.1103259</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA11036CFP</td>
<td style="text-align: left;">LWPQA3913Y</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">35098.5</td>
<td style="text-align: right;">194</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.545289</td>
<td style="text-align: right;">4.393510</td>
<td style="text-align: right;">0.1338168</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA11036FP</td>
<td style="text-align: left;">WIUSH3317X</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">39089.0</td>
<td style="text-align: right;">179</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.592055</td>
<td style="text-align: right;">4.465787</td>
<td style="text-align: right;">0.1675067</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA11034CFP</td>
<td style="text-align: left;">HASCA4592S</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">7312.0</td>
<td style="text-align: right;">192</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">3.864036</td>
<td style="text-align: right;">3.410079</td>
<td style="text-align: right;">-0.3245851</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA11040FP</td>
<td style="text-align: left;">STYAL4876A</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">33963.0</td>
<td style="text-align: right;">123</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.531006</td>
<td style="text-align: right;">4.371550</td>
<td style="text-align: right;">0.1235809</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA11034FP</td>
<td style="text-align: left;">HLPGU1397F</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">9173.0</td>
<td style="text-align: right;">160</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">3.962511</td>
<td style="text-align: right;">3.543708</td>
<td style="text-align: right;">-0.2622971</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA11033CFP</td>
<td style="text-align: left;">UPJRU9129S</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">14845.0</td>
<td style="text-align: right;">169</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.171580</td>
<td style="text-align: right;">3.837282</td>
<td style="text-align: right;">-0.1254552</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA11040CFP</td>
<td style="text-align: left;">JVOSI1587O</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">7597.0</td>
<td style="text-align: right;">162</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">3.880642</td>
<td style="text-align: right;">3.432399</td>
<td style="text-align: right;">-0.3141810</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA12027CFP</td>
<td style="text-align: left;">FCIFG0648D</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">34638.0</td>
<td style="text-align: right;">157</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.539553</td>
<td style="text-align: right;">4.384685</td>
<td style="text-align: right;">0.1297031</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA12027FP</td>
<td style="text-align: left;">HJYDE3625F</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">17165.5</td>
<td style="text-align: right;">162</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.234656</td>
<td style="text-align: right;">3.928406</td>
<td style="text-align: right;">-0.0829800</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA12026CFP</td>
<td style="text-align: left;">VRHCL9504V</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">28559.0</td>
<td style="text-align: right;">171</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.455743</td>
<td style="text-align: right;">4.256726</td>
<td style="text-align: right;">0.0700583</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA12026FP</td>
<td style="text-align: left;">VAYHW1782L</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">37131.0</td>
<td style="text-align: right;">208</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.569737</td>
<td style="text-align: right;">4.431223</td>
<td style="text-align: right;">0.1513959</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA12024CFP</td>
<td style="text-align: left;">NPLGF7754K</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">28885.0</td>
<td style="text-align: right;">151</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.460672</td>
<td style="text-align: right;">4.264200</td>
<td style="text-align: right;">0.0735421</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA12022CFP</td>
<td style="text-align: left;">JQKTV5449U</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">34388.0</td>
<td style="text-align: right;">159</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.536407</td>
<td style="text-align: right;">4.379848</td>
<td style="text-align: right;">0.1274486</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA12024FP</td>
<td style="text-align: left;">FOLVC5757H</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">33679.0</td>
<td style="text-align: right;">171</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.527359</td>
<td style="text-align: right;">4.365952</td>
<td style="text-align: right;">0.1209713</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA12028FP</td>
<td style="text-align: left;">YDITP1935G</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">13637.5</td>
<td style="text-align: right;">172</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.134735</td>
<td style="text-align: right;">3.784591</td>
<td style="text-align: right;">-0.1500154</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA12021CFP</td>
<td style="text-align: left;">QBWQM4347F</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">18157.0</td>
<td style="text-align: right;">161</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.259044</td>
<td style="text-align: right;">3.963946</td>
<td style="text-align: right;">-0.0664136</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA12028CFP</td>
<td style="text-align: left;">ZZIZF0455C</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">26270.0</td>
<td style="text-align: right;">181</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.419460</td>
<td style="text-align: right;">4.201915</td>
<td style="text-align: right;">0.0445097</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA12022FP</td>
<td style="text-align: left;">WTCZZ6985E</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">27339.0</td>
<td style="text-align: right;">183</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.436783</td>
<td style="text-align: right;">4.228039</td>
<td style="text-align: right;">0.0566866</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA12021FP</td>
<td style="text-align: left;">OIXZA0659A</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">1192.5</td>
<td style="text-align: right;">180</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">3.076458</td>
<td style="text-align: right;">2.457411</td>
<td style="text-align: right;">-0.7686473</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA12023FP</td>
<td style="text-align: left;">TUCFK1156H</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">12064.0</td>
<td style="text-align: right;">189</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.081491</td>
<td style="text-align: right;">3.709164</td>
<td style="text-align: right;">-0.1851742</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA12034FP</td>
<td style="text-align: left;">JFNKQ9365E</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">21850.0</td>
<td style="text-align: right;">116</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.339451</td>
<td style="text-align: right;">4.082326</td>
<td style="text-align: right;">-0.0112336</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA12031FP</td>
<td style="text-align: left;">KKTBR9167G</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">10950.0</td>
<td style="text-align: right;">169</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.039414</td>
<td style="text-align: right;">3.650157</td>
<td style="text-align: right;">-0.2126786</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA12030FP</td>
<td style="text-align: left;">ZLHKQ3056W</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">32480.0</td>
<td style="text-align: right;">169</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.511616</td>
<td style="text-align: right;">4.341824</td>
<td style="text-align: right;">0.1097246</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA12032FP</td>
<td style="text-align: left;">OPEWU1360J</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">44005.0</td>
<td style="text-align: right;">177</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.643502</td>
<td style="text-align: right;">4.545950</td>
<td style="text-align: right;">0.2048730</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA12033FP</td>
<td style="text-align: left;">CUVAC1977G</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">40933.0</td>
<td style="text-align: right;">204</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.612074</td>
<td style="text-align: right;">4.496899</td>
<td style="text-align: right;">0.1820090</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA12025FP</td>
<td style="text-align: left;">QYMHD2998X</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">24232.0</td>
<td style="text-align: right;">179</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.384389</td>
<td style="text-align: right;">4.149277</td>
<td style="text-align: right;">0.0199738</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA12029FP</td>
<td style="text-align: left;">VHKUC4047G</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">11726.0</td>
<td style="text-align: right;">197</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.069150</td>
<td style="text-align: right;">3.691801</td>
<td style="text-align: right;">-0.1932672</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19076FP</td>
<td style="text-align: left;">VFZHQ3422A</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">17629.0</td>
<td style="text-align: right;">129</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.246228</td>
<td style="text-align: right;">3.945247</td>
<td style="text-align: right;">-0.0751296</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19075FP</td>
<td style="text-align: left;">KHUXL8867Y</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">11563.0</td>
<td style="text-align: right;">191</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.063071</td>
<td style="text-align: right;">3.683266</td>
<td style="text-align: right;">-0.1972459</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19074FP</td>
<td style="text-align: left;">SQSNR6198H</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">31448.5</td>
<td style="text-align: right;">172</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.497600</td>
<td style="text-align: right;">4.320398</td>
<td style="text-align: right;">0.0997375</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19073FP</td>
<td style="text-align: left;">SSWIM3847X</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">33707.0</td>
<td style="text-align: right;">162</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.527720</td>
<td style="text-align: right;">4.366506</td>
<td style="text-align: right;">0.1212294</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19072FP</td>
<td style="text-align: left;">FOIZY7136I</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">19664.0</td>
<td style="text-align: right;">185</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.293672</td>
<td style="text-align: right;">4.014703</td>
<td style="text-align: right;">-0.0427548</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19071FP</td>
<td style="text-align: left;">WGJOZ6938A</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">26330.0</td>
<td style="text-align: right;">189</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.420451</td>
<td style="text-align: right;">4.203407</td>
<td style="text-align: right;">0.0452051</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19070FP</td>
<td style="text-align: left;">FCNHC5405J</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">32785.0</td>
<td style="text-align: right;">181</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.515675</td>
<td style="text-align: right;">4.348039</td>
<td style="text-align: right;">0.1126215</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19069FP</td>
<td style="text-align: left;">BJNDC1787J</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">31667.5</td>
<td style="text-align: right;">184</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.500614</td>
<td style="text-align: right;">4.325001</td>
<td style="text-align: right;">0.1018830</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19068FP</td>
<td style="text-align: left;">SOAWG2729N</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">26859.0</td>
<td style="text-align: right;">128</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.429090</td>
<td style="text-align: right;">4.216428</td>
<td style="text-align: right;">0.0512742</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19067FP</td>
<td style="text-align: left;">YKYZG4464G</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">24071.0</td>
<td style="text-align: right;">163</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.381494</td>
<td style="text-align: right;">4.144947</td>
<td style="text-align: right;">0.0179554</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19066FP</td>
<td style="text-align: left;">ZABYK9626H</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">29642.0</td>
<td style="text-align: right;">153</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.471908</td>
<td style="text-align: right;">4.281259</td>
<td style="text-align: right;">0.0814940</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19065FP</td>
<td style="text-align: left;">FCIID4951Q</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">16713.5</td>
<td style="text-align: right;">174</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.223067</td>
<td style="text-align: right;">3.911577</td>
<td style="text-align: right;">-0.0908244</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19064FP</td>
<td style="text-align: left;">FFARN9962A</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">19824.0</td>
<td style="text-align: right;">151</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.297191</td>
<td style="text-align: right;">4.019881</td>
<td style="text-align: right;">-0.0403413</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19063FP</td>
<td style="text-align: left;">YSPMQ7157A</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">7087.0</td>
<td style="text-align: right;">222</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">3.850462</td>
<td style="text-align: right;">3.391899</td>
<td style="text-align: right;">-0.3330591</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19062FP</td>
<td style="text-align: left;">XKMHL2286R</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">16094.0</td>
<td style="text-align: right;">214</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.206664</td>
<td style="text-align: right;">3.887823</td>
<td style="text-align: right;">-0.1018965</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19061FP</td>
<td style="text-align: left;">ZJUTH0630E</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">28419.0</td>
<td style="text-align: right;">177</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.453609</td>
<td style="text-align: right;">4.253492</td>
<td style="text-align: right;">0.0685509</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19060FP</td>
<td style="text-align: left;">PQNTB0480Q</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">18365.0</td>
<td style="text-align: right;">128</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.263991</td>
<td style="text-align: right;">3.971176</td>
<td style="text-align: right;">-0.0630435</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19059FP</td>
<td style="text-align: left;">VFWTH5193U</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">31604.5</td>
<td style="text-align: right;">118</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.499749</td>
<td style="text-align: right;">4.323680</td>
<td style="text-align: right;">0.1012672</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19058FP</td>
<td style="text-align: left;">ZKQKJ4765K</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">23945.0</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.379215</td>
<td style="text-align: right;">4.141540</td>
<td style="text-align: right;">0.0163671</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19057FP</td>
<td style="text-align: left;">BJLNT2569K</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">16394.0</td>
<td style="text-align: right;">177</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.214685</td>
<td style="text-align: right;">3.899428</td>
<td style="text-align: right;">-0.0964870</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19056FP</td>
<td style="text-align: left;">WDIEJ7300D</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">25363.5</td>
<td style="text-align: right;">154</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.404209</td>
<td style="text-align: right;">4.178984</td>
<td style="text-align: right;">0.0338207</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19055FP</td>
<td style="text-align: left;">WBEMZ8364O</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">22725.0</td>
<td style="text-align: right;">171</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.356504</td>
<td style="text-align: right;">4.107666</td>
<td style="text-align: right;">0.0005778</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19054FP</td>
<td style="text-align: left;">GQLIG2522J</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">25889.0</td>
<td style="text-align: right;">179</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.413115</td>
<td style="text-align: right;">4.192367</td>
<td style="text-align: right;">0.0400591</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA14029FP</td>
<td style="text-align: left;">CEOMW0540K</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">42000.5</td>
<td style="text-align: right;">160</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.623254</td>
<td style="text-align: right;">4.514321</td>
<td style="text-align: right;">0.1901295</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA14029CFP</td>
<td style="text-align: left;">CGNQI1160J</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">17772.0</td>
<td style="text-align: right;">203</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.249736</td>
<td style="text-align: right;">3.950362</td>
<td style="text-align: right;">-0.0727457</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA14028FP</td>
<td style="text-align: left;">UKESF7004Q</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">29761.0</td>
<td style="text-align: right;">127</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.473648</td>
<td style="text-align: right;">4.283905</td>
<td style="text-align: right;">0.0827269</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA14027FP</td>
<td style="text-align: left;">YSQYR9458Q</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">26256.0</td>
<td style="text-align: right;">165</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.419229</td>
<td style="text-align: right;">4.201567</td>
<td style="text-align: right;">0.0443472</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA14028CFP</td>
<td style="text-align: left;">IQWRF4475A</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">36194.5</td>
<td style="text-align: right;">192</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.558643</td>
<td style="text-align: right;">4.414091</td>
<td style="text-align: right;">0.1434098</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA14027CFP</td>
<td style="text-align: left;">HDHBH5824I</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">28571.0</td>
<td style="text-align: right;">169</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.455925</td>
<td style="text-align: right;">4.257002</td>
<td style="text-align: right;">0.0701872</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA14026CFP</td>
<td style="text-align: left;">NIVWI2815C</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">21558.0</td>
<td style="text-align: right;">179</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.333609</td>
<td style="text-align: right;">4.073663</td>
<td style="text-align: right;">-0.0152721</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA14026FP</td>
<td style="text-align: left;">TWRXA5018E</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">5411.0</td>
<td style="text-align: right;">232</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">3.733277</td>
<td style="text-align: right;">3.237406</td>
<td style="text-align: right;">-0.4050720</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA14025CFP</td>
<td style="text-align: left;">QZAQT6173F</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">16233.0</td>
<td style="text-align: right;">193</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.210399</td>
<td style="text-align: right;">3.893225</td>
<td style="text-align: right;">-0.0993788</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA14025FP</td>
<td style="text-align: left;">KCGKZ4596G</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">5400.0</td>
<td style="text-align: right;">196</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">3.732394</td>
<td style="text-align: right;">3.236258</td>
<td style="text-align: right;">-0.4056072</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA14024FP</td>
<td style="text-align: left;">QHAAS3070U</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">28896.0</td>
<td style="text-align: right;">170</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.460838</td>
<td style="text-align: right;">4.264451</td>
<td style="text-align: right;">0.0736591</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA14024CFP</td>
<td style="text-align: left;">UGUGS0605Z</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">39745.0</td>
<td style="text-align: right;">149</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.599283</td>
<td style="text-align: right;">4.477008</td>
<td style="text-align: right;">0.1727373</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA13051FP</td>
<td style="text-align: left;">LPAMF2203X</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">9338.0</td>
<td style="text-align: right;">211</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">3.970254</td>
<td style="text-align: right;">3.554343</td>
<td style="text-align: right;">-0.2573400</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA13050FP</td>
<td style="text-align: left;">HPEUL6649T</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">36107.5</td>
<td style="text-align: right;">178</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.557597</td>
<td style="text-align: right;">4.412478</td>
<td style="text-align: right;">0.1426583</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA13051CFP</td>
<td style="text-align: left;">TOWYT4920L</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">19797.0</td>
<td style="text-align: right;">175</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.296599</td>
<td style="text-align: right;">4.019010</td>
<td style="text-align: right;">-0.0407473</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA13050CFP</td>
<td style="text-align: left;">GTKLW6867M</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">16790.0</td>
<td style="text-align: right;">198</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.225051</td>
<td style="text-align: right;">3.914454</td>
<td style="text-align: right;">-0.0894832</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA13048FP</td>
<td style="text-align: left;">TUFEH9339A</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">1322.5</td>
<td style="text-align: right;">192</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">3.121396</td>
<td style="text-align: right;">2.505926</td>
<td style="text-align: right;">-0.7460332</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA13048CFP</td>
<td style="text-align: left;">WSATP2009K</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">24000.0</td>
<td style="text-align: right;">163</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.380211</td>
<td style="text-align: right;">4.143029</td>
<td style="text-align: right;">0.0170613</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA13047FP</td>
<td style="text-align: left;">PIRTJ0833C</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">9020.0</td>
<td style="text-align: right;">151</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">3.955207</td>
<td style="text-align: right;">3.533691</td>
<td style="text-align: right;">-0.2669661</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA13044CFP</td>
<td style="text-align: left;">SWXZA6598N</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">11052.0</td>
<td style="text-align: right;">134</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.043441</td>
<td style="text-align: right;">3.655781</td>
<td style="text-align: right;">-0.2100573</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA13047CFP</td>
<td style="text-align: left;">NPDXB8563J</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">10940.5</td>
<td style="text-align: right;">140</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.039037</td>
<td style="text-align: right;">3.649631</td>
<td style="text-align: right;">-0.2129239</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA13044FP</td>
<td style="text-align: left;">PEVIK2267H</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">36310.0</td>
<td style="text-align: right;">185</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.560026</td>
<td style="text-align: right;">4.416226</td>
<td style="text-align: right;">0.1444051</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA13046FP</td>
<td style="text-align: left;">XFJNU8182S</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">30445.0</td>
<td style="text-align: right;">164</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.483516</td>
<td style="text-align: right;">4.298921</td>
<td style="text-align: right;">0.0897267</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA13046CFP</td>
<td style="text-align: left;">OQKJI1993Q</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">21359.0</td>
<td style="text-align: right;">167</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">4.329581</td>
<td style="text-align: right;">4.067696</td>
<td style="text-align: right;">-0.0180531</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA12587CFP</td>
<td style="text-align: left;">DYKJQ0547B</td>
<td style="text-align: left;">chit</td>
<td style="text-align: right;">9441.0</td>
<td style="text-align: right;">205</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">47395</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">3.975018</td>
<td style="text-align: right;">3.560896</td>
<td style="text-align: right;">-0.2542855</td>
<td style="text-align: left;">data/luminex_files//plate_01</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="look-at-the-plate-1-standards-and-specimens" class="level3" data-number="14.5.3">
<h3 data-number="14.5.3" class="anchored" data-anchor-id="look-at-the-plate-1-standards-and-specimens"><span class="header-section-number">14.5.3</span> Look at the plate 1 standards and specimens</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>       ( </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggplot</span>(<span class="fu">filter</span>(a,class<span class="sc">==</span><span class="st">"standard"</span>),<span class="fu">aes</span>(log10.mfi,Estimate.norm,<span class="at">color=</span>class))<span class="sc">+</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">facet_wrap</span>(assay<span class="sc">~</span>.)<span class="sc">+</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>(<span class="at">data=</span><span class="fu">filter</span>(a,class<span class="sc">==</span><span class="st">"specimen"</span>),<span class="fu">aes</span>(log10.mfi,Estimate.norm),<span class="at">size=</span><span class="fl">0.2</span>,<span class="at">alpha=</span><span class="fl">0.3</span>)<span class="sc">+</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>(<span class="at">size=</span><span class="fl">0.2</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>       )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analysis_01_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="1536"></p>
</div>
</div>
<p>The pink dots show the specimens and the blue dots (and line) show the standard curve. You can see that most specimen estimates fall inside the standard curve, which is desirable and which is essentially forced by our choice of dose-response model. Note also that CRP didn’t work on this plate. This is not unexpected. It was quite an ask to get CRP on to this multiplex as it has very high activity compared to other markers. For the most part these all look pretty good.</p>
</section>
<section id="read-in-the-rest-of-the-plates" class="level3" data-number="14.5.4">
<h3 data-number="14.5.4" class="anchored" data-anchor-id="read-in-the-rest-of-the-plates"><span class="header-section-number">14.5.4</span> Read in the rest of the plates</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(c.files)){a<span class="ot">&lt;-</span><span class="fu">bind_rows</span>(a,<span class="fu">luminex.process.data</span>(<span class="at">file =</span> c.files[i],<span class="at">standards.file =</span> <span class="st">"data/MOSDEF_Standard_Concs.csv"</span>))})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="chart-the-results-for-all-assays-on-all-plates" class="level3" data-number="14.5.5">
<h3 data-number="14.5.5" class="anchored" data-anchor-id="chart-the-results-for-all-assays-on-all-plates"><span class="header-section-number">14.5.5</span> Chart the results for all assays on all plates</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="do">######################################################################</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Draw charts</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="do">######################################################################</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>(<span class="fu">ggplot</span>(a,<span class="fu">aes</span>(log10.mfi,Estimate,<span class="at">color=</span>class))<span class="sc">+</span><span class="fu">geom_point</span>(<span class="at">size=</span><span class="fl">0.1</span>)<span class="sc">+</span><span class="fu">facet_wrap</span>(.<span class="sc">~</span>assay,<span class="at">scales =</span> <span class="st">"free"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analysis_01_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="1536"></p>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">try</span>(<span class="fu">dir.create</span>(<span class="st">"output"</span>))<span class="co">#make an output folder to save hard copies</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>a<span class="sc">$</span>plate<span class="ot">&lt;-</span><span class="fu">str_remove</span>(<span class="at">string =</span> a<span class="sc">$</span>plate,<span class="st">"data/luminex_files/"</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>a<span class="sc">$</span>plate<span class="ot">&lt;-</span><span class="fu">str_remove</span>(<span class="at">string =</span> a<span class="sc">$</span>plate,<span class="st">".csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>As you can see, the CRP assay didn’t really work at all, so we’ll remove it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span>a <span class="sc">%&gt;%</span>  <span class="fu">filter</span>(assay<span class="sc">!=</span><span class="st">"crp"</span>,</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>                class<span class="sc">==</span><span class="st">"specimen"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>          <span class="fu">distinct</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can also see that some plates behaved unusually in the Azu assay. We’ll investigate those further next.</p>
</section>
</section>
<section id="visualisation" class="level2" data-number="14.6">
<h2 data-number="14.6" class="anchored" data-anchor-id="visualisation"><span class="header-section-number">14.6</span> Visualisation</h2>
<section id="define-a-function-that-will-draw-a-chart-for-each-assay-showing-effects-of-normalisation-on-a-plate-by-plate-basis" class="level3" data-number="14.6.1">
<h3 data-number="14.6.1" class="anchored" data-anchor-id="define-a-function-that-will-draw-a-chart-for-each-assay-showing-effects-of-normalisation-on-a-plate-by-plate-basis"><span class="header-section-number">14.6.1</span> Define a function that will draw a chart for each assay, showing effects of normalisation on a plate-by-plate basis</h3>
<p>This type of chart is useful for identifying outlier plates which may have behaved differently. You should note that if you’ve got all of your clinical cases on one plate, but all your control cases on another, then you’d expect to see outliers because of this.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>plot.assay<span class="ot">&lt;-</span><span class="cf">function</span>(test.assay){</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">filter</span>(a,assay<span class="sc">==</span>test.assay),<span class="fu">aes</span>(plate,Estimate))<span class="sc">+</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="at">size=</span><span class="fl">0.3</span>)<span class="sc">+</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(test.assay)<span class="sc">+</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(.<span class="sc">~</span>class,<span class="at">scales =</span> <span class="st">"free"</span>)<span class="sc">+</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>,<span class="at">size=</span><span class="dv">3</span>))</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="apply-the-function-to-all-assays" class="level3" data-number="14.6.2">
<h3 data-number="14.6.2" class="anchored" data-anchor-id="apply-the-function-to-all-assays"><span class="header-section-number">14.6.2</span> Apply the function to all assays</h3>
<p>Notably, the standards were odd in these plates, which suggests that there may be some issues that could be solved by running the plates again.</p>
<section id="il-8" class="level4" data-number="14.6.2.1">
<h4 data-number="14.6.2.1" class="anchored" data-anchor-id="il-8"><span class="header-section-number">14.6.2.1</span> IL-8</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.assay</span>(<span class="st">"il_8"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analysis_01_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="1536"></p>
</div>
</div>
</section>
<section id="azu" class="level4" data-number="14.6.2.2">
<h4 data-number="14.6.2.2" class="anchored" data-anchor-id="azu"><span class="header-section-number">14.6.2.2</span> Azu</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.assay</span>(<span class="st">"azu"</span>);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analysis_01_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="1536"></p>
</div>
</div>
</section>
<section id="stnf-r1" class="level4" data-number="14.6.2.3">
<h4 data-number="14.6.2.3" class="anchored" data-anchor-id="stnf-r1"><span class="header-section-number">14.6.2.3</span> STNF-R1</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.assay</span>(<span class="st">"stnf_r1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analysis_01_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="1536"></p>
</div>
</div>
</section>
<section id="il-6" class="level4" data-number="14.6.2.4">
<h4 data-number="14.6.2.4" class="anchored" data-anchor-id="il-6"><span class="header-section-number">14.6.2.4</span> IL-6</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.assay</span>(<span class="st">"il_6"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analysis_01_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="1536"></p>
</div>
</div>
</section>
<section id="ang-2" class="level4" data-number="14.6.2.5">
<h4 data-number="14.6.2.5" class="anchored" data-anchor-id="ang-2"><span class="header-section-number">14.6.2.5</span> ANG-2</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.assay</span>(<span class="st">"ang_2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analysis_01_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="1536"></p>
</div>
</div>
</section>
<section id="ang-1" class="level4" data-number="14.6.2.6">
<h4 data-number="14.6.2.6" class="anchored" data-anchor-id="ang-1"><span class="header-section-number">14.6.2.6</span> ANG-1</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.assay</span>(<span class="st">"ang_1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analysis_01_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="1536"></p>
</div>
</div>
</section>
<section id="trail" class="level4" data-number="14.6.2.7">
<h4 data-number="14.6.2.7" class="anchored" data-anchor-id="trail"><span class="header-section-number">14.6.2.7</span> TRAIL</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.assay</span>(<span class="st">"trail"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analysis_01_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="1536"></p>
</div>
</div>
</section>
<section id="il-10" class="level4" data-number="14.6.2.8">
<h4 data-number="14.6.2.8" class="anchored" data-anchor-id="il-10"><span class="header-section-number">14.6.2.8</span> IL-10</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.assay</span>(<span class="st">"il_10"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analysis_01_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="1536"></p>
</div>
</div>
</section>
<section id="strem-1" class="level4" data-number="14.6.2.9">
<h4 data-number="14.6.2.9" class="anchored" data-anchor-id="strem-1"><span class="header-section-number">14.6.2.9</span> STREM-1</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.assay</span>(<span class="st">"strem1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analysis_01_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="1536"></p>
</div>
</div>
</section>
<section id="ip-10" class="level4" data-number="14.6.2.10">
<h4 data-number="14.6.2.10" class="anchored" data-anchor-id="ip-10"><span class="header-section-number">14.6.2.10</span> IP-10</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.assay</span>(<span class="st">"ip_10"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analysis_01_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="1536"></p>
</div>
</div>
</section>
<section id="mxa" class="level4" data-number="14.6.2.11">
<h4 data-number="14.6.2.11" class="anchored" data-anchor-id="mxa"><span class="header-section-number">14.6.2.11</span> MxA</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.assay</span>(<span class="st">"mxa"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analysis_01_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="1536"></p>
</div>
</div>
</section>
<section id="chi3l1" class="level4" data-number="14.6.2.12">
<h4 data-number="14.6.2.12" class="anchored" data-anchor-id="chi3l1"><span class="header-section-number">14.6.2.12</span> <strong>CHI3L1</strong></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.assay</span>(<span class="st">"chit"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analysis_01_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="1536"></p>
</div>
</div>
</section>
</section>
</section>
<section id="clinical-data" class="level2" data-number="14.7">
<h2 data-number="14.7" class="anchored" data-anchor-id="clinical-data"><span class="header-section-number">14.7</span> Clinical data</h2>
<p>The data imported from the Luminex files do not include clinical parameters that will be used in an analysis. The ID numbers do contain some information though. Here, the last characters of the <code>sample</code> variable tell us whether the data relate to a specimen taken at day 0 (FP) or day 28 (CFP). We’ll make a new variable which captures this, then remove those characters from the <code>sample</code> variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span> a <span class="sc">%&gt;%</span> </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">timepoint =</span> <span class="fu">case_when</span>(</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">str_detect</span>(sample, <span class="at">pattern =</span> <span class="st">"CFP"</span>) <span class="sc">~</span> <span class="st">"day28"</span>,</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">str_detect</span>(sample, <span class="at">pattern =</span> <span class="st">"FP"</span>) <span class="sc">~</span> <span class="st">"day0"</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>                          ),</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">timepoint =</span> <span class="fu">factor</span>(timepoint),</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">sample =</span> <span class="fu">str_remove</span>(sample,<span class="st">"CFP|FP"</span>)</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The clinical data are provided in the file <code>0000_clinical_data.csv</code> and include the following variables</p>
<ul>
<li><strong>sample</strong>
<ul>
<li>The sample ID now stored in the Luminex derived df</li>
</ul></li>
<li><strong>inpatient_outpatient</strong>
<ul>
<li>This is a factor indicating whether the person was
<ul>
<li>A person with a clinical case of fever, who was treated as an outpatient<br>
</li>
<li>A person with a clinical case of fever, who was treated as an inpatient<br>
</li>
<li>A person without fever, living in the same communities as the cases</li>
</ul></li>
</ul></li>
<li><strong>outcome</strong>
<ul>
<li>good
<ul>
<li>The person recovered by day 28</li>
</ul></li>
<li>bad
<ul>
<li>The person was still ill, or was dead at day 28</li>
</ul></li>
<li>control
<ul>
<li>Community Control, no fever</li>
</ul></li>
<li>ltfu
<ul>
<li>Lost to follow-up</li>
</ul></li>
</ul></li>
<li><strong>fever_days</strong>
<ul>
<li>The number of days that the person was symptomatic prior to triage at day 0</li>
</ul></li>
<li><strong>time_death</strong>
<ul>
<li>The days elapsed between day 0 and death</li>
</ul></li>
<li><strong>time_death_plus_fever_days</strong>
<ul>
<li><p>The days elapsed between symptom onset and death</p>
<ul>
<li>For cases where symptom onset was unknown, this was set to the modal value (2)</li>
</ul></li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>clinical.and.control.data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/0000_clinical_data.csv"</span>,<span class="at">show_col_types =</span> F)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(clinical.and.control.data[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>,])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">sample</th>
<th style="text-align: left;">inpatient_outpatient</th>
<th style="text-align: left;">cf_5_inpatient_outcome</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">LA19485</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19484</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19483</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19482</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19481</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19480</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19479</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19478</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19477</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19476</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19475</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19474</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19473</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19472</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19471</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19470</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19469</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19468</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19467</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19466</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19465</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19464</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19463</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19462</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19461</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19460</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19459</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19458</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19457</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19456</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19455</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19454</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19453</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19452</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19451</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19450</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19449</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19448</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19447</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19446</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19445</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19444</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19443</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19442</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19441</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19440</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19439</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19438</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19437</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19436</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19435</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19434</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19433</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19432</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19431</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19430</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19429</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19428</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19427</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19426</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19425</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19424</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19423</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19422</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19421</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19420</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19419</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19418</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19417</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19416</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19415</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19414</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19413</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19412</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19411</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19410</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19409</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19408</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19407</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19406</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19405</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19404</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19403</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19402</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19401</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19400</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19399</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19398</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19397</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19396</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19395</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19394</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19393</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19392</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19391</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19390</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19389</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19388</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19387</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19386</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The next step is to merge the clinical data with the luminex data and then to clarify that day_0 controls are separate from day 0 cases</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>full_data<span class="ot">&lt;-</span> <span class="fu">left_join</span>(a,clinical.and.control.data,<span class="at">by=</span><span class="st">"sample"</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>full_data<span class="sc">$</span>timepoint<span class="ot">&lt;-</span><span class="fu">as.character</span>(full_data<span class="sc">$</span>timepoint)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>full_data<span class="sc">$</span>timepoint[<span class="fu">which</span>(<span class="fu">as.character</span>(full_data<span class="sc">$</span>inpatient_outpatient)<span class="sc">==</span><span class="st">"control"</span>)] <span class="ot">&lt;-</span> <span class="st">"control"</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>full_data<span class="sc">$</span>timepoint<span class="ot">&lt;-</span><span class="fu">as.factor</span>(full_data<span class="sc">$</span>timepoint)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(full_data[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>,])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 4%">
<col style="width: 6%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 6%">
<col style="width: 2%">
<col style="width: 5%">
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 2%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 11%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">sample</th>
<th style="text-align: left;">test.id</th>
<th style="text-align: left;">assay</th>
<th style="text-align: right;">mfi</th>
<th style="text-align: right;">bead.count</th>
<th style="text-align: right;">conc</th>
<th style="text-align: left;">class</th>
<th style="text-align: right;">bg</th>
<th style="text-align: right;">tp</th>
<th style="text-align: right;">mn</th>
<th style="text-align: right;">log10.mfi</th>
<th style="text-align: right;">Estimate</th>
<th style="text-align: right;">Estimate.norm</th>
<th style="text-align: left;">plate</th>
<th style="text-align: left;">timepoint</th>
<th style="text-align: left;">inpatient_outpatient</th>
<th style="text-align: left;">cf_5_inpatient_outcome</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">LA11033</td>
<td style="text-align: left;">SHGKD1852U</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">412.0</td>
<td style="text-align: right;">135</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.614897</td>
<td style="text-align: right;">0.2578131</td>
<td style="text-align: right;">-0.1829545</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day0</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA11039</td>
<td style="text-align: left;">ILAID4151N</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">555.0</td>
<td style="text-align: right;">161</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.744293</td>
<td style="text-align: right;">0.5184685</td>
<td style="text-align: right;">-0.0673585</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day0</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA11037</td>
<td style="text-align: left;">VGHJM4359F</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">434.5</td>
<td style="text-align: right;">188</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.637990</td>
<td style="text-align: right;">0.3051793</td>
<td style="text-align: right;">-0.1619484</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day28</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA11039</td>
<td style="text-align: left;">KOANM9309M</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">604.5</td>
<td style="text-align: right;">136</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.781396</td>
<td style="text-align: right;">0.5910819</td>
<td style="text-align: right;">-0.0351557</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day28</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA11037</td>
<td style="text-align: left;">EGPPE6968D</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">550.0</td>
<td style="text-align: right;">163</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.740363</td>
<td style="text-align: right;">0.5107213</td>
<td style="text-align: right;">-0.0707942</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day0</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA11036</td>
<td style="text-align: left;">LWPQA3913Y</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">1066.5</td>
<td style="text-align: right;">126</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">3.027961</td>
<td style="text-align: right;">1.0499422</td>
<td style="text-align: right;">0.1683407</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day28</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA11036</td>
<td style="text-align: left;">WIUSH3317X</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">1147.5</td>
<td style="text-align: right;">174</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">3.059753</td>
<td style="text-align: right;">1.1061658</td>
<td style="text-align: right;">0.1932748</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day0</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA11034</td>
<td style="text-align: left;">HASCA4592S</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">569.0</td>
<td style="text-align: right;">157</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.755112</td>
<td style="text-align: right;">0.5397400</td>
<td style="text-align: right;">-0.0579249</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day28</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA11040</td>
<td style="text-align: left;">STYAL4876A</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">504.5</td>
<td style="text-align: right;">106</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.702861</td>
<td style="text-align: right;">0.4362660</td>
<td style="text-align: right;">-0.1038138</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day0</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA11034</td>
<td style="text-align: left;">HLPGU1397F</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">642.5</td>
<td style="text-align: right;">126</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.807873</td>
<td style="text-align: right;">0.6423224</td>
<td style="text-align: right;">-0.0124314</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day0</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA11033</td>
<td style="text-align: left;">UPJRU9129S</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">441.0</td>
<td style="text-align: right;">128</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.644439</td>
<td style="text-align: right;">0.3183408</td>
<td style="text-align: right;">-0.1561116</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day28</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA11040</td>
<td style="text-align: left;">JVOSI1587O</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">430.0</td>
<td style="text-align: right;">139</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.633469</td>
<td style="text-align: right;">0.2959345</td>
<td style="text-align: right;">-0.1660483</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day28</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA12027</td>
<td style="text-align: left;">FCIFG0648D</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">643.5</td>
<td style="text-align: right;">138</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.808549</td>
<td style="text-align: right;">0.6436233</td>
<td style="text-align: right;">-0.0118545</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day28</td>
<td style="text-align: left;">inpatient</td>
<td style="text-align: left;">discharged</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA12027</td>
<td style="text-align: left;">HJYDE3625F</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">816.0</td>
<td style="text-align: right;">139</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.911690</td>
<td style="text-align: right;">0.8386443</td>
<td style="text-align: right;">0.0746338</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day0</td>
<td style="text-align: left;">inpatient</td>
<td style="text-align: left;">discharged</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA12026</td>
<td style="text-align: left;">VRHCL9504V</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">652.0</td>
<td style="text-align: right;">153</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.814248</td>
<td style="text-align: right;">0.6545875</td>
<td style="text-align: right;">-0.0069921</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day28</td>
<td style="text-align: left;">inpatient</td>
<td style="text-align: left;">discharged</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA12026</td>
<td style="text-align: left;">VAYHW1782L</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">1457.0</td>
<td style="text-align: right;">153</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">3.163460</td>
<td style="text-align: right;">1.2850268</td>
<td style="text-align: right;">0.2725965</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day0</td>
<td style="text-align: left;">inpatient</td>
<td style="text-align: left;">discharged</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA12024</td>
<td style="text-align: left;">NPLGF7754K</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">593.0</td>
<td style="text-align: right;">151</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.773055</td>
<td style="text-align: right;">0.5748391</td>
<td style="text-align: right;">-0.0423591</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day28</td>
<td style="text-align: left;">inpatient</td>
<td style="text-align: left;">discharged</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA12022</td>
<td style="text-align: left;">JQKTV5449U</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">640.0</td>
<td style="text-align: right;">126</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.806180</td>
<td style="text-align: right;">0.6390600</td>
<td style="text-align: right;">-0.0138783</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day28</td>
<td style="text-align: left;">inpatient</td>
<td style="text-align: left;">discharged</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA12024</td>
<td style="text-align: left;">FOLVC5757H</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">654.0</td>
<td style="text-align: right;">164</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.815578</td>
<td style="text-align: right;">0.6571433</td>
<td style="text-align: right;">-0.0058587</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day0</td>
<td style="text-align: left;">inpatient</td>
<td style="text-align: left;">discharged</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA12028</td>
<td style="text-align: left;">YDITP1935G</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">713.5</td>
<td style="text-align: right;">152</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.853394</td>
<td style="text-align: right;">0.7293023</td>
<td style="text-align: right;">0.0261426</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day0</td>
<td style="text-align: left;">inpatient</td>
<td style="text-align: left;">discharged</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA12021</td>
<td style="text-align: left;">QBWQM4347F</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">625.5</td>
<td style="text-align: right;">134</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.796227</td>
<td style="text-align: right;">0.6198433</td>
<td style="text-align: right;">-0.0224005</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day28</td>
<td style="text-align: left;">inpatient</td>
<td style="text-align: left;">discharged</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA12028</td>
<td style="text-align: left;">ZZIZF0455C</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">520.5</td>
<td style="text-align: right;">160</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.716421</td>
<td style="text-align: right;">0.4632989</td>
<td style="text-align: right;">-0.0918252</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day28</td>
<td style="text-align: left;">inpatient</td>
<td style="text-align: left;">discharged</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA12022</td>
<td style="text-align: left;">WTCZZ6985E</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">1051.0</td>
<td style="text-align: right;">125</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">3.021603</td>
<td style="text-align: right;">1.0386186</td>
<td style="text-align: right;">0.1633188</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day0</td>
<td style="text-align: left;">inpatient</td>
<td style="text-align: left;">discharged</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA12021</td>
<td style="text-align: left;">OIXZA0659A</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">501.0</td>
<td style="text-align: right;">159</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.699838</td>
<td style="text-align: right;">0.4302210</td>
<td style="text-align: right;">-0.1064946</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day0</td>
<td style="text-align: left;">inpatient</td>
<td style="text-align: left;">discharged</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA12023</td>
<td style="text-align: left;">TUCFK1156H</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">678.0</td>
<td style="text-align: right;">127</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.831230</td>
<td style="text-align: right;">0.6871274</td>
<td style="text-align: right;">0.0074388</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day0</td>
<td style="text-align: left;">inpatient</td>
<td style="text-align: left;">discharged</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA12034</td>
<td style="text-align: left;">JFNKQ9365E</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">916.0</td>
<td style="text-align: right;">111</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.961895</td>
<td style="text-align: right;">0.9309828</td>
<td style="text-align: right;">0.1155843</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day0</td>
<td style="text-align: left;">inpatient</td>
<td style="text-align: left;">other_health_facility</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA12031</td>
<td style="text-align: left;">KKTBR9167G</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">672.0</td>
<td style="text-align: right;">149</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.827369</td>
<td style="text-align: right;">0.6797476</td>
<td style="text-align: right;">0.0041659</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day0</td>
<td style="text-align: left;">inpatient</td>
<td style="text-align: left;">discharged</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA12030</td>
<td style="text-align: left;">ZLHKQ3056W</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">1376.5</td>
<td style="text-align: right;">134</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">3.138776</td>
<td style="text-align: right;">1.2430810</td>
<td style="text-align: right;">0.2539943</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day0</td>
<td style="text-align: left;">inpatient</td>
<td style="text-align: left;">discharged</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA12032</td>
<td style="text-align: left;">OPEWU1360J</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">2434.0</td>
<td style="text-align: right;">153</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">3.386321</td>
<td style="text-align: right;">1.6465855</td>
<td style="text-align: right;">0.4329414</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day0</td>
<td style="text-align: left;">inpatient</td>
<td style="text-align: left;">other_health_facility</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA12033</td>
<td style="text-align: left;">CUVAC1977G</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">1171.5</td>
<td style="text-align: right;">176</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">3.068742</td>
<td style="text-align: right;">1.1219444</td>
<td style="text-align: right;">0.2002724</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day0</td>
<td style="text-align: left;">inpatient</td>
<td style="text-align: left;">discharged_pallative</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA12025</td>
<td style="text-align: left;">QYMHD2998X</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">1262.0</td>
<td style="text-align: right;">138</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">3.101059</td>
<td style="text-align: right;">1.1782350</td>
<td style="text-align: right;">0.2252363</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day0</td>
<td style="text-align: left;">inpatient</td>
<td style="text-align: left;">discharged_pallative</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA12029</td>
<td style="text-align: left;">VHKUC4047G</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">431.5</td>
<td style="text-align: right;">162</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.634981</td>
<td style="text-align: right;">0.2990284</td>
<td style="text-align: right;">-0.1646763</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day0</td>
<td style="text-align: left;">inpatient</td>
<td style="text-align: left;">discharged</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19076</td>
<td style="text-align: left;">VFZHQ3422A</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">595.0</td>
<td style="text-align: right;">110</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.774517</td>
<td style="text-align: right;">0.5776899</td>
<td style="text-align: right;">-0.0410948</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19075</td>
<td style="text-align: left;">KHUXL8867Y</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">577.0</td>
<td style="text-align: right;">178</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.761176</td>
<td style="text-align: right;">0.5516262</td>
<td style="text-align: right;">-0.0526536</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19074</td>
<td style="text-align: left;">SQSNR6198H</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">809.0</td>
<td style="text-align: right;">156</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.907948</td>
<td style="text-align: right;">0.8316951</td>
<td style="text-align: right;">0.0715520</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19073</td>
<td style="text-align: left;">SSWIM3847X</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">694.0</td>
<td style="text-align: right;">129</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.841359</td>
<td style="text-align: right;">0.7064440</td>
<td style="text-align: right;">0.0160053</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19072</td>
<td style="text-align: left;">FOIZY7136I</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">700.0</td>
<td style="text-align: right;">157</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.845098</td>
<td style="text-align: right;">0.7135556</td>
<td style="text-align: right;">0.0191592</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19071</td>
<td style="text-align: left;">WGJOZ6938A</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">1203.0</td>
<td style="text-align: right;">172</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">3.080266</td>
<td style="text-align: right;">1.1420935</td>
<td style="text-align: right;">0.2092081</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19070</td>
<td style="text-align: left;">FCNHC5405J</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">1019.0</td>
<td style="text-align: right;">156</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">3.008174</td>
<td style="text-align: right;">1.0146156</td>
<td style="text-align: right;">0.1526740</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19069</td>
<td style="text-align: left;">BJNDC1787J</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">680.5</td>
<td style="text-align: right;">176</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.832828</td>
<td style="text-align: right;">0.6901801</td>
<td style="text-align: right;">0.0087926</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19068</td>
<td style="text-align: left;">SOAWG2729N</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">944.0</td>
<td style="text-align: right;">123</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.974972</td>
<td style="text-align: right;">0.9547578</td>
<td style="text-align: right;">0.1261281</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19067</td>
<td style="text-align: left;">YKYZG4464G</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">559.0</td>
<td style="text-align: right;">123</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.747412</td>
<td style="text-align: right;">0.5246086</td>
<td style="text-align: right;">-0.0646355</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19066</td>
<td style="text-align: left;">ZABYK9626H</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">615.0</td>
<td style="text-align: right;">121</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.788875</td>
<td style="text-align: right;">0.6056042</td>
<td style="text-align: right;">-0.0287153</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19065</td>
<td style="text-align: left;">FCIID4951Q</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">719.0</td>
<td style="text-align: right;">144</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.856729</td>
<td style="text-align: right;">0.7356192</td>
<td style="text-align: right;">0.0289440</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19064</td>
<td style="text-align: left;">FFARN9962A</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">743.0</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.870989</td>
<td style="text-align: right;">0.7625453</td>
<td style="text-align: right;">0.0408852</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19063</td>
<td style="text-align: left;">YSPMQ7157A</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">547.0</td>
<td style="text-align: right;">164</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.737987</td>
<td style="text-align: right;">0.5060340</td>
<td style="text-align: right;">-0.0728729</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19062</td>
<td style="text-align: left;">XKMHL2286R</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">880.5</td>
<td style="text-align: right;">156</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.944729</td>
<td style="text-align: right;">0.8995999</td>
<td style="text-align: right;">0.1016665</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19061</td>
<td style="text-align: left;">ZJUTH0630E</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">713.5</td>
<td style="text-align: right;">172</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.853394</td>
<td style="text-align: right;">0.7293023</td>
<td style="text-align: right;">0.0261426</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19060</td>
<td style="text-align: left;">PQNTB0480Q</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">744.0</td>
<td style="text-align: right;">105</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.871573</td>
<td style="text-align: right;">0.7636453</td>
<td style="text-align: right;">0.0413731</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19059</td>
<td style="text-align: left;">VFWTH5193U</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">587.0</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.768638</td>
<td style="text-align: right;">0.5662198</td>
<td style="text-align: right;">-0.0461816</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19058</td>
<td style="text-align: left;">ZKQKJ4765K</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">682.5</td>
<td style="text-align: right;">108</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.834103</td>
<td style="text-align: right;">0.6926130</td>
<td style="text-align: right;">0.0098715</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19057</td>
<td style="text-align: left;">BJLNT2569K</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">565.0</td>
<td style="text-align: right;">149</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.752048</td>
<td style="text-align: right;">0.5337245</td>
<td style="text-align: right;">-0.0605927</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19056</td>
<td style="text-align: left;">WDIEJ7300D</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">617.0</td>
<td style="text-align: right;">133</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.790285</td>
<td style="text-align: right;">0.6083379</td>
<td style="text-align: right;">-0.0275030</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA19055</td>
<td style="text-align: left;">WBEMZ8364O</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">735.0</td>
<td style="text-align: right;">173</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.866287</td>
<td style="text-align: right;">0.7536830</td>
<td style="text-align: right;">0.0369550</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA19054</td>
<td style="text-align: left;">GQLIG2522J</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">728.0</td>
<td style="text-align: right;">153</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.862131</td>
<td style="text-align: right;">0.7458366</td>
<td style="text-align: right;">0.0334752</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">control</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA14029</td>
<td style="text-align: left;">CEOMW0540K</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">14689.0</td>
<td style="text-align: right;">167</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">4.166992</td>
<td style="text-align: right;">2.6948373</td>
<td style="text-align: right;">0.8978224</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day0</td>
<td style="text-align: left;">inpatient</td>
<td style="text-align: left;">discharged</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA14029</td>
<td style="text-align: left;">CGNQI1160J</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">562.0</td>
<td style="text-align: right;">177</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.749736</td>
<td style="text-align: right;">0.5291805</td>
<td style="text-align: right;">-0.0626079</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day28</td>
<td style="text-align: left;">inpatient</td>
<td style="text-align: left;">discharged</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA14028</td>
<td style="text-align: left;">UKESF7004Q</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">607.0</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.783189</td>
<td style="text-align: right;">0.5945658</td>
<td style="text-align: right;">-0.0336107</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day0</td>
<td style="text-align: left;">inpatient</td>
<td style="text-align: left;">other_health_facility</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA14027</td>
<td style="text-align: left;">YSQYR9458Q</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">864.0</td>
<td style="text-align: right;">143</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.936514</td>
<td style="text-align: right;">0.8845106</td>
<td style="text-align: right;">0.0949747</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day0</td>
<td style="text-align: left;">inpatient</td>
<td style="text-align: left;">discharged</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA14028</td>
<td style="text-align: left;">IQWRF4475A</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">956.0</td>
<td style="text-align: right;">154</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.980458</td>
<td style="text-align: right;">0.9646982</td>
<td style="text-align: right;">0.1305365</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day28</td>
<td style="text-align: left;">inpatient</td>
<td style="text-align: left;">other_health_facility</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA14027</td>
<td style="text-align: left;">HDHBH5824I</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">600.5</td>
<td style="text-align: right;">154</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.778513</td>
<td style="text-align: right;">0.5854729</td>
<td style="text-align: right;">-0.0376432</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day28</td>
<td style="text-align: left;">inpatient</td>
<td style="text-align: left;">discharged</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA14026</td>
<td style="text-align: left;">NIVWI2815C</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">595.5</td>
<td style="text-align: right;">170</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.774882</td>
<td style="text-align: right;">0.5784008</td>
<td style="text-align: right;">-0.0407795</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day28</td>
<td style="text-align: left;">inpatient</td>
<td style="text-align: left;">discharged</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA14026</td>
<td style="text-align: left;">TWRXA5018E</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">502.0</td>
<td style="text-align: right;">191</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.700704</td>
<td style="text-align: right;">0.4319531</td>
<td style="text-align: right;">-0.1057265</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day0</td>
<td style="text-align: left;">inpatient</td>
<td style="text-align: left;">discharged</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA14025</td>
<td style="text-align: left;">QZAQT6173F</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">496.0</td>
<td style="text-align: right;">154</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.695482</td>
<td style="text-align: right;">0.4215007</td>
<td style="text-align: right;">-0.1103620</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day28</td>
<td style="text-align: left;">inpatient</td>
<td style="text-align: left;">discharged</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA14025</td>
<td style="text-align: left;">KCGKZ4596G</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">476.0</td>
<td style="text-align: right;">151</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.677607</td>
<td style="text-align: right;">0.3855801</td>
<td style="text-align: right;">-0.1262921</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day0</td>
<td style="text-align: left;">inpatient</td>
<td style="text-align: left;">discharged</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA14024</td>
<td style="text-align: left;">QHAAS3070U</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">2032.0</td>
<td style="text-align: right;">123</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">3.307924</td>
<td style="text-align: right;">1.5228646</td>
<td style="text-align: right;">0.3780734</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day0</td>
<td style="text-align: left;">inpatient</td>
<td style="text-align: left;">discharged</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA14024</td>
<td style="text-align: left;">UGUGS0605Z</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">861.0</td>
<td style="text-align: right;">155</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.935003</td>
<td style="text-align: right;">0.8817313</td>
<td style="text-align: right;">0.0937421</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day28</td>
<td style="text-align: left;">inpatient</td>
<td style="text-align: left;">discharged</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA13051</td>
<td style="text-align: left;">LPAMF2203X</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">1110.0</td>
<td style="text-align: right;">149</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">3.045323</td>
<td style="text-align: right;">1.0807288</td>
<td style="text-align: right;">0.1819940</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day0</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA13050</td>
<td style="text-align: left;">HPEUL6649T</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">1246.0</td>
<td style="text-align: right;">175</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">3.095518</td>
<td style="text-align: right;">1.1686310</td>
<td style="text-align: right;">0.2209770</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day0</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA13051</td>
<td style="text-align: left;">TOWYT4920L</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">961.0</td>
<td style="text-align: right;">163</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.982723</td>
<td style="text-align: right;">0.9687974</td>
<td style="text-align: right;">0.1323544</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day28</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA13050</td>
<td style="text-align: left;">GTKLW6867M</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">812.0</td>
<td style="text-align: right;">133</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.909556</td>
<td style="text-align: right;">0.8346818</td>
<td style="text-align: right;">0.0728765</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day28</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA13048</td>
<td style="text-align: left;">TUFEH9339A</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">495.5</td>
<td style="text-align: right;">152</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.695044</td>
<td style="text-align: right;">0.4206231</td>
<td style="text-align: right;">-0.1107512</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day0</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA13048</td>
<td style="text-align: left;">WSATP2009K</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">512.0</td>
<td style="text-align: right;">148</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.709270</td>
<td style="text-align: right;">0.4490586</td>
<td style="text-align: right;">-0.0981405</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day28</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA13047</td>
<td style="text-align: left;">PIRTJ0833C</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">638.5</td>
<td style="text-align: right;">110</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.805161</td>
<td style="text-align: right;">0.6370955</td>
<td style="text-align: right;">-0.0147495</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day0</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA13044</td>
<td style="text-align: left;">SWXZA6598N</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">642.0</td>
<td style="text-align: right;">139</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.807535</td>
<td style="text-align: right;">0.6416711</td>
<td style="text-align: right;">-0.0127203</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day28</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA13047</td>
<td style="text-align: left;">NPDXB8563J</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">582.0</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.764923</td>
<td style="text-align: right;">0.5589591</td>
<td style="text-align: right;">-0.0494016</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day28</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA13044</td>
<td style="text-align: left;">PEVIK2267H</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">584.0</td>
<td style="text-align: right;">165</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.766413</td>
<td style="text-align: right;">0.5618720</td>
<td style="text-align: right;">-0.0481098</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day0</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA13046</td>
<td style="text-align: left;">XFJNU8182S</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">877.0</td>
<td style="text-align: right;">133</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.943000</td>
<td style="text-align: right;">0.8964266</td>
<td style="text-align: right;">0.1002592</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day0</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA13046</td>
<td style="text-align: left;">OQKJI1993Q</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">824.0</td>
<td style="text-align: right;">165</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.915927</td>
<td style="text-align: right;">0.8465023</td>
<td style="text-align: right;">0.0781187</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day28</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA12587</td>
<td style="text-align: left;">DYKJQ0547B</td>
<td style="text-align: left;">il_8</td>
<td style="text-align: right;">576.0</td>
<td style="text-align: right;">176</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">311.5</td>
<td style="text-align: right;">37005.0</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">2.760422</td>
<td style="text-align: right;">0.5501509</td>
<td style="text-align: right;">-0.0533079</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day28</td>
<td style="text-align: left;">inpatient</td>
<td style="text-align: left;">discharged</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA11033</td>
<td style="text-align: left;">SHGKD1852U</td>
<td style="text-align: left;">stnf_r1</td>
<td style="text-align: right;">235.0</td>
<td style="text-align: right;">161</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">208.0</td>
<td style="text-align: right;">16683.5</td>
<td style="text-align: right;">219</td>
<td style="text-align: right;">2.371068</td>
<td style="text-align: right;">0.2657945</td>
<td style="text-align: right;">-0.3760046</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day0</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA11039</td>
<td style="text-align: left;">ILAID4151N</td>
<td style="text-align: left;">stnf_r1</td>
<td style="text-align: right;">291.5</td>
<td style="text-align: right;">146</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">208.0</td>
<td style="text-align: right;">16683.5</td>
<td style="text-align: right;">219</td>
<td style="text-align: right;">2.464639</td>
<td style="text-align: right;">0.6994402</td>
<td style="text-align: right;">-0.1707881</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day0</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA11037</td>
<td style="text-align: left;">VGHJM4359F</td>
<td style="text-align: left;">stnf_r1</td>
<td style="text-align: right;">233.0</td>
<td style="text-align: right;">141</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">208.0</td>
<td style="text-align: right;">16683.5</td>
<td style="text-align: right;">219</td>
<td style="text-align: right;">2.367356</td>
<td style="text-align: right;">0.2471477</td>
<td style="text-align: right;">-0.3848289</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day28</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA11039</td>
<td style="text-align: left;">KOANM9309M</td>
<td style="text-align: left;">stnf_r1</td>
<td style="text-align: right;">332.0</td>
<td style="text-align: right;">149</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">208.0</td>
<td style="text-align: right;">16683.5</td>
<td style="text-align: right;">219</td>
<td style="text-align: right;">2.521138</td>
<td style="text-align: right;">0.9299112</td>
<td style="text-align: right;">-0.0617211</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day28</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA11037</td>
<td style="text-align: left;">EGPPE6968D</td>
<td style="text-align: left;">stnf_r1</td>
<td style="text-align: right;">309.5</td>
<td style="text-align: right;">146</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">208.0</td>
<td style="text-align: right;">16683.5</td>
<td style="text-align: right;">219</td>
<td style="text-align: right;">2.490661</td>
<td style="text-align: right;">0.8083424</td>
<td style="text-align: right;">-0.1192517</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day0</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA11036</td>
<td style="text-align: left;">LWPQA3913Y</td>
<td style="text-align: left;">stnf_r1</td>
<td style="text-align: right;">697.0</td>
<td style="text-align: right;">132</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">208.0</td>
<td style="text-align: right;">16683.5</td>
<td style="text-align: right;">219</td>
<td style="text-align: right;">2.843233</td>
<td style="text-align: right;">1.8927803</td>
<td style="text-align: right;">0.3939427</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day28</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA11036</td>
<td style="text-align: left;">WIUSH3317X</td>
<td style="text-align: left;">stnf_r1</td>
<td style="text-align: right;">533.0</td>
<td style="text-align: right;">174</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">208.0</td>
<td style="text-align: right;">16683.5</td>
<td style="text-align: right;">219</td>
<td style="text-align: right;">2.726727</td>
<td style="text-align: right;">1.6036457</td>
<td style="text-align: right;">0.2571139</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day0</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA11034</td>
<td style="text-align: left;">HASCA4592S</td>
<td style="text-align: left;">stnf_r1</td>
<td style="text-align: right;">325.5</td>
<td style="text-align: right;">158</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">208.0</td>
<td style="text-align: right;">16683.5</td>
<td style="text-align: right;">219</td>
<td style="text-align: right;">2.512551</td>
<td style="text-align: right;">0.8962949</td>
<td style="text-align: right;">-0.0776295</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day28</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA11040</td>
<td style="text-align: left;">STYAL4876A</td>
<td style="text-align: left;">stnf_r1</td>
<td style="text-align: right;">282.0</td>
<td style="text-align: right;">128</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">208.0</td>
<td style="text-align: right;">16683.5</td>
<td style="text-align: right;">219</td>
<td style="text-align: right;">2.450249</td>
<td style="text-align: right;">0.6371241</td>
<td style="text-align: right;">-0.2002782</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day0</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA11034</td>
<td style="text-align: left;">HLPGU1397F</td>
<td style="text-align: left;">stnf_r1</td>
<td style="text-align: right;">340.0</td>
<td style="text-align: right;">136</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">208.0</td>
<td style="text-align: right;">16683.5</td>
<td style="text-align: right;">219</td>
<td style="text-align: right;">2.531479</td>
<td style="text-align: right;">0.9697451</td>
<td style="text-align: right;">-0.0428702</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day0</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA11033</td>
<td style="text-align: left;">UPJRU9129S</td>
<td style="text-align: left;">stnf_r1</td>
<td style="text-align: right;">258.0</td>
<td style="text-align: right;">109</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">208.0</td>
<td style="text-align: right;">16683.5</td>
<td style="text-align: right;">219</td>
<td style="text-align: right;">2.411620</td>
<td style="text-align: right;">0.4621386</td>
<td style="text-align: right;">-0.2830876</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day28</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA11040</td>
<td style="text-align: left;">JVOSI1587O</td>
<td style="text-align: left;">stnf_r1</td>
<td style="text-align: right;">235.0</td>
<td style="text-align: right;">118</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">208.0</td>
<td style="text-align: right;">16683.5</td>
<td style="text-align: right;">219</td>
<td style="text-align: right;">2.371068</td>
<td style="text-align: right;">0.2657945</td>
<td style="text-align: right;">-0.3760046</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day28</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA12027</td>
<td style="text-align: left;">FCIFG0648D</td>
<td style="text-align: left;">stnf_r1</td>
<td style="text-align: right;">346.0</td>
<td style="text-align: right;">143</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">208.0</td>
<td style="text-align: right;">16683.5</td>
<td style="text-align: right;">219</td>
<td style="text-align: right;">2.539076</td>
<td style="text-align: right;">0.9985658</td>
<td style="text-align: right;">-0.0292313</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day28</td>
<td style="text-align: left;">inpatient</td>
<td style="text-align: left;">discharged</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA12027</td>
<td style="text-align: left;">HJYDE3625F</td>
<td style="text-align: left;">stnf_r1</td>
<td style="text-align: right;">519.5</td>
<td style="text-align: right;">138</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">208.0</td>
<td style="text-align: right;">16683.5</td>
<td style="text-align: right;">219</td>
<td style="text-align: right;">2.715586</td>
<td style="text-align: right;">1.5728778</td>
<td style="text-align: right;">0.2425535</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day0</td>
<td style="text-align: left;">inpatient</td>
<td style="text-align: left;">discharged</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA12026</td>
<td style="text-align: left;">VRHCL9504V</td>
<td style="text-align: left;">stnf_r1</td>
<td style="text-align: right;">288.0</td>
<td style="text-align: right;">187</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">208.0</td>
<td style="text-align: right;">16683.5</td>
<td style="text-align: right;">219</td>
<td style="text-align: right;">2.459392</td>
<td style="text-align: right;">0.6768970</td>
<td style="text-align: right;">-0.1814563</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day28</td>
<td style="text-align: left;">inpatient</td>
<td style="text-align: left;">discharged</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA12026</td>
<td style="text-align: left;">VAYHW1782L</td>
<td style="text-align: left;">stnf_r1</td>
<td style="text-align: right;">977.5</td>
<td style="text-align: right;">224</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">208.0</td>
<td style="text-align: right;">16683.5</td>
<td style="text-align: right;">219</td>
<td style="text-align: right;">2.990117</td>
<td style="text-align: right;">2.1850781</td>
<td style="text-align: right;">0.5322683</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day0</td>
<td style="text-align: left;">inpatient</td>
<td style="text-align: left;">discharged</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA12024</td>
<td style="text-align: left;">NPLGF7754K</td>
<td style="text-align: left;">stnf_r1</td>
<td style="text-align: right;">341.5</td>
<td style="text-align: right;">152</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">208.0</td>
<td style="text-align: right;">16683.5</td>
<td style="text-align: right;">219</td>
<td style="text-align: right;">2.533391</td>
<td style="text-align: right;">0.9770329</td>
<td style="text-align: right;">-0.0394214</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day28</td>
<td style="text-align: left;">inpatient</td>
<td style="text-align: left;">discharged</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA12022</td>
<td style="text-align: left;">JQKTV5449U</td>
<td style="text-align: left;">stnf_r1</td>
<td style="text-align: right;">378.0</td>
<td style="text-align: right;">151</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">208.0</td>
<td style="text-align: right;">16683.5</td>
<td style="text-align: right;">219</td>
<td style="text-align: right;">2.577492</td>
<td style="text-align: right;">1.1387097</td>
<td style="text-align: right;">0.0370898</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day28</td>
<td style="text-align: left;">inpatient</td>
<td style="text-align: left;">discharged</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LA12024</td>
<td style="text-align: left;">FOLVC5757H</td>
<td style="text-align: left;">stnf_r1</td>
<td style="text-align: right;">276.5</td>
<td style="text-align: right;">170</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">208.0</td>
<td style="text-align: right;">16683.5</td>
<td style="text-align: right;">219</td>
<td style="text-align: right;">2.441695</td>
<td style="text-align: right;">0.5993538</td>
<td style="text-align: right;">-0.2181525</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day0</td>
<td style="text-align: left;">inpatient</td>
<td style="text-align: left;">discharged</td>
</tr>
<tr class="even">
<td style="text-align: left;">LA12028</td>
<td style="text-align: left;">YDITP1935G</td>
<td style="text-align: left;">stnf_r1</td>
<td style="text-align: right;">432.0</td>
<td style="text-align: right;">143</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">specimen</td>
<td style="text-align: right;">208.0</td>
<td style="text-align: right;">16683.5</td>
<td style="text-align: right;">219</td>
<td style="text-align: right;">2.635484</td>
<td style="text-align: right;">1.3335822</td>
<td style="text-align: right;">0.1293103</td>
<td style="text-align: left;">/plate_01</td>
<td style="text-align: left;">day0</td>
<td style="text-align: left;">inpatient</td>
<td style="text-align: left;">discharged</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="removing-bad-plates" class="level2" data-number="14.8">
<h2 data-number="14.8" class="anchored" data-anchor-id="removing-bad-plates"><span class="header-section-number">14.8</span> Removing bad plates</h2>
<p>It is really important to remember that a plate may have a very different distribution of values if it contains mostly controls/mostly cases/mostly day 0 specimens etc. or if something went wrong.</p>
<p>Let’s look at what’s on each plate</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>tmp<span class="ot">&lt;-</span>full_data <span class="sc">%&gt;%</span> </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(plate,sample,timepoint,cf_5_inpatient_outcome,inpatient_outpatient) <span class="sc">%&gt;%</span> </span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(plate,timepoint,cf_5_inpatient_outcome,inpatient_outpatient) <span class="sc">%&gt;%</span> </span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="fu">str_c</span>(inpatient_outpatient,timepoint,cf_5_inpatient_outcome,<span class="at">sep=</span><span class="st">" "</span>))</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(<span class="fu">ggplot</span>(tmp,<span class="fu">aes</span>(plate,n))<span class="sc">+</span><span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>)<span class="sc">+</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(.<span class="sc">~</span>type)<span class="sc">+</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>,<span class="at">size=</span><span class="dv">3</span>))</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-6758b042dad21250c5e4" style="width:100%;height:406px;"></div>
<script type="application/json" data-for="htmlwidget-6758b042dad21250c5e4">{"x":{"data":[{"orientation":"v","width":[0.89999999999999991,0.90000000000000013,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.89999999999999947,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.90000000000000213,0.90000000000000568,0.90000000000000568,0.90000000000000568,0.90000000000000568,0.90000000000000568,0.90000000000000568,0.90000000000000568,0.90000000000000568],"base":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40],"y":[23,16,16,16,16,6,6,5,6,5,5,5,5,8,7,2,9,8,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,24,23,23,24,24],"text":["plate: /plate_01<br />n: 23","plate: /plate_02<br />n: 16","plate: /plate_03<br />n: 16","plate: /plate_04<br />n: 16","plate: /plate_05<br />n: 16","plate: /plate_06<br />n:  6","plate: /plate_07<br />n:  6","plate: /plate_08<br />n:  5","plate: /plate_09<br />n:  6","plate: /plate_10<br />n:  5","plate: /plate_11<br />n:  5","plate: /plate_12<br />n:  5","plate: /plate_13<br />n:  5","plate: /plate_14<br />n:  8","plate: /plate_15<br />n:  7","plate: /plate_16<br />n:  2","plate: /plate_17<br />n:  9","plate: /plate_18<br />n:  8","plate: /plate_19<br />n:  6","plate: /plate_20<br />n:  6","plate: /plate_21<br />n:  6","plate: /plate_22<br />n:  6","plate: /plate_23<br />n:  6","plate: /plate_24<br />n:  6","plate: /plate_25<br />n:  6","plate: /plate_26<br />n:  6","plate: /plate_27<br />n:  6","plate: /plate_28<br />n:  6","plate: /plate_29<br />n:  6","plate: /plate_30<br />n:  6","plate: /plate_31<br />n:  6","plate: /plate_32<br />n:  6","plate: /plate_33<br />n:  6","plate: /plate_34<br />n:  6","plate: /plate_40<br />n:  6","plate: /plate_41<br />n: 24","plate: /plate_42<br />n: 23","plate: /plate_43<br />n: 23","plate: /plate_44<br />n: 24","plate: /plate_45<br />n: 24"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(89,89,89,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.90000000000000013,0.90000000000000036,0.90000000000000036,0.89999999999999858],"base":[0,0,0,0],"x":[2,5,6,14],"y":[1,1,1,15],"text":["plate: /plate_02<br />n:  1","plate: /plate_05<br />n:  1","plate: /plate_06<br />n:  1","plate: /plate_14<br />n: 15"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(89,89,89,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"showlegend":false,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.89999999999999991,0.90000000000000013,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.89999999999999947,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.90000000000000213,0.90000000000000568,0.90000000000000568,0.90000000000000568,0.90000000000000568,0.90000000000000568,0.90000000000000568,0.90000000000000568,0.90000000000000568],"base":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40],"y":[15,9,16,15,15,16,18,16,19,18,17,17,22,12,21,25,23,24,18,20,19,18,21,21,22,22,20,22,21,21,21,20,19,18,18,13,12,12,11,10],"text":["plate: /plate_01<br />n: 15","plate: /plate_02<br />n:  9","plate: /plate_03<br />n: 16","plate: /plate_04<br />n: 15","plate: /plate_05<br />n: 15","plate: /plate_06<br />n: 16","plate: /plate_07<br />n: 18","plate: /plate_08<br />n: 16","plate: /plate_09<br />n: 19","plate: /plate_10<br />n: 18","plate: /plate_11<br />n: 17","plate: /plate_12<br />n: 17","plate: /plate_13<br />n: 22","plate: /plate_14<br />n: 12","plate: /plate_15<br />n: 21","plate: /plate_16<br />n: 25","plate: /plate_17<br />n: 23","plate: /plate_18<br />n: 24","plate: /plate_19<br />n: 18","plate: /plate_20<br />n: 20","plate: /plate_21<br />n: 19","plate: /plate_22<br />n: 18","plate: /plate_23<br />n: 21","plate: /plate_24<br />n: 21","plate: /plate_25<br />n: 22","plate: /plate_26<br />n: 22","plate: /plate_27<br />n: 20","plate: /plate_28<br />n: 22","plate: /plate_29<br />n: 21","plate: /plate_30<br />n: 21","plate: /plate_31<br />n: 21","plate: /plate_32<br />n: 20","plate: /plate_33<br />n: 19","plate: /plate_34<br />n: 18","plate: /plate_40<br />n: 18","plate: /plate_41<br />n: 13","plate: /plate_42<br />n: 12","plate: /plate_43<br />n: 12","plate: /plate_44<br />n: 11","plate: /plate_45<br />n: 10"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(89,89,89,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"showlegend":false,"xaxis":"x3","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.89999999999999991,0.90000000000000013,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.89999999999999947,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858],"base":[0,0,0,0,0,0,0,0,0,0,0,0,0],"x":[1,2,4,5,6,8,10,11,12,14,17,22,28],"y":[2,3,2,1,2,2,1,1,1,28,2,2,1],"text":["plate: /plate_01<br />n:  2","plate: /plate_02<br />n:  3","plate: /plate_04<br />n:  2","plate: /plate_05<br />n:  1","plate: /plate_06<br />n:  2","plate: /plate_08<br />n:  2","plate: /plate_10<br />n:  1","plate: /plate_11<br />n:  1","plate: /plate_12<br />n:  1","plate: /plate_14<br />n: 28","plate: /plate_17<br />n:  2","plate: /plate_22<br />n:  2","plate: /plate_28<br />n:  1"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(89,89,89,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.89999999999999991,0.90000000000000013,0.90000000000000036,0.90000000000000036,0.89999999999999947,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.90000000000000213,0.90000000000000568,0.90000000000000568,0.90000000000000568,0.90000000000000568,0.90000000000000568,0.90000000000000568],"base":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"x":[1,2,4,6,8,9,10,12,14,15,17,18,19,20,21,22,24,25,27,28,32,35,36,37,38,39,40],"y":[3,4,2,2,1,1,1,2,4,2,1,1,2,2,1,1,1,1,3,2,1,1,1,1,2,3,3],"text":["plate: /plate_01<br />n:  3","plate: /plate_02<br />n:  4","plate: /plate_04<br />n:  2","plate: /plate_06<br />n:  2","plate: /plate_08<br />n:  1","plate: /plate_09<br />n:  1","plate: /plate_10<br />n:  1","plate: /plate_12<br />n:  2","plate: /plate_14<br />n:  4","plate: /plate_15<br />n:  2","plate: /plate_17<br />n:  1","plate: /plate_18<br />n:  1","plate: /plate_19<br />n:  2","plate: /plate_20<br />n:  2","plate: /plate_21<br />n:  1","plate: /plate_22<br />n:  1","plate: /plate_24<br />n:  1","plate: /plate_25<br />n:  1","plate: /plate_27<br />n:  3","plate: /plate_28<br />n:  2","plate: /plate_32<br />n:  1","plate: /plate_40<br />n:  1","plate: /plate_41<br />n:  1","plate: /plate_42<br />n:  1","plate: /plate_43<br />n:  2","plate: /plate_44<br />n:  3","plate: /plate_45<br />n:  3"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(89,89,89,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"showlegend":false,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.89999999999999991,0.90000000000000013,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.89999999999999947,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.90000000000000213,0.90000000000000568,0.90000000000000568,0.90000000000000568,0.90000000000000568,0.90000000000000568,0.90000000000000568,0.90000000000000568,0.90000000000000568],"base":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40],"y":[12,14,15,15,16,13,18,17,17,19,18,20,19,26,21,22,22,14,16,11,16,17,15,16,17,17,15,12,16,19,15,17,16,9,13,14,14,16,12],"text":["plate: /plate_01<br />n: 12","plate: /plate_02<br />n: 14","plate: /plate_03<br />n: 15","plate: /plate_04<br />n: 15","plate: /plate_05<br />n: 16","plate: /plate_06<br />n: 13","plate: /plate_07<br />n: 18","plate: /plate_08<br />n: 17","plate: /plate_09<br />n: 17","plate: /plate_10<br />n: 19","plate: /plate_11<br />n: 18","plate: /plate_12<br />n: 20","plate: /plate_13<br />n: 19","plate: /plate_15<br />n: 26","plate: /plate_16<br />n: 21","plate: /plate_17<br />n: 22","plate: /plate_18<br />n: 22","plate: /plate_19<br />n: 14","plate: /plate_20<br />n: 16","plate: /plate_21<br />n: 11","plate: /plate_22<br />n: 16","plate: /plate_23<br />n: 17","plate: /plate_24<br />n: 15","plate: /plate_25<br />n: 16","plate: /plate_26<br />n: 17","plate: /plate_27<br />n: 17","plate: /plate_28<br />n: 15","plate: /plate_29<br />n: 12","plate: /plate_30<br />n: 16","plate: /plate_31<br />n: 19","plate: /plate_32<br />n: 15","plate: /plate_33<br />n: 17","plate: /plate_34<br />n: 16","plate: /plate_40<br />n:  9","plate: /plate_41<br />n: 13","plate: /plate_42<br />n: 14","plate: /plate_43<br />n: 14","plate: /plate_44<br />n: 16","plate: /plate_45<br />n: 12"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(89,89,89,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"showlegend":false,"xaxis":"x3","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.90000000000000013,0.90000000000000036,0.90000000000000036,0.89999999999999858,0.89999999999999858],"base":[0,0,0,0,0],"x":[2,4,6,9,16],"y":[1,1,1,1,2],"text":["plate: /plate_02<br />n:  1","plate: /plate_04<br />n:  1","plate: /plate_06<br />n:  1","plate: /plate_09<br />n:  1","plate: /plate_16<br />n:  2"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(89,89,89,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"showlegend":false,"xaxis":"x","yaxis":"y3","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.89999999999999991,0.90000000000000013,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.89999999999999947,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.90000000000000568,0.90000000000000568,0.90000000000000568,0.90000000000000568,0.90000000000000568],"base":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"x":[1,2,3,4,6,7,8,9,11,12,13,15,17,18,19,21,24,26,28,29,35,36,38,39,40],"y":[1,2,2,1,1,1,3,1,1,2,1,1,1,2,2,4,1,1,1,4,1,1,2,1,6],"text":["plate: /plate_01<br />n:  1","plate: /plate_02<br />n:  2","plate: /plate_03<br />n:  2","plate: /plate_04<br />n:  1","plate: /plate_06<br />n:  1","plate: /plate_07<br />n:  1","plate: /plate_08<br />n:  3","plate: /plate_09<br />n:  1","plate: /plate_11<br />n:  1","plate: /plate_12<br />n:  2","plate: /plate_13<br />n:  1","plate: /plate_15<br />n:  1","plate: /plate_17<br />n:  1","plate: /plate_18<br />n:  2","plate: /plate_19<br />n:  2","plate: /plate_21<br />n:  4","plate: /plate_24<br />n:  1","plate: /plate_26<br />n:  1","plate: /plate_28<br />n:  1","plate: /plate_29<br />n:  4","plate: /plate_40<br />n:  1","plate: /plate_41<br />n:  1","plate: /plate_43<br />n:  2","plate: /plate_44<br />n:  1","plate: /plate_45<br />n:  6"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(89,89,89,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"showlegend":false,"xaxis":"x2","yaxis":"y3","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.89999999999999991,0.89999999999999991,0.90000000000000013,0.90000000000000013,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.89999999999999947,0.89999999999999947,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.90000000000000213,0.90000000000000213,0.90000000000000568,0.90000000000000568,0.90000000000000568,0.90000000000000568,0.90000000000000568,0.90000000000000568,0.90000000000000568,0.90000000000000568,0.90000000000000568,0.90000000000000568,0.90000000000000568,0.90000000000000568,0.90000000000000568,0.90000000000000568,0.90000000000000568,0.90000000000000568],"base":[0,12,0,15,0,16,0,13,0,15,0,25,0,19,0,18,0,19,0,23,0,23,0,24,0,26,0,0,0,28,0,0,16,0,22,0,20,0,22,0,21,0,21,0,20,0,19,0,20,0,19,0,17,0,21,0,21,0,21,0,20,0,18,0,19,0,24,0,14,0,16,0,14,0,15,0,12],"x":[1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,14,15,16,16,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,30,30,31,31,32,32,33,33,34,34,35,35,36,36,37,37,38,38,39,39,40,40],"y":[12,12,15,15,16,15,13,15,15,16,25,13,19,18,18,18,19,16,23,13,23,15,24,9,26,7,13,23,28,2,22,16,7,22,16,20,16,22,17,21,16,21,15,20,16,19,16,20,14,19,15,17,16,21,16,21,16,21,13,20,17,18,20,19,21,24,21,14,14,16,14,14,13,15,10,12,13],"text":["plate: /plate_01<br />n: 12","plate: /plate_01<br />n: 12","plate: /plate_02<br />n: 15","plate: /plate_02<br />n: 15","plate: /plate_03<br />n: 16","plate: /plate_03<br />n: 15","plate: /plate_04<br />n: 13","plate: /plate_04<br />n: 15","plate: /plate_05<br />n: 15","plate: /plate_05<br />n: 16","plate: /plate_06<br />n: 25","plate: /plate_06<br />n: 13","plate: /plate_07<br />n: 19","plate: /plate_07<br />n: 18","plate: /plate_08<br />n: 18","plate: /plate_08<br />n: 18","plate: /plate_09<br />n: 19","plate: /plate_09<br />n: 16","plate: /plate_10<br />n: 23","plate: /plate_10<br />n: 13","plate: /plate_11<br />n: 23","plate: /plate_11<br />n: 15","plate: /plate_12<br />n: 24","plate: /plate_12<br />n:  9","plate: /plate_13<br />n: 26","plate: /plate_13<br />n:  7","plate: /plate_14<br />n: 13","plate: /plate_15<br />n: 23","plate: /plate_16<br />n: 28","plate: /plate_16<br />n:  2","plate: /plate_17<br />n: 22","plate: /plate_18<br />n: 16","plate: /plate_18<br />n:  7","plate: /plate_19<br />n: 22","plate: /plate_19<br />n: 16","plate: /plate_20<br />n: 20","plate: /plate_20<br />n: 16","plate: /plate_21<br />n: 22","plate: /plate_21<br />n: 17","plate: /plate_22<br />n: 21","plate: /plate_22<br />n: 16","plate: /plate_23<br />n: 21","plate: /plate_23<br />n: 15","plate: /plate_24<br />n: 20","plate: /plate_24<br />n: 16","plate: /plate_25<br />n: 19","plate: /plate_25<br />n: 16","plate: /plate_26<br />n: 20","plate: /plate_26<br />n: 14","plate: /plate_27<br />n: 19","plate: /plate_27<br />n: 15","plate: /plate_28<br />n: 17","plate: /plate_28<br />n: 16","plate: /plate_29<br />n: 21","plate: /plate_29<br />n: 16","plate: /plate_30<br />n: 21","plate: /plate_30<br />n: 16","plate: /plate_31<br />n: 21","plate: /plate_31<br />n: 13","plate: /plate_32<br />n: 20","plate: /plate_32<br />n: 17","plate: /plate_33<br />n: 18","plate: /plate_33<br />n: 20","plate: /plate_34<br />n: 19","plate: /plate_34<br />n: 21","plate: /plate_40<br />n: 24","plate: /plate_40<br />n: 21","plate: /plate_41<br />n: 14","plate: /plate_41<br />n: 14","plate: /plate_42<br />n: 16","plate: /plate_42<br />n: 14","plate: /plate_43<br />n: 14","plate: /plate_43<br />n: 13","plate: /plate_44<br />n: 15","plate: /plate_44<br />n: 10","plate: /plate_45<br />n: 12","plate: /plate_45<br />n: 13"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(89,89,89,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"showlegend":false,"xaxis":"x3","yaxis":"y3","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":39.37899543378996,"r":7.3059360730593621,"b":47.887090078870912,"l":37.260273972602747},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,0.32857686453576862],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,40.600000000000001],"tickmode":"array","ticktext":["/plate_01","/plate_02","/plate_03","/plate_04","/plate_05","/plate_06","/plate_07","/plate_08","/plate_09","/plate_10","/plate_11","/plate_12","/plate_13","/plate_14","/plate_15","/plate_16","/plate_17","/plate_18","/plate_19","/plate_20","/plate_21","/plate_22","/plate_23","/plate_24","/plate_25","/plate_26","/plate_27","/plate_28","/plate_29","/plate_30","/plate_31","/plate_32","/plate_33","/plate_34","/plate_40","/plate_41","/plate_42","/plate_43","/plate_44","/plate_45"],"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40],"categoryorder":"array","categoryarray":["/plate_01","/plate_02","/plate_03","/plate_04","/plate_05","/plate_06","/plate_07","/plate_08","/plate_09","/plate_10","/plate_11","/plate_12","/plate_13","/plate_14","/plate_15","/plate_16","/plate_17","/plate_18","/plate_19","/plate_20","/plate_21","/plate_22","/plate_23","/plate_24","/plate_25","/plate_26","/plate_27","/plate_28","/plate_29","/plate_30","/plate_31","/plate_32","/plate_33","/plate_34","/plate_40","/plate_41","/plate_42","/plate_43","/plate_44","/plate_45"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":3.9850560398505603},"tickangle":-90,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y3","title":"","hoverformat":".2f"},"annotations":[{"text":"plate","x":0.5,"y":0,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"top","annotationType":"axis","yshift":-28.161062681610623},{"text":"n","x":0,"y":0.5,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xref":"paper","yref":"paper","textangle":-90,"xanchor":"right","yanchor":"center","annotationType":"axis","xshift":-21.917808219178081},{"text":"control control Control","x":0.16428843226788431,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"inpatient day0 died","x":0.5,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"inpatient day0 discharged","x":0.83571156773211563,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"inpatient day0 discharged_pallative","x":0.16428843226788431,"y":0.64687975646879758,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"inpatient day0 other_health_facility","x":0.5,"y":0.64687975646879758,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"inpatient day28 discharged","x":0.83571156773211563,"y":0.64687975646879758,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"inpatient day28 discharged_pallative","x":0.16428843226788431,"y":0.31354642313546427,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"inpatient day28 other_health_facility","x":0.5,"y":0.31354642313546427,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"NA","x":0.83571156773211563,"y":0.31354642313546427,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"}],"yaxis":{"domain":[0.6864535768645359,1],"automargin":true,"type":"linear","autorange":false,"range":[-2.25,47.25],"tickmode":"array","ticktext":["0","10","20","30","40"],"tickvals":[0,10,20,30,40],"categoryorder":"array","categoryarray":["0","10","20","30","40"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":0.32857686453576862,"y0":0.6864535768645359,"y1":1},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":0.32857686453576862,"y0":0,"y1":23.37899543378996,"yanchor":1,"ysizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.33808980213089801,"x1":0.66191019786910199,"y0":0.6864535768645359,"y1":1},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0.33808980213089801,"x1":0.66191019786910199,"y0":0,"y1":23.37899543378996,"yanchor":1,"ysizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.67142313546423127,"x1":1,"y0":0.6864535768645359,"y1":1},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0.67142313546423127,"x1":1,"y0":0,"y1":23.37899543378996,"yanchor":1,"ysizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":0.32857686453576862,"y0":0.35312024353120247,"y1":0.64687975646879758},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":0.32857686453576862,"y0":0,"y1":23.37899543378996,"yanchor":0.64687975646879758,"ysizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.33808980213089801,"x1":0.66191019786910199,"y0":0.35312024353120247,"y1":0.64687975646879758},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0.33808980213089801,"x1":0.66191019786910199,"y0":0,"y1":23.37899543378996,"yanchor":0.64687975646879758,"ysizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.67142313546423127,"x1":1,"y0":0.35312024353120247,"y1":0.64687975646879758},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0.67142313546423127,"x1":1,"y0":0,"y1":23.37899543378996,"yanchor":0.64687975646879758,"ysizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":0.32857686453576862,"y0":0,"y1":0.31354642313546427},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":0.32857686453576862,"y0":0,"y1":23.37899543378996,"yanchor":0.31354642313546427,"ysizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.33808980213089801,"x1":0.66191019786910199,"y0":0,"y1":0.31354642313546427},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0.33808980213089801,"x1":0.66191019786910199,"y0":0,"y1":23.37899543378996,"yanchor":0.31354642313546427,"ysizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.67142313546423127,"x1":1,"y0":0,"y1":0.31354642313546427},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0.67142313546423127,"x1":1,"y0":0,"y1":23.37899543378996,"yanchor":0.31354642313546427,"ysizemode":"pixel"}],"xaxis2":{"type":"linear","autorange":false,"range":[0.40000000000000002,40.600000000000001],"tickmode":"array","ticktext":["/plate_01","/plate_02","/plate_03","/plate_04","/plate_05","/plate_06","/plate_07","/plate_08","/plate_09","/plate_10","/plate_11","/plate_12","/plate_13","/plate_14","/plate_15","/plate_16","/plate_17","/plate_18","/plate_19","/plate_20","/plate_21","/plate_22","/plate_23","/plate_24","/plate_25","/plate_26","/plate_27","/plate_28","/plate_29","/plate_30","/plate_31","/plate_32","/plate_33","/plate_34","/plate_40","/plate_41","/plate_42","/plate_43","/plate_44","/plate_45"],"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40],"categoryorder":"array","categoryarray":["/plate_01","/plate_02","/plate_03","/plate_04","/plate_05","/plate_06","/plate_07","/plate_08","/plate_09","/plate_10","/plate_11","/plate_12","/plate_13","/plate_14","/plate_15","/plate_16","/plate_17","/plate_18","/plate_19","/plate_20","/plate_21","/plate_22","/plate_23","/plate_24","/plate_25","/plate_26","/plate_27","/plate_28","/plate_29","/plate_30","/plate_31","/plate_32","/plate_33","/plate_34","/plate_40","/plate_41","/plate_42","/plate_43","/plate_44","/plate_45"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":3.9850560398505603},"tickangle":-90,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0.33808980213089801,0.66191019786910199],"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y3","title":"","hoverformat":".2f"},"xaxis3":{"type":"linear","autorange":false,"range":[0.40000000000000002,40.600000000000001],"tickmode":"array","ticktext":["/plate_01","/plate_02","/plate_03","/plate_04","/plate_05","/plate_06","/plate_07","/plate_08","/plate_09","/plate_10","/plate_11","/plate_12","/plate_13","/plate_14","/plate_15","/plate_16","/plate_17","/plate_18","/plate_19","/plate_20","/plate_21","/plate_22","/plate_23","/plate_24","/plate_25","/plate_26","/plate_27","/plate_28","/plate_29","/plate_30","/plate_31","/plate_32","/plate_33","/plate_34","/plate_40","/plate_41","/plate_42","/plate_43","/plate_44","/plate_45"],"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40],"categoryorder":"array","categoryarray":["/plate_01","/plate_02","/plate_03","/plate_04","/plate_05","/plate_06","/plate_07","/plate_08","/plate_09","/plate_10","/plate_11","/plate_12","/plate_13","/plate_14","/plate_15","/plate_16","/plate_17","/plate_18","/plate_19","/plate_20","/plate_21","/plate_22","/plate_23","/plate_24","/plate_25","/plate_26","/plate_27","/plate_28","/plate_29","/plate_30","/plate_31","/plate_32","/plate_33","/plate_34","/plate_40","/plate_41","/plate_42","/plate_43","/plate_44","/plate_45"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":3.9850560398505603},"tickangle":-90,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0.67142313546423127,1],"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y3","title":"","hoverformat":".2f"},"yaxis2":{"type":"linear","autorange":false,"range":[-2.25,47.25],"tickmode":"array","ticktext":["0","10","20","30","40"],"tickvals":[0,10,20,30,40],"categoryorder":"array","categoryarray":["0","10","20","30","40"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0.35312024353120247,0.64687975646879758],"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"yaxis3":{"type":"linear","autorange":false,"range":[-2.25,47.25],"tickmode":"array","ticktext":["0","10","20","30","40"],"tickvals":[0,10,20,30,40],"categoryorder":"array","categoryarray":["0","10","20","30","40"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0,0.31354642313546427],"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"160a39db653a":{"x":{},"y":{},"type":"bar"}},"cur_data":"160a39db653a","visdat":{"160a39db653a":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(tmp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>It is clear from this chart that the unusual patterns observed for plate 14 are actually likely to relate to the fact that plate 14 had lots of specimens from people who had bad outcomes. These are likely to be the most sick. Removing this plate would be a very bad idea. Similarly there are some plates to the right of plate 14 which have more ‘good’ outcomes than the other plates. You can see this in the boxplots above this chart, where those plates had slightly depressed levels of some of the cytokines compared to other plates.</p>
<p>There appears to be no reason why the Azu and a few other markers behaved differently in plates 6, 7 and 8. These may have failed for technical reasons and should be removed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>full_data<span class="ot">&lt;-</span> full_data <span class="sc">%&gt;%</span> </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>              plate <span class="sc">!=</span> <span class="st">"plate_06"</span>,</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>              plate <span class="sc">!=</span> <span class="st">"plate_07"</span>,</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>              plate <span class="sc">!=</span> <span class="st">"plate_08"</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>              )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Write the main data frame <code>a</code> to an R object for future use</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(full_data,<span class="at">file =</span> <span class="st">"data/a.RDS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="reality-check" class="level2" data-number="14.9">
<h2 data-number="14.9" class="anchored" data-anchor-id="reality-check"><span class="header-section-number">14.9</span> Reality check</h2>
<p>Think carefully about what you’re going to use this data for. If you’re working in a lab that has routine access to a Luminex machine, then doing fancy maths (transformations, dimensionality reduction, etc) on the variables is a viable option. If you’re really just looking for a marker that you could add to a diagnostic rapid test strip, then you need something really simple. Analysis should always be led by your ultimate purpose.</p>
</section>
<section id="analysis" class="level2" data-number="14.10">
<h2 data-number="14.10" class="anchored" data-anchor-id="analysis"><span class="header-section-number">14.10</span> Analysis</h2>
<section id="expression-of-markers-in-different-clinical-classes-at-day-0" class="level3" data-number="14.10.1">
<h3 data-number="14.10.1" class="anchored" data-anchor-id="expression-of-markers-in-different-clinical-classes-at-day-0"><span class="header-section-number">14.10.1</span> Expression of markers in different clinical classes at day 0</h3>
<p>This example shows how to assess variance in the markers according to clinical class or another variable such as patient admission types.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">filter</span>(full_data,(timepoint<span class="sc">==</span><span class="st">"day0"</span> <span class="sc">|</span> timepoint<span class="sc">==</span><span class="st">"control"</span>) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(inpatient_outpatient)),<span class="fu">aes</span>(Estimate.norm,<span class="at">fill=</span>inpatient_outpatient))<span class="sc">+</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>(<span class="at">alpha=</span><span class="fl">0.3</span>)<span class="sc">+</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.placement=</span><span class="st">'outside'</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>          )<span class="sc">+</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(.<span class="sc">~</span>assay,</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">scales=</span><span class="st">"free_y"</span>,</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">strip.position =</span> <span class="st">'left'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analysis_01_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="1536"></p>
</div>
</div>
<p>Here we can also show the results for the “IL-8” assay on its own</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">filter</span>(full_data,(timepoint<span class="sc">==</span><span class="st">"day0"</span> <span class="sc">|</span> timepoint<span class="sc">==</span><span class="st">"control"</span>) <span class="sc">&amp;</span> assay<span class="sc">==</span><span class="st">"il_8"</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(inpatient_outpatient)),<span class="fu">aes</span>(Estimate.norm,<span class="at">fill=</span>inpatient_outpatient))<span class="sc">+</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha=</span><span class="fl">0.3</span>)<span class="sc">+</span>  </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">8</span>, .<span class="dv">8</span>)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>        )<span class="sc">+</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"IL-8"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analysis_01_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="1536"></p>
</div>
</div>
<p>It’s pretty easy to see the difference between cases and controls. Be careful what you set out to do/prove/associate with a set of immuno-assays such as these ones because not all markers work this well. For instance, IP10 is also really good</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">filter</span>(full_data,(timepoint<span class="sc">==</span><span class="st">"day0"</span> <span class="sc">|</span> timepoint<span class="sc">==</span><span class="st">"control"</span>) <span class="sc">&amp;</span> assay<span class="sc">==</span><span class="st">"ip_10"</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(inpatient_outpatient)),<span class="fu">aes</span>(Estimate.norm,<span class="at">fill=</span>inpatient_outpatient))<span class="sc">+</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha=</span><span class="fl">0.3</span>)<span class="sc">+</span>  </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">8</span>, .<span class="dv">8</span>)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>        )<span class="sc">+</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"IP-10"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analysis_01_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="1536"></p>
</div>
</div>
<p>but TRAIL doesn’t look very specific with respect to severity, and also has a lot of overlap between disease cases and control specimens.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">filter</span>(full_data,(timepoint<span class="sc">==</span><span class="st">"day0"</span> <span class="sc">|</span> timepoint<span class="sc">==</span><span class="st">"control"</span>) <span class="sc">&amp;</span> assay<span class="sc">==</span><span class="st">"trail"</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(inpatient_outpatient)),<span class="fu">aes</span>(Estimate.norm,<span class="at">fill=</span>inpatient_outpatient))<span class="sc">+</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha=</span><span class="fl">0.3</span>)<span class="sc">+</span>  </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">8</span>, .<span class="dv">8</span>)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>        )<span class="sc">+</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"TRAIL"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analysis_01_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="1536"></p>
</div>
</div>
</section>
<section id="expression-of-markers-at-different-time-points" class="level3" data-number="14.10.2">
<h3 data-number="14.10.2" class="anchored" data-anchor-id="expression-of-markers-at-different-time-points"><span class="header-section-number">14.10.2</span> Expression of markers at different time points</h3>
<p>This is similar in most respects to the analysis above. Here we make use of the fact that for some participants, there are paired specimens from day 0 and day 28. We won’t include the people with bad outcomes here because most of them were either dead (so could not provide day 28 specimen), or just did not provide a paired day 28 specimen. To address questions about how measuring increases or decreases in biomarker levels might be prognostic of disease severity/prognosis/progression, you’d need a more granular sampling frame, for instance specimens collected in a longitudinal series.</p>
<p>Here, we can look at how patterns of marker expression changed 28 days after the initial day 0 visit. Note the free y axes on these charts below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(full_data,<span class="fu">aes</span>(Estimate.norm,<span class="at">fill=</span>timepoint))<span class="sc">+</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha=</span><span class="fl">0.3</span>)<span class="sc">+</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(assay<span class="sc">~</span>.,</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">scales =</span> <span class="st">"free_y"</span>,</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">strip.position =</span> <span class="st">'left'</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>             )<span class="sc">+</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.placement=</span><span class="st">'outside'</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>          )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analysis_01_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="1536"></p>
</div>
</div>
<p>This shows pretty much what we’d expect to see in the context of a diseased state at day 0 and a resolved disease state at day 28. Most of these immune response markers were higher at day 0 than at day 28. How much we choose to read in to the individual assay responses is contextual to the specific disease/condition/infection and to different population settings. In this setting, we see a very high level of IP-10 at day 0, and a clear distinction between the day 0 and day 28 groups. These specimens were collected during an outbreak of Dengue virus, and IP-10 has well described associations with Dengue infections.</p>
<p>We can’t infer from the decrease in the resolved cases by day 28 that there was a concomitant increase in biomarker levels in cases which progressed to bad outcomes. We can infer that a number of these markers are indicative of a diseased state, especially if we add back the control group.</p>
<p>Looking at an individual marker can be useful. IL-8 clearly discriminates day 0 cases from controls and day 28 specimens</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">filter</span>(full_data,assay<span class="sc">==</span><span class="st">"il_8"</span>),<span class="fu">aes</span>(Estimate.norm,<span class="at">fill=</span>timepoint))<span class="sc">+</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha=</span><span class="fl">0.3</span>)<span class="sc">+</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="at">alpha=</span><span class="fl">0.3</span>)<span class="sc">+</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(.<span class="sc">~</span>assay)<span class="sc">+</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.8</span>,<span class="fl">0.8</span>),</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.placement=</span><span class="st">'outside'</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>          )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analysis_01_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" width="1536"></p>
</div>
</div>
<p>Meanwhile IP-10 is also great</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">filter</span>(full_data,assay<span class="sc">==</span><span class="st">"ip_10"</span>),<span class="fu">aes</span>(Estimate.norm,<span class="at">fill=</span>timepoint))<span class="sc">+</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha=</span><span class="fl">0.3</span>)<span class="sc">+</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="at">alpha=</span><span class="fl">0.3</span>)<span class="sc">+</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(.<span class="sc">~</span>assay)<span class="sc">+</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.8</span>,<span class="fl">0.8</span>),</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.placement=</span><span class="st">'outside'</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>          )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analysis_01_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="1536"></p>
</div>
</div>
<p>but TRAIL is less conclusive</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">filter</span>(full_data,assay<span class="sc">==</span><span class="st">"trail"</span>),<span class="fu">aes</span>(Estimate.norm,<span class="at">fill=</span>timepoint))<span class="sc">+</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha=</span><span class="fl">0.3</span>)<span class="sc">+</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="at">alpha=</span><span class="fl">0.3</span>)<span class="sc">+</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(.<span class="sc">~</span>assay)<span class="sc">+</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.8</span>,<span class="fl">0.8</span>),</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.placement=</span><span class="st">'outside'</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>          )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analysis_01_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid" width="1536"></p>
</div>
</div>
<p>There’s very obvious differences between the diseased state and those who are recovered for some, but not all of these markers.</p>
</section>
<section id="towards-a-rapid-prognostic-test" class="level3" data-number="14.10.3">
<h3 data-number="14.10.3" class="anchored" data-anchor-id="towards-a-rapid-prognostic-test"><span class="header-section-number">14.10.3</span> Towards a rapid prognostic test</h3>
<p>We can take a look at day 0 and see if we can see differences in IP-10 expression between those who go on to have bad outcomes and those who don’t. Here, we are imagining that a simple rapid ‘dipstick’ type test is the ultimate goal. That limits what manipulations we can do, because tests like that are based on ‘more is worse’ type tests. While the dose response curve of a real world rapid test is not usually strictly linear, we have to find candidate markers that indicate disease/infection when they are more abundant.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>day0_ip10<span class="ot">&lt;-</span> <span class="fu">filter</span>(full_data,assay<span class="sc">==</span><span class="st">"ip_10"</span>,timepoint<span class="sc">==</span><span class="st">"day0"</span>,cf_5_inpatient_outcome<span class="sc">!=</span><span class="st">"other_health_facility"</span>,<span class="sc">!</span><span class="fu">is.na</span>(cf_5_inpatient_outcome))</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(day0_ip10,<span class="fu">aes</span>(Estimate.norm,<span class="at">fill=</span>cf_5_inpatient_outcome))<span class="sc">+</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha=</span><span class="fl">0.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analysis_01_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid" width="1536"></p>
</div>
</div>
<p>Let’s also go back to the data and look at day 0 for all assays</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>day_0 <span class="ot">&lt;-</span> <span class="fu">filter</span>(full_data,timepoint<span class="sc">==</span><span class="st">"day0"</span>,cf_5_inpatient_outcome<span class="sc">!=</span><span class="st">"other_health_facility"</span>,<span class="sc">!</span><span class="fu">is.na</span>(cf_5_inpatient_outcome))</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(day_0,<span class="fu">aes</span>(Estimate.norm,<span class="at">fill=</span>cf_5_inpatient_outcome))<span class="sc">+</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha=</span><span class="fl">0.3</span>)<span class="sc">+</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(assay<span class="sc">~</span>.,</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">scales=</span><span class="st">"free_y"</span>,</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">strip.position =</span> <span class="st">'left'</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>             </span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>             )<span class="sc">+</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.placement=</span><span class="st">'outside'</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>          )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analysis_01_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid" width="1536"></p>
</div>
</div>
<p>Il-8 looks interesting because a lot of the distribution of ‘bad’ values is to the right of the ‘good’ values. This suggests that more of this marker is prognostic of a bad outcome. Interestingly, whilst IP-10 was good at distinguishing the diseased/non-diseased states, it has less obvious use as a prognostic for outcomes. Meanwhile, sTNF-R1, which didn’t look very interesting before, looks like a decent prognostic.</p>
<p>For the following analyses, it’s a pain if any values cross zero, so to make our maths a bit easier, we’ll add a constant to the values. This has the effect of shifting everything to the right so that the minimum value is 1. Doing this also allows for log, square root and other transformations (but we won’t use those here, remembering that we are working towards a dipstick test and want linear responses. The constant is calculated by adding 1 plus the absolute value of the minimum estimated value to each value of <code>Estimate.norm</code>.</p>
<p><span class="math inline">\(Estimate.adj = Estimate+(1+abs(min(Estimate)))\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>day0_stnfr1<span class="ot">&lt;-</span> <span class="fu">filter</span>(full_data,</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>                     assay<span class="sc">==</span><span class="st">"stnf_r1"</span>,</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>                     cf_5_inpatient_outcome<span class="sc">!=</span><span class="st">"other_health_facility"</span>,</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>                     <span class="sc">!</span><span class="fu">is.na</span>(cf_5_inpatient_outcome),</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>                     timepoint<span class="sc">==</span><span class="st">"day0"</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>                     ) <span class="sc">%&gt;%</span>               </span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">Estimate.norm.adj =</span> Estimate.norm<span class="sc">+</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">abs</span>(<span class="fu">min</span>(Estimate.norm)))</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>                    )</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(day0_stnfr1,<span class="fu">aes</span>(Estimate.norm.adj,<span class="at">fill=</span>cf_5_inpatient_outcome,<span class="at">alpha=</span><span class="fl">0.3</span>))<span class="sc">+</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha=</span><span class="fl">0.3</span>)<span class="sc">+</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.8</span>,<span class="fl">0.8</span>),</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.placement=</span><span class="st">'outside'</span></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>          )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analysis_01_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" width="1536"></p>
</div>
</div>
<p>There’s better ways to look at how prognostic this type of measurement could be. Let’s try a ROC analysis, using the <strong>ROCit</strong> package. We’ll apply the <code>rocit</code> command to our sTNF-R1 data (day 0 only).</p>
<p>When using a ROC analysis, you need to be careful to ensure that your outcome variable is a binary factor with the correct reference group. Here, we want to predict who is going to have a bad outcome, so good outcomes should be the reference point.</p>
<p>We also need to collapse the bad outcomes in to a single class “good” (discharged) or “bad” (palliative care / dead)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>day0_stnfr1 <span class="ot">&lt;-</span> day0_stnfr1 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">outcome =</span> <span class="fu">as.factor</span>(<span class="fu">case_when</span>(</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>                                                      cf_5_inpatient_outcome <span class="sc">==</span> <span class="st">"died"</span> <span class="sc">~</span> <span class="st">"Bad"</span>,</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>                                                      cf_5_inpatient_outcome <span class="sc">==</span> <span class="st">"discharged_pallative"</span> <span class="sc">~</span> <span class="st">"Bad"</span>,</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>                                                      cf_5_inpatient_outcome <span class="sc">==</span> <span class="st">"discharged"</span> <span class="sc">~</span> <span class="st">"Good"</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>                                  )),</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>                                    </span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">outcome =</span> <span class="fu">relevel</span>(<span class="fu">as.factor</span>(outcome), <span class="at">ref=</span><span class="st">"Good"</span>)</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>                                  )</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(day0_stnfr1<span class="sc">$</span>outcome)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Good  Bad 
 717   66 </code></pre>
</div>
</div>
<p>Now that we have the correct reference group, we can run the ROC analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">rocit</span>(<span class="at">score=</span>day0_stnfr1<span class="sc">$</span>Estimate.norm.adj,<span class="at">class=</span>day0_stnfr1<span class="sc">$</span>outcome))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                           
 Method used: empirical    
 Number of positive(s): 66 
 Number of negative(s): 717
 Area under curve: 0.5696  </code></pre>
</div>
</div>
<p>It seems to be a reasonably good (but not great) prognostic as the area under the curve (a general indicator of overall performance across a range of threshold values) is somewhat greater than 0.5 (the toss of a coin odds of getting the class right).</p>
<section id="function-to-draw-roc-chart-in-ggplot" class="level4" data-number="14.10.3.1">
<h4 data-number="14.10.3.1" class="anchored" data-anchor-id="function-to-draw-roc-chart-in-ggplot"><span class="header-section-number">14.10.3.1</span> Function to draw ROC chart in ggplot</h4>
<p>ROCit is a really neat package with lots of features, but doesn’t make ggplots. The following function makes a ggplot version of the ROC curves calculated with the <code>rocit</code> command</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>ROCit_plot<span class="ot">&lt;-</span><span class="cf">function</span>(df){</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  roc.curve<span class="ot">&lt;-</span><span class="fu">tibble</span>(</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">TPR=</span>df<span class="sc">$</span>TPR,</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">FPR=</span>df<span class="sc">$</span>FPR</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>  p<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> roc.curve,<span class="fu">aes</span>(FPR,TPR))<span class="sc">+</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>,<span class="at">slope =</span> <span class="dv">1</span>,<span class="at">lty=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">0.8</span>, <span class="at">y =</span> <span class="fl">0.05</span>, <span class="at">label =</span> <span class="fu">str_c</span>(<span class="st">"AUC = "</span>, </span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>                                                             <span class="fu">round</span>(df<span class="sc">$</span>AUC,<span class="dv">2</span>),<span class="at">sep =</span> <span class="st">""</span>) </span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">0.8</span>, <span class="at">y =</span> <span class="fl">0.05</span>, <span class="at">label =</span> <span class="fu">str_c</span>(<span class="st">"AUC = "</span>, </span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>                                                             <span class="fu">round</span>(df<span class="sc">$</span>AUC,<span class="dv">2</span>),<span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>             )</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(p)</span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s now plot the ROC curve and visualise the overall performance of the test.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ROCit_plot</span>(<span class="fu">rocit</span>(<span class="at">score=</span>day0_stnfr1<span class="sc">$</span>Estimate.norm.adj,<span class="at">class=</span>day0_stnfr1<span class="sc">$</span>outcome))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analysis_01_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid" width="1536"></p>
</div>
</div>
<p>To use this data to inform the design of a rapid test, we’d need to find a cutoff value where we felt we got the best balance between sensitivity and specificity.</p>
<p>Let’s get some values out of the ROC analysis, using an arbitrarily chosen threshold at 1.5 units of <code>Estimate.norm.adj</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>roc.stnfr1 <span class="ot">&lt;-</span> <span class="fu">rocit</span>(<span class="at">score=</span>day0_stnfr1<span class="sc">$</span>Estimate.norm.adj,<span class="at">class=</span>day0_stnfr1<span class="sc">$</span>outcome)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>It is pretty simple to extract the sensitivity and specificity values for any threshold value.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>cutoff <span class="ot">=</span> <span class="fl">1.5</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str_c</span>(<span class="st">"Cutoff = "</span>,cutoff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Cutoff = 1.5"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_c</span>(<span class="st">"Sensitivity = "</span>,<span class="fu">round</span>(roc.stnfr1<span class="sc">$</span>TPR[<span class="fu">max</span>(<span class="fu">which</span>(roc.stnfr1<span class="sc">$</span>Cutoff<span class="sc">&gt;</span>cutoff))],<span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Sensitivity = 0.727"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_c</span>(<span class="st">"Specificity = "</span>, <span class="fu">round</span>(<span class="dv">1</span><span class="sc">-</span>(roc.stnfr1<span class="sc">$</span>FPR[<span class="fu">max</span>(<span class="fu">which</span>(roc.stnfr1<span class="sc">$</span>Cutoff<span class="sc">&gt;</span>cutoff))]),<span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Specificity = 0.324"</code></pre>
</div>
</div>
<p>As with basic diagnostics theory, if you increase the threshold, you get more specificity, whilst decreasing the threshold buys you more sensitivity. With different thresholds, you can see this in action</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>cutoff <span class="ot">=</span> <span class="fl">1.1</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">Cutoff =</span> <span class="fu">c</span>(<span class="fl">1.1</span>,<span class="fl">1.4</span>,<span class="fl">1.5</span>,<span class="fl">1.75</span>),</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">Sensitivity =</span> <span class="fu">c</span>(<span class="fu">round</span>(roc.stnfr1<span class="sc">$</span>TPR[<span class="fu">max</span>(<span class="fu">which</span>(roc.stnfr1<span class="sc">$</span>Cutoff<span class="sc">&gt;</span><span class="fl">1.1</span>))],<span class="dv">3</span>),</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">round</span>(roc.stnfr1<span class="sc">$</span>TPR[<span class="fu">max</span>(<span class="fu">which</span>(roc.stnfr1<span class="sc">$</span>Cutoff<span class="sc">&gt;</span><span class="fl">1.4</span>))],<span class="dv">3</span>),</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">round</span>(roc.stnfr1<span class="sc">$</span>TPR[<span class="fu">max</span>(<span class="fu">which</span>(roc.stnfr1<span class="sc">$</span>Cutoff<span class="sc">&gt;</span><span class="fl">1.5</span>))],<span class="dv">3</span>),</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">round</span>(roc.stnfr1<span class="sc">$</span>TPR[<span class="fu">max</span>(<span class="fu">which</span>(roc.stnfr1<span class="sc">$</span>Cutoff<span class="sc">&gt;</span><span class="fl">1.75</span>))],<span class="dv">3</span>)),</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">Specificity =</span> <span class="fu">c</span>(<span class="fu">round</span>(<span class="dv">1</span><span class="sc">-</span>(roc.stnfr1<span class="sc">$</span>FPR[<span class="fu">max</span>(<span class="fu">which</span>(roc.stnfr1<span class="sc">$</span>Cutoff<span class="sc">&gt;</span><span class="fl">1.1</span>))]),<span class="dv">3</span>),</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">round</span>(<span class="dv">1</span><span class="sc">-</span>(roc.stnfr1<span class="sc">$</span>FPR[<span class="fu">max</span>(<span class="fu">which</span>(roc.stnfr1<span class="sc">$</span>Cutoff<span class="sc">&gt;</span><span class="fl">1.4</span>))]),<span class="dv">3</span>),</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">round</span>(<span class="dv">1</span><span class="sc">-</span>(roc.stnfr1<span class="sc">$</span>FPR[<span class="fu">max</span>(<span class="fu">which</span>(roc.stnfr1<span class="sc">$</span>Cutoff<span class="sc">&gt;</span><span class="fl">1.5</span>))]),<span class="dv">3</span>),</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">round</span>(<span class="dv">1</span><span class="sc">-</span>(roc.stnfr1<span class="sc">$</span>FPR[<span class="fu">max</span>(<span class="fu">which</span>(roc.stnfr1<span class="sc">$</span>Cutoff<span class="sc">&gt;</span><span class="fl">1.75</span>))]),<span class="dv">3</span>))</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">Cutoff</th>
<th style="text-align: right;">Sensitivity</th>
<th style="text-align: right;">Specificity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1.10</td>
<td style="text-align: right;">0.985</td>
<td style="text-align: right;">0.003</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.40</td>
<td style="text-align: right;">0.833</td>
<td style="text-align: right;">0.187</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.50</td>
<td style="text-align: right;">0.727</td>
<td style="text-align: right;">0.324</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.75</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.688</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Picking a cutoff is not a trivial pursuit and a lot of care and thought should go in to this.</p>
<p>Your primary thought should be about how you plan to use the test. If you want a really specific test, then a high classification threshold is more appropriate. If you want a more sensitive test, then place the threshold lower down. Some situations may have reasons to avoid the extremes and to go for a threshold somewhere in the middle.</p>
</section>
</section>
</section>
<section id="example-analysis-4-identifying-clusters-via-expectation-maximisation" class="level1" data-number="15">
<h1 data-number="15"><span class="header-section-number">15</span> Example Analysis 4 : Identifying clusters via Expectation Maximisation</h1>
<p>Sometimes you will perform some measures on specimens and will want to identify clusters, or groups of specimens in a way that is driven only by the data. A simple way to do this is to use an expectation maximisation algorithm. The assumption here is that there are two or more normal distributions that overlap, and that those groups reflect some biological or real world characteristic. We often assume that there will be one tall and narrow (the ‘normal’ group) and another low and wide (disease group). This is not always the case, but does reflect the biological reality that biomarker levels are typically low and have low variance when there’s no immune response, but when an immune response happens, expression increases, but with substantial heterogeneity that leads to the wide variance.</p>
<p>In this model we run an EM algorithm from the <code>mixtools</code> package. We’ll set a fixed seed for each modelling process, to ensure reproducibility.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12341</span>)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>OD2<span class="ot">&lt;-</span><span class="fu">normalmixEM</span>(day0_stnfr1<span class="sc">$</span>Estimate.norm.adj)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>number of iterations= 505 </code></pre>
</div>
</div>
<p>It’s a fairly simple process to extract and plot the posterior probability distributions from the model and to chart them. We can also add a vertical line on the 95% centile of the ‘negative’ group. This is controlled by defining how many standard deviations away from the mean the line should be (<code>1.96*OD1$sigma)</code>. 1.96 is the 95th centile, but this could be increased for higher specificity or decreased for lower specificity.</p>
<p>Really this analysis has a lot of analogies with ROC. They are related in lots of ways. Note that here we are making an assumption about normal distributions that may not be true. It also assumes that there’s only two distributions in there.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(day0_stnfr1, <span class="fu">aes</span>(<span class="at">x =</span> Estimate.norm.adj)) <span class="sc">+</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.007</span>,<span class="at">color=</span><span class="st">"white"</span>,<span class="at">fill=</span><span class="st">"grey"</span>) <span class="sc">+</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mapply</span>(</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">function</span>(mean, sd, lambda, n, binwidth) {</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">stat_function</span>(</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">fun =</span> <span class="cf">function</span>(x) {</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>          (<span class="fu">dnorm</span>(x, <span class="at">mean =</span> mean, <span class="at">sd =</span> sd)) <span class="sc">*</span> n <span class="sc">*</span> binwidth <span class="sc">*</span> lambda</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean =</span> OD2[[<span class="st">"mu"</span>]], <span class="co">#mean</span></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd =</span> OD2[[<span class="st">"sigma"</span>]], <span class="co">#standard deviation</span></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">lambda =</span> OD2[[<span class="st">"lambda"</span>]], <span class="co">#amplitude</span></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">length</span>(day0_stnfr1<span class="sc">$</span>Estimate.norm.adj), <span class="co">#sample size</span></span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">binwidth =</span> <span class="fl">0.007</span> <span class="co">#binwidth used for histogram</span></span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span></span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> OD2<span class="sc">$</span>mu[<span class="dv">1</span>]<span class="sc">+</span>(<span class="fl">1.96</span><span class="sc">*</span>OD2<span class="sc">$</span>sigma[<span class="dv">1</span>]),<span class="at">lty=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analysis_01_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid" width="1536"></p>
</div>
</div>
<p>If you thought that the data were better described by four distributions, then you could simply change the assumptions of the EM model. You may also need to increase the value of <code>maxit</code> to allow more iterations. More complex models take longer to converge</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12341</span>)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>OD3<span class="ot">&lt;-</span><span class="fu">normalmixEM</span>(day0_stnfr1<span class="sc">$</span>Estimate.norm.adj, <span class="at">k=</span><span class="dv">3</span>,<span class="at">maxit =</span> <span class="dv">5000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>number of iterations= 1447 </code></pre>
</div>
</div>
<p>You may want to add multiple lines to complex models like this</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(day0_stnfr1, <span class="fu">aes</span>(<span class="at">x =</span> Estimate.norm.adj)) <span class="sc">+</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.007</span>,<span class="at">color=</span><span class="st">"white"</span>,<span class="at">fill=</span><span class="st">"grey"</span>) <span class="sc">+</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mapply</span>(</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">function</span>(mean, sd, lambda, n, binwidth) {</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">stat_function</span>(</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">fun =</span> <span class="cf">function</span>(x) {</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>          (<span class="fu">dnorm</span>(x, <span class="at">mean =</span> mean, <span class="at">sd =</span> sd)) <span class="sc">*</span> n <span class="sc">*</span> binwidth <span class="sc">*</span> lambda</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean =</span> OD3[[<span class="st">"mu"</span>]], <span class="co">#mean</span></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd =</span> OD3[[<span class="st">"sigma"</span>]], <span class="co">#standard deviation</span></span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">lambda =</span> OD3[[<span class="st">"lambda"</span>]], <span class="co">#amplitude</span></span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">length</span>(day0_stnfr1<span class="sc">$</span>Estimate.norm.adj), <span class="co">#sample size</span></span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">binwidth =</span> <span class="fl">0.007</span> <span class="co">#binwidth used for histogram</span></span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span></span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> OD3<span class="sc">$</span>mu[<span class="dv">1</span>]<span class="sc">+</span>(<span class="fl">1.96</span><span class="sc">*</span>OD3<span class="sc">$</span>sigma[<span class="dv">1</span>]),<span class="at">lty=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">1</span>,<span class="at">col=</span><span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> OD3<span class="sc">$</span>mu[<span class="dv">2</span>]<span class="sc">+</span>(<span class="fl">1.96</span><span class="sc">*</span>OD3<span class="sc">$</span>sigma[<span class="dv">2</span>]),<span class="at">lty=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">1</span>,<span class="at">col=</span><span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analysis_01_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid" width="1536"></p>
</div>
</div>
<p>As with most modelling exercises, you may want to compare multiple models to see which describes your data best. Don’t forget that you have some assumptions being used here.</p>
<p>Let’s test to see if a two, three, four, or five distribution model best describes the data.</p>
<p>We’ve already done two and three, so let’s add four</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12343</span>)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>OD4<span class="ot">&lt;-</span><span class="fu">normalmixEM</span>(day0_stnfr1<span class="sc">$</span>Estimate.norm.adj, <span class="at">k=</span><span class="dv">4</span>,<span class="at">maxit =</span> <span class="dv">6000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>number of iterations= 3946 </code></pre>
</div>
</div>
<p>and five</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12341</span>)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>OD5<span class="ot">&lt;-</span><span class="fu">normalmixEM</span>(day0_stnfr1<span class="sc">$</span>Estimate.norm.adj, <span class="at">k=</span><span class="dv">5</span>,<span class="at">maxit =</span> <span class="dv">6000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>number of iterations= 3804 </code></pre>
</div>
</div>
<p>and six</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12341</span>)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>OD6<span class="ot">&lt;-</span><span class="fu">normalmixEM</span>(day0_stnfr1<span class="sc">$</span>Estimate.norm.adj, <span class="at">k=</span><span class="dv">6</span>,<span class="at">maxit =</span> <span class="dv">10000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>number of iterations= 1837 </code></pre>
</div>
</div>
<p>To find the best model, we simply look at the log likelihood values for each model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>mod.table <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">models =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>,</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">log.liklihood =</span> <span class="fu">c</span>(OD2<span class="sc">$</span>loglik,OD3<span class="sc">$</span>loglik,OD4<span class="sc">$</span>loglik,OD5<span class="sc">$</span>loglik,OD6<span class="sc">$</span>loglik)</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>                    )</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(mod.table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">models</th>
<th style="text-align: right;">log.liklihood</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.5111328</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">4.1048346</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">4.9392136</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: right;">6.2638805</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6</td>
<td style="text-align: right;">13.8913185</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>You can see that mathematically, and taking in to account the assumptions, the best model we tested (i.e.&nbsp;the one with the fewest components but the largest log liklihood) is a model with six components. Note in the chart below that the three minor groups are pretty spiky and pretty small. It really looks like a two component model with some noise.</p>
<p>It’s hard to imagine how a 5 component model can be useful in the contenxt of developing a dipstick test. This is a good demonstration of the fact that the maths doesn’t always match the pragmatic operational use of a test. Two component models are pretty much the only viable option for most people.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(day0_stnfr1, <span class="fu">aes</span>(<span class="at">x =</span> Estimate.norm.adj)) <span class="sc">+</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.007</span>,<span class="at">color=</span><span class="st">"white"</span>,<span class="at">fill=</span><span class="st">"grey"</span>) <span class="sc">+</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mapply</span>(</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">function</span>(mean, sd, lambda, n, binwidth) {</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">stat_function</span>(</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">fun =</span> <span class="cf">function</span>(x) {</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>          (<span class="fu">dnorm</span>(x, <span class="at">mean =</span> mean, <span class="at">sd =</span> sd)) <span class="sc">*</span> n <span class="sc">*</span> binwidth <span class="sc">*</span> lambda</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean =</span> OD6[[<span class="st">"mu"</span>]], <span class="co">#mean</span></span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd =</span> OD6[[<span class="st">"sigma"</span>]], <span class="co">#standard deviation</span></span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">lambda =</span> OD6[[<span class="st">"lambda"</span>]], <span class="co">#amplitude</span></span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">length</span>(day0_stnfr1<span class="sc">$</span>Estimate.norm.adj), <span class="co">#sample size</span></span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">binwidth =</span> <span class="fl">0.007</span> <span class="co">#binwidth used for histogram</span></span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analysis_01_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid" width="1536"></p>
</div>
</div>
</section>
<section id="example-analysis-5-identifying-clusters-via-principal-components-analysis-timepoints" class="level1" data-number="16">
<h1 data-number="16"><span class="header-section-number">16</span> Example Analysis 5 : Identifying clusters via Principal Components Analysis : Timepoints</h1>
<p>Principal Components Analysis (PCA) is a relatively simple way to identify clusters and to visualise patterns in the profile-wide expression of cytokines. In order to perform PCA in R, we need to pivot the data in to a wide format.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>b<span class="ot">&lt;-</span>full_data <span class="sc">%&gt;%</span> </span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> <span class="fu">c</span>(test.id,timepoint),<span class="at">names_from =</span> assay, <span class="at">values_from =</span> Estimate.norm) <span class="sc">%&gt;%</span> </span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(.,<span class="fu">select</span>(full_data,sample,test.id,cf_5_inpatient_outcome),<span class="at">by=</span><span class="st">"test.id"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The first step in PCA is to run the <code>prcomp</code> command on the columns of interest. This is necessarily a complete case table with numeric values, so missing values should be imputed. The <code>mice</code> package is good for imputation in R, but isn’t used here as the data are mostly complete. There’s just one missing value which we’ll drop to keep this tutorial focussed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>b<span class="ot">&lt;-</span><span class="fu">filter</span>(b,<span class="sc">!</span><span class="fu">is.na</span>(ang_1))</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [3,198 × 16] (S3: tbl_df/tbl/data.frame)
 $ test.id               : chr [1:3198] "SHGKD1852U" "ILAID4151N" "VGHJM4359F" "KOANM9309M" ...
 $ timepoint             : Factor w/ 3 levels "control","day0",..: 2 2 3 3 2 3 2 3 2 2 ...
 $ il_8                  : num [1:3198] -0.183 -0.0674 -0.1619 -0.0352 -0.0708 ...
 $ stnf_r1               : num [1:3198] -0.376 -0.1708 -0.3848 -0.0617 -0.1193 ...
 $ il_6                  : num [1:3198] -0.1027 -0.0358 -0.0839 -0.024 -0.0436 ...
 $ ang_2                 : num [1:3198] -0.2565 -0.117 -0.1757 -0.0263 -0.0963 ...
 $ ang_1                 : num [1:3198] -0.3442 -0.1223 -0.2816 -0.0393 -0.019 ...
 $ trail                 : num [1:3198] -0.1745 0.0304 -0.239 -0.0885 -0.1108 ...
 $ il_10                 : num [1:3198] -0.1926 -0.1084 -0.1637 -0.0413 -0.0913 ...
 $ strem1                : num [1:3198] -0.47364 -0.1528 -0.30748 -0.12789 0.00108 ...
 $ ip_10                 : num [1:3198] -0.0352 0.5973 -0.2128 -0.1713 -0.1765 ...
 $ azu                   : num [1:3198] -0.0553 -0.0437 -0.0117 0.0234 -0.0241 ...
 $ mxa                   : num [1:3198] -0.0995 0.0628 -0.1966 -0.098 -0.0689 ...
 $ chit                  : num [1:3198] -0.26251 0.09555 -0.19727 0.00249 -0.11033 ...
 $ sample                : chr [1:3198] "LA11033" "LA11039" "LA11037" "LA11039" ...
 $ cf_5_inpatient_outcome: chr [1:3198] NA NA NA NA ...</code></pre>
</div>
</div>
<p>This now looks fine as all the variables are in the right format, so let’s run the PCA commands on the biomarker columns, scaling the data as we go.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">888</span>)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>df.pca<span class="ot">&lt;-</span><span class="fu">prcomp</span>(<span class="fu">select</span>(b,il_8<span class="sc">:</span>chit),<span class="at">scale. =</span> T)</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>df.pca.summary<span class="ot">&lt;-</span><span class="fu">summary</span>(df.pca)</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>df.pca.summary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Importance of components:
                          PC1    PC2    PC3     PC4    PC5    PC6     PC7
Standard deviation     2.5868 1.2279 1.1281 0.81303 0.7707 0.6444 0.55897
Proportion of Variance 0.5576 0.1257 0.1061 0.05508 0.0495 0.0346 0.02604
Cumulative Proportion  0.5576 0.6833 0.7893 0.84443 0.8939 0.9285 0.95456
                           PC8     PC9   PC10    PC11    PC12
Standard deviation     0.50370 0.31430 0.2684 0.25656 0.23422
Proportion of Variance 0.02114 0.00823 0.0060 0.00549 0.00457
Cumulative Proportion  0.97571 0.98394 0.9899 0.99543 1.00000</code></pre>
</div>
</div>
<p>Whenever you work with PCA, it is useful to start by looking at the scree plots, which show (a) the proportion of all variance in the data that are explained by each principal component and (b) the cumulative proportion of variance explained by PCs 1-n.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>df.importance<span class="ot">&lt;-</span><span class="fu">tibble</span>(<span class="at">pc =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(df.pca.summary<span class="sc">$</span>importance[<span class="dv">1</span>,]),</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">standard.deviation =</span> df.pca.summary<span class="sc">$</span>importance[<span class="dv">1</span>,],</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">prop.of.variance =</span> df.pca.summary<span class="sc">$</span>importance[<span class="dv">2</span>,],</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">cumulative.variance =</span> df.pca.summary<span class="sc">$</span>importance[<span class="dv">3</span>,]</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df.importance,<span class="fu">aes</span>(pc,prop.of.variance))<span class="sc">+</span><span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df.importance,<span class="fu">aes</span>(pc,cumulative.variance))<span class="sc">+</span><span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analysis_01_files/figure-html/unnamed-chunk-59-1.png" class="img-fluid" width="1536"></p>
</div>
</div>
<p>It looks like most of the variance is explained by the first principal component.</p>
<p>The <code>prcomp</code> data outputs are not compatible with ggplot, so we’ll grab the PC values and add them to our data frame. This is possible because the <code>prcomp</code> data is embedded in an object <code>x</code> which maps to the original df on a row-by-row basis. This allows merging via the <code>bind_cols</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>b<span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(b,<span class="fu">as.data.frame</span>(df.pca<span class="sc">$</span>x))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Just because the first PC explains the majority of the variance, this doesn’t mean that it is the most informative PC with respect to the differences between different clinical groups.</p>
<p>We can use linear regression to explore this in terms of the day of the specimen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(<span class="at">data =</span> b,<span class="at">formula =</span> timepoint <span class="sc">~</span> PC1<span class="sc">+</span>PC2<span class="sc">+</span>PC3<span class="sc">+</span>PC4<span class="sc">+</span>PC5<span class="sc">+</span>PC6<span class="sc">+</span>PC7<span class="sc">+</span>PC8<span class="sc">+</span>PC9<span class="sc">+</span>PC10<span class="sc">+</span>PC11<span class="sc">+</span>PC12,<span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = timepoint ~ PC1 + PC2 + PC3 + PC4 + PC5 + PC6 + 
    PC7 + PC8 + PC9 + PC10 + PC11 + PC12, family = "binomial", 
    data = b)

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  2.72229    0.10017  27.176  &lt; 2e-16 ***
PC1          0.16889    0.03040   5.556 2.75e-08 ***
PC2         -1.10276    0.09943 -11.091  &lt; 2e-16 ***
PC3          0.21629    0.06728   3.215 0.001305 ** 
PC4         -0.20417    0.09392  -2.174 0.029719 *  
PC5         -0.57056    0.14469  -3.943 8.04e-05 ***
PC6         -0.68866    0.11984  -5.746 9.12e-09 ***
PC7         -0.06555    0.17248  -0.380 0.703911    
PC8         -0.03599    0.21484  -0.168 0.866964    
PC9         -0.17391    0.22012  -0.790 0.429471    
PC10         0.35690    0.23733   1.504 0.132626    
PC11         0.93674    0.26237   3.570 0.000357 ***
PC12         0.88775    0.29217   3.039 0.002377 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 2347.8  on 3197  degrees of freedom
Residual deviance: 1896.7  on 3185  degrees of freedom
AIC: 1922.7

Number of Fisher Scoring iterations: 7</code></pre>
</div>
</div>
<p>Here we can see that several PCs are associated with differences between groups in terms of the timepoint.</p>
<p>Biplots are used to explore PCA data visually. We’ll start by looking at PC1 and PC2. Our chart will be scaled on the x and y axes [using the <code>aspect ratio</code> controls within <code>theme()</code>]so that the dimensions of the chart don’t misrepresent the proportion of variance explained by each PC. The ellipses show the 95% confidence interval for the various groups.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(b,<span class="fu">aes</span>(PC1,PC2,<span class="at">color=</span>timepoint,<span class="at">label=</span>sample,<span class="at">pch=</span>timepoint))<span class="sc">+</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha=</span><span class="fl">0.4</span>,<span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ellipse</span>(<span class="at">geom=</span><span class="st">"polygon"</span>, <span class="fu">aes</span>(<span class="at">fill =</span> timepoint), <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>, <span class="at">level =</span> <span class="fl">0.95</span>)<span class="sc">+</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="at">label =</span> <span class="fu">str_c</span>(<span class="st">"PC1 ("</span>,<span class="fu">round</span>(<span class="dv">100</span><span class="sc">*</span>df.importance<span class="sc">$</span>prop.of.variance[<span class="dv">1</span>],<span class="dv">2</span>),<span class="st">" %)"</span>,<span class="at">sep =</span> <span class="st">""</span>))<span class="sc">+</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="at">label =</span> <span class="fu">str_c</span>(<span class="st">"PC2 ("</span>,<span class="fu">round</span>(<span class="dv">100</span><span class="sc">*</span>df.importance<span class="sc">$</span>prop.of.variance[<span class="dv">2</span>],<span class="dv">2</span>),<span class="st">" %)"</span>,<span class="at">sep =</span> <span class="st">""</span>))<span class="sc">+</span></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio=</span>df.importance<span class="sc">$</span>prop.of.variance[<span class="dv">2</span>]<span class="sc">/</span>df.importance<span class="sc">$</span>prop.of.variance[<span class="dv">1</span>],</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">legend.position =</span> <span class="st">"bottom"</span></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analysis_01_files/figure-html/unnamed-chunk-62-1.png" class="img-fluid" width="1536"></p>
</div>
</div>
<p>There’s some gross effects here that are pretty easy to see. The day 0 specimens are more positive in PC1 and more negative in PC2 than the other two groups. The day 28 specimens look identical to controls. This fits with what we saw in individual marker analysis earlier.</p>
<p>It is hard to interpret this in the context of various markers without understanding which variables contributed to the observed variance in the PCA. A <code>loadings</code> plot is really useful for this. We can get the Loadings from the <code>prcomp</code> object.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>df.pca <span class="sc">%&gt;%</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tidy</span>(<span class="at">matrix =</span> <span class="st">"rotation"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(PC<span class="sc">==</span><span class="st">"1"</span> <span class="sc">|</span> PC<span class="sc">==</span><span class="st">"2"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(column,value)) <span class="sc">+</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>)<span class="sc">+</span></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(PC<span class="sc">~</span>.)<span class="sc">+</span></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analysis_01_files/figure-html/unnamed-chunk-63-1.png" class="img-fluid" width="1536"></p>
</div>
</div>
<p>The loadings plot seems to show that basically all the markers are explaining variation in PC1. A simple interpretation here is that an immune response across the whole profile is the single biggest variation between controls, day 0 and day 28 specimens. Meanwhile there’s more nuance in PC2, where Azu, IP-10 and Mxa associate with movement in the negative direction, whilst Ang-1 and Chit associate with movement in the positive direction. Notable also is that those five markers which associate most with PC2 are the least informative with respect to PC1. This is exactly what we expect with PCA, which is essentially a kind of n<sup>th</sup> dimensional spatial analysis, where movement in one direction is somewhat counter to movement in another direction.</p>
</section>
<section id="example-analysis-6-identifying-clusters-via-principal-components-analysis-outcomes" class="level1" data-number="17">
<h1 data-number="17"><span class="header-section-number">17</span> Example Analysis 6 : Identifying clusters via Principal Components Analysis : Outcomes</h1>
<p>In some circumstances, you might want to look at more specific questions, like “how well does PC1 diagnose bad outcomes?”. For a simple diagnostic like this, we might want to drop the control group so that we are only looking at bad vs good outcomes. We’ll create a new df which just includes these outcomes, then run the PCA.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">888</span>)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>d<span class="ot">&lt;-</span>full_data <span class="sc">%&gt;%</span> </span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> <span class="fu">c</span>(test.id,timepoint),<span class="at">names_from =</span> assay, <span class="at">values_from =</span> Estimate.norm) <span class="sc">%&gt;%</span> </span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(.,<span class="fu">select</span>(full_data,sample,test.id,cf_5_inpatient_outcome)) <span class="sc">%&gt;%</span> </span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>         timepoint <span class="sc">==</span> <span class="st">"day0"</span>,</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>         <span class="sc">!</span><span class="fu">is.na</span>(ang_1),</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>         <span class="sc">!</span><span class="fu">is.na</span>(cf_5_inpatient_outcome)</span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">%&gt;%</span> </span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">outcome =</span> <span class="fu">as.factor</span>(<span class="fu">case_when</span>(</span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a>                                                      cf_5_inpatient_outcome <span class="sc">==</span> <span class="st">"died"</span> <span class="sc">~</span> <span class="st">"Bad"</span>,</span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a>                                                      cf_5_inpatient_outcome <span class="sc">==</span> <span class="st">"discharged_pallative"</span> <span class="sc">~</span> <span class="st">"Bad"</span>,</span>
<span id="cb81-16"><a href="#cb81-16" aria-hidden="true" tabindex="-1"></a>                                                      cf_5_inpatient_outcome <span class="sc">==</span> <span class="st">"discharged"</span> <span class="sc">~</span> <span class="st">"Good"</span></span>
<span id="cb81-17"><a href="#cb81-17" aria-hidden="true" tabindex="-1"></a>                                  )),</span>
<span id="cb81-18"><a href="#cb81-18" aria-hidden="true" tabindex="-1"></a>                                    </span>
<span id="cb81-19"><a href="#cb81-19" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">outcome =</span> <span class="fu">relevel</span>(<span class="fu">as.factor</span>(outcome), <span class="at">ref=</span><span class="st">"Good"</span>)</span>
<span id="cb81-20"><a href="#cb81-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb81-21"><a href="#cb81-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(outcome))</span>
<span id="cb81-22"><a href="#cb81-22" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb81-23"><a href="#cb81-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-24"><a href="#cb81-24" aria-hidden="true" tabindex="-1"></a>df.pca<span class="ot">&lt;-</span><span class="fu">prcomp</span>(<span class="fu">select</span>(d,il_8<span class="sc">:</span>chit),<span class="at">scale. =</span> T)</span>
<span id="cb81-25"><a href="#cb81-25" aria-hidden="true" tabindex="-1"></a>df.pca.summary<span class="ot">&lt;-</span><span class="fu">summary</span>(df.pca)</span>
<span id="cb81-26"><a href="#cb81-26" aria-hidden="true" tabindex="-1"></a>df.pca.summary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Importance of components:
                          PC1    PC2     PC3     PC4     PC5     PC6     PC7
Standard deviation     2.6573 1.1812 1.04344 0.81819 0.78112 0.64480 0.53011
Proportion of Variance 0.5885 0.1163 0.09073 0.05579 0.05085 0.03465 0.02342
Cumulative Proportion  0.5885 0.7047 0.79545 0.85124 0.90208 0.93673 0.96015
                           PC8     PC9    PC10    PC11   PC12
Standard deviation     0.48200 0.29268 0.25389 0.22666 0.2107
Proportion of Variance 0.01936 0.00714 0.00537 0.00428 0.0037
Cumulative Proportion  0.97951 0.98665 0.99202 0.99630 1.0000</code></pre>
</div>
</div>
<p>Then save the importance data to an object and show the scree plots</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>df.importance<span class="ot">&lt;-</span><span class="fu">tibble</span>(<span class="at">pc =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(df.pca.summary<span class="sc">$</span>importance[<span class="dv">1</span>,]),</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">standard.deviation =</span> df.pca.summary<span class="sc">$</span>importance[<span class="dv">1</span>,],</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">prop.of.variance =</span> df.pca.summary<span class="sc">$</span>importance[<span class="dv">2</span>,],</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">cumulative.variance =</span> df.pca.summary<span class="sc">$</span>importance[<span class="dv">3</span>,]</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df.importance,<span class="fu">aes</span>(pc,prop.of.variance))<span class="sc">+</span><span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df.importance,<span class="fu">aes</span>(pc,cumulative.variance))<span class="sc">+</span><span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analysis_01_files/figure-html/unnamed-chunk-65-1.png" class="img-fluid" width="1536"></p>
</div>
</div>
<p>It looks like most of the variance is explained by the first principal component.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>d<span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(d,<span class="fu">as.data.frame</span>(df.pca<span class="sc">$</span>x))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can use linear regression to explore this in terms of the outcomes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(<span class="at">data =</span> d,<span class="at">formula =</span> outcome <span class="sc">~</span> PC1<span class="sc">+</span>PC2<span class="sc">+</span>PC3<span class="sc">+</span>PC4<span class="sc">+</span>PC5<span class="sc">+</span>PC6<span class="sc">+</span>PC7<span class="sc">+</span>PC8<span class="sc">+</span>PC9<span class="sc">+</span>PC10<span class="sc">+</span>PC11<span class="sc">+</span>PC12,<span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = outcome ~ PC1 + PC2 + PC3 + PC4 + PC5 + PC6 + PC7 + 
    PC8 + PC9 + PC10 + PC11 + PC12, family = "binomial", data = d)

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -2.705406   0.164177 -16.479  &lt; 2e-16 ***
PC1          0.081339   0.053240   1.528 0.126568    
PC2          0.120255   0.116785   1.030 0.303144    
PC3         -0.002822   0.109005  -0.026 0.979347    
PC4          0.286575   0.156221   1.834 0.066591 .  
PC5         -0.627712   0.183450  -3.422 0.000622 ***
PC6          0.026040   0.196581   0.132 0.894618    
PC7         -0.546553   0.246166  -2.220 0.026401 *  
PC8         -0.715481   0.247323  -2.893 0.003817 ** 
PC9         -0.309860   0.437927  -0.708 0.479219    
PC10         1.436397   0.514159   2.794 0.005211 ** 
PC11        -0.461633   0.552861  -0.835 0.403724    
PC12        -1.704401   0.652076  -2.614 0.008954 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 452.60  on 781  degrees of freedom
Residual deviance: 397.57  on 769  degrees of freedom
AIC: 423.57

Number of Fisher Scoring iterations: 6</code></pre>
</div>
</div>
<p>Here we can see that several PCs are associated with differences between groups in terms of the timepoint.</p>
<section id="side-note-on-prediction-using-regression-models." class="level4" data-number="17.0.0.1">
<h4 data-number="17.0.0.1" class="anchored" data-anchor-id="side-note-on-prediction-using-regression-models."><span class="header-section-number">17.0.0.1</span> Side note on prediction using regression models.</h4>
<p>If you had a big data set with lots of rows, you could split the data, generate a model like this and then test its performance on new data using <code>predict.</code> In the example here, we feed the training data back in as a pseudo-new data set. This returns a probability of being a ‘bad’ outcome.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(<span class="at">object =</span>  <span class="fu">glm</span>(<span class="at">data =</span> d,<span class="at">formula =</span> outcome <span class="sc">~</span> PC1<span class="sc">+</span>PC2<span class="sc">+</span>PC3<span class="sc">+</span>PC4<span class="sc">+</span>PC5<span class="sc">+</span>PC6<span class="sc">+</span>PC7<span class="sc">+</span>PC8<span class="sc">+</span>PC9<span class="sc">+</span>PC10<span class="sc">+</span>PC11<span class="sc">+</span>PC12,<span class="at">family =</span> <span class="st">"binomial"</span>),<span class="at">newdata=</span>d,<span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>(<span class="fu">select</span>(d,cf_5_inpatient_outcome,predicted))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 782 × 2
   cf_5_inpatient_outcome predicted
   &lt;chr&gt;                      &lt;dbl&gt;
 1 discharged                0.0461
 2 discharged                0.0969
 3 discharged                0.153 
 4 discharged                0.0641
 5 discharged                0.0461
 6 discharged                0.0103
 7 discharged                0.0267
 8 discharged                0.0427
 9 discharged                0.0893
10 discharged_pallative      0.184 
# ℹ 772 more rows</code></pre>
</div>
</div>
<p>A simple view of how well the model performs as a predictor can be seen here</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(d,<span class="fu">aes</span>(outcome,predicted))<span class="sc">+</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.3</span>,<span class="at">height =</span><span class="fl">0.01</span>,<span class="at">size=</span><span class="fl">0.4</span>,<span class="at">alpha=</span><span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analysis_01_files/figure-html/unnamed-chunk-69-1.png" class="img-fluid" width="1536"></p>
</div>
</div>
<p>It isn’t great. Probably because of the small number of bad events. However there is still evidence that this is unlikely to be a valuable diagnostic in this context</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">filter</span>(b,timepoint<span class="sc">==</span><span class="st">"day0"</span>,<span class="sc">!</span><span class="fu">is.na</span>(cf_5_inpatient_outcome),cf_5_inpatient_outcome<span class="sc">!=</span><span class="st">"other_health_facility"</span>),<span class="fu">aes</span>(PC1,PC2,<span class="at">color=</span>cf_5_inpatient_outcome,<span class="at">label=</span>sample,<span class="at">pch=</span>cf_5_inpatient_outcome))<span class="sc">+</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha=</span><span class="fl">0.4</span>,<span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ellipse</span>(<span class="at">geom=</span><span class="st">"polygon"</span>, <span class="fu">aes</span>(<span class="at">fill =</span> cf_5_inpatient_outcome), <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>, <span class="at">level =</span> <span class="fl">0.95</span>)<span class="sc">+</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="at">label =</span> <span class="fu">str_c</span>(<span class="st">"PC1 ("</span>,<span class="fu">round</span>(<span class="dv">100</span><span class="sc">*</span>df.importance<span class="sc">$</span>prop.of.variance[<span class="dv">1</span>],<span class="dv">2</span>),<span class="st">" %)"</span>,<span class="at">sep =</span> <span class="st">""</span>))<span class="sc">+</span></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="at">label =</span> <span class="fu">str_c</span>(<span class="st">"PC2 ("</span>,<span class="fu">round</span>(<span class="dv">100</span><span class="sc">*</span>df.importance<span class="sc">$</span>prop.of.variance[<span class="dv">2</span>],<span class="dv">2</span>),<span class="st">" %)"</span>,<span class="at">sep =</span> <span class="st">""</span>))<span class="sc">+</span></span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio=</span>df.importance<span class="sc">$</span>prop.of.variance[<span class="dv">2</span>]<span class="sc">/</span>df.importance<span class="sc">$</span>prop.of.variance[<span class="dv">1</span>],</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.position =</span> <span class="st">"bottom"</span></span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>          )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analysis_01_files/figure-html/unnamed-chunk-70-1.png" class="img-fluid" width="1536"></p>
</div>
</div>
<p>Because we didn’t have a test/train split in our data and because our dataset is quite small with relatively few bad outcomes, we won’t go any further with this, but do emphasise that this approach can be fruitful.</p>
</section>
<section id="roc-analysis-with-pcs" class="level3" data-number="17.0.1">
<h3 data-number="17.0.1" class="anchored" data-anchor-id="roc-analysis-with-pcs"><span class="header-section-number">17.0.1</span> ROC analysis with PCs</h3>
<p>You could also apply a ROC curve analysis to support your investigation. Let’s get the AUC values for each PC.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">ROC=</span><span class="fu">c</span>(</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>          <span class="fu">str_c</span>(<span class="st">"PC1 : "</span>,<span class="fu">round</span>(<span class="fu">rocit</span>(<span class="at">score=</span>d<span class="sc">$</span>PC1,<span class="at">class=</span>d<span class="sc">$</span>outcome)<span class="sc">$</span>AUC,<span class="dv">2</span>)),</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>          <span class="fu">str_c</span>(<span class="st">"PC2 : "</span>,<span class="fu">round</span>(<span class="fu">rocit</span>(<span class="at">score=</span>d<span class="sc">$</span>PC2,<span class="at">class=</span>d<span class="sc">$</span>outcome)<span class="sc">$</span>AUC,<span class="dv">2</span>)),</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>          <span class="fu">str_c</span>(<span class="st">"PC3 : "</span>,<span class="fu">round</span>(<span class="fu">rocit</span>(<span class="at">score=</span>d<span class="sc">$</span>PC3,<span class="at">class=</span>d<span class="sc">$</span>outcome)<span class="sc">$</span>AUC,<span class="dv">2</span>)),</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>          <span class="fu">str_c</span>(<span class="st">"PC4 : "</span>,<span class="fu">round</span>(<span class="fu">rocit</span>(<span class="at">score=</span>d<span class="sc">$</span>PC4,<span class="at">class=</span>d<span class="sc">$</span>outcome)<span class="sc">$</span>AUC,<span class="dv">2</span>)),</span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>          <span class="fu">str_c</span>(<span class="st">"PC5 : "</span>,<span class="fu">round</span>(<span class="fu">rocit</span>(<span class="at">score=</span>d<span class="sc">$</span>PC5,<span class="at">class=</span>d<span class="sc">$</span>outcome)<span class="sc">$</span>AUC,<span class="dv">2</span>)),</span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>          <span class="fu">str_c</span>(<span class="st">"PC6 : "</span>,<span class="fu">round</span>(<span class="fu">rocit</span>(<span class="at">score=</span>d<span class="sc">$</span>PC6,<span class="at">class=</span>d<span class="sc">$</span>outcome)<span class="sc">$</span>AUC,<span class="dv">2</span>)),</span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>          <span class="fu">str_c</span>(<span class="st">"PC7 : "</span>,<span class="fu">round</span>(<span class="fu">rocit</span>(<span class="at">score=</span>d<span class="sc">$</span>PC7,<span class="at">class=</span>d<span class="sc">$</span>outcome)<span class="sc">$</span>AUC,<span class="dv">2</span>)),</span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>          <span class="fu">str_c</span>(<span class="st">"PC8 : "</span>,<span class="fu">round</span>(<span class="fu">rocit</span>(<span class="at">score=</span>d<span class="sc">$</span>PC8,<span class="at">class=</span>d<span class="sc">$</span>outcome)<span class="sc">$</span>AUC,<span class="dv">2</span>)),</span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a>          <span class="fu">str_c</span>(<span class="st">"PC9 : "</span>,<span class="fu">round</span>(<span class="fu">rocit</span>(<span class="at">score=</span>d<span class="sc">$</span>PC9,<span class="at">class=</span>d<span class="sc">$</span>outcome)<span class="sc">$</span>AUC,<span class="dv">2</span>)),</span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a>          <span class="fu">str_c</span>(<span class="st">"PC10 : "</span>,<span class="fu">round</span>(<span class="fu">rocit</span>(<span class="at">score=</span>d<span class="sc">$</span>PC10,<span class="at">class=</span>d<span class="sc">$</span>outcome)<span class="sc">$</span>AUC,<span class="dv">2</span>)),</span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a>          <span class="fu">str_c</span>(<span class="st">"PC11 : "</span>,<span class="fu">round</span>(<span class="fu">rocit</span>(<span class="at">score=</span>d<span class="sc">$</span>PC11,<span class="at">class=</span>d<span class="sc">$</span>outcome)<span class="sc">$</span>AUC,<span class="dv">2</span>)),</span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a>          <span class="fu">str_c</span>(<span class="st">"PC12 : "</span>,<span class="fu">round</span>(<span class="fu">rocit</span>(<span class="at">score=</span>d<span class="sc">$</span>PC12,<span class="at">class=</span>d<span class="sc">$</span>outcome)<span class="sc">$</span>AUC,<span class="dv">2</span>))</span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb91-17"><a href="#cb91-17" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">ROC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">PC1 : 0.57</td>
</tr>
<tr class="even">
<td style="text-align: left;">PC2 : 0.54</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PC3 : 0.51</td>
</tr>
<tr class="even">
<td style="text-align: left;">PC4 : 0.53</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PC5 : 0.39</td>
</tr>
<tr class="even">
<td style="text-align: left;">PC6 : 0.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PC7 : 0.42</td>
</tr>
<tr class="even">
<td style="text-align: left;">PC8 : 0.42</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PC9 : 0.48</td>
</tr>
<tr class="even">
<td style="text-align: left;">PC10 : 0.52</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PC11 : 0.45</td>
</tr>
<tr class="even">
<td style="text-align: left;">PC12 : 0.42</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>We don’t have any AUC values that are less than 0.5, but if you did, you would need to reverse them. Remember that PCA is rotational, so you get this kind of effect. We fix it simply by reversing the sign on a marker’s scores</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">ROC=</span><span class="fu">c</span>(</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_c</span>(<span class="st">"PC2 : "</span>,<span class="fu">round</span>(<span class="fu">rocit</span>(<span class="at">score=</span>d<span class="sc">$</span>PC11,<span class="at">class=</span>d<span class="sc">$</span>outcome)<span class="sc">$</span>AUC,<span class="dv">2</span>)),</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_c</span>(<span class="st">"PC2 (reversed) : "</span>,<span class="fu">round</span>(<span class="fu">rocit</span>(<span class="at">score=</span><span class="sc">-</span>d<span class="sc">$</span>PC11,<span class="at">class=</span>d<span class="sc">$</span>outcome)<span class="sc">$</span>AUC,<span class="dv">2</span>))</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>    )))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">ROC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">PC2 : 0.45</td>
</tr>
<tr class="even">
<td style="text-align: left;">PC2 (reversed) : 0.55</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Looking at the shape of the curve is also important.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ROCit_plot</span>(<span class="fu">rocit</span>(<span class="at">score=</span>d<span class="sc">$</span>PC1,<span class="at">class=</span>d<span class="sc">$</span>outcome))<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"PC1"</span>)<span class="sc">+</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ROCit_plot</span>(<span class="fu">rocit</span>(<span class="at">score=</span>d<span class="sc">$</span>PC2,<span class="at">class=</span>d<span class="sc">$</span>outcome))<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"PC2"</span>)<span class="sc">+</span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ROCit_plot</span>(<span class="fu">rocit</span>(<span class="at">score=</span><span class="sc">-</span>d<span class="sc">$</span>PC3,<span class="at">class=</span>d<span class="sc">$</span>outcome))<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"PC3"</span>)<span class="sc">+</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ROCit_plot</span>(<span class="fu">rocit</span>(<span class="at">score=</span>d<span class="sc">$</span>PC4,<span class="at">class=</span>d<span class="sc">$</span>outcome))<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"PC4"</span>)<span class="sc">+</span></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ROCit_plot</span>(<span class="fu">rocit</span>(<span class="at">score=</span><span class="sc">-</span>d<span class="sc">$</span>PC5,<span class="at">class=</span>d<span class="sc">$</span>outcome))<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"PC5"</span>)<span class="sc">+</span></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ROCit_plot</span>(<span class="fu">rocit</span>(<span class="at">score=</span>d<span class="sc">$</span>PC6,<span class="at">class=</span>d<span class="sc">$</span>outcome))<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"PC6"</span>)<span class="sc">+</span></span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ROCit_plot</span>(<span class="fu">rocit</span>(<span class="at">score=</span><span class="sc">-</span>d<span class="sc">$</span>PC7,<span class="at">class=</span>d<span class="sc">$</span>outcome))<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"PC7"</span>)<span class="sc">+</span></span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ROCit_plot</span>(<span class="fu">rocit</span>(<span class="at">score=</span><span class="sc">-</span>d<span class="sc">$</span>PC8,<span class="at">class=</span>d<span class="sc">$</span>outcome))<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"PC8"</span>)<span class="sc">+</span></span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ROCit_plot</span>(<span class="fu">rocit</span>(<span class="at">score=</span>d<span class="sc">$</span>PC9,<span class="at">class=</span>d<span class="sc">$</span>outcome))<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"PC9"</span>)<span class="sc">+</span></span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ROCit_plot</span>(<span class="fu">rocit</span>(<span class="at">score=</span><span class="sc">-</span>d<span class="sc">$</span>PC10,<span class="at">class=</span>d<span class="sc">$</span>outcome))<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"PC10"</span>)<span class="sc">+</span></span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ROCit_plot</span>(<span class="fu">rocit</span>(<span class="at">score=</span><span class="sc">-</span>d<span class="sc">$</span>PC11,<span class="at">class=</span>d<span class="sc">$</span>outcome))<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"PC11"</span>)<span class="sc">+</span></span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ROCit_plot</span>(<span class="fu">rocit</span>(<span class="at">score=</span>d<span class="sc">$</span>PC12,<span class="at">class=</span>d<span class="sc">$</span>outcome))<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"PC12"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analysis_01_files/figure-html/unnamed-chunk-73-1.png" class="img-fluid" width="1536"></p>
</div>
</div>
<p>None of these look amazing, but PC1 is probably the best of the bunch. Refer back to earlier where we showed that PC1 is essentially a marker for whether you’re having a significant immune response featuring lots of cytokines.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(d,<span class="fu">aes</span>(PC1,<span class="at">fill=</span>outcome,<span class="at">label=</span>sample))<span class="sc">+</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha=</span><span class="fl">0.4</span>,<span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="at">label =</span> <span class="fu">str_c</span>(<span class="st">"PC1 ("</span>,<span class="fu">round</span>(<span class="dv">100</span><span class="sc">*</span>df.importance<span class="sc">$</span>prop.of.variance[<span class="dv">7</span>],<span class="dv">2</span>),<span class="st">" %)"</span>,<span class="at">sep =</span> <span class="st">""</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analysis_01_files/figure-html/unnamed-chunk-74-1.png" class="img-fluid" width="1536"></p>
</div>
</div>
</section>
</section>
<section id="summary" class="level1" data-number="18">
<h1 data-number="18"><span class="header-section-number">18</span> Summary</h1>
<p>Based on the evidence here, there’s no way to accurately prognosticate the clinical outcome on the basis of these markers, either individually or according to multi-marker expression profiles. This is not surprising given the small number of bad outcomes in the data and given the heterogeneous disease backgrounds of the samples.</p>
<p>This document provides functions and should have taught you how to</p>
<ul>
<li><p>Process Luminex plates in a coherent and tidy manner</p></li>
<li><p>Calibrate standard curves</p></li>
<li><p>Normalise variation between plates</p></li>
<li><p>Analyse data using ROC, Expectation Maximisation, Regression and Principal Components Analysis</p></li>
<li><p>Draw various visualisations of data using ggplot functions.</p></li>
</ul>
</section>
<section id="acknowledgements" class="level1" data-number="19">
<h1 data-number="19"><span class="header-section-number">19</span> Acknowledgements</h1>
<p>The Specimens used in this analysis were collected as part of the Febrile Illness Evaluation in a Broad Range of Endemicity (FIEBRE) study (<a href="https://pubmed.ncbi.nlm.nih.gov/32699131/" class="uri">https://pubmed.ncbi.nlm.nih.gov/32699131/</a>). Clinical work and specimen collection took place at the Institute of Research and Education Development, University of Health Sciences, Ministry of Health, Vientiane, Lao People’s Democratic Republic.</p>
<p>The Febrile Illness Evaluation in a Broad Range of Endemicities study is funded by UK Aid from the UK government; the views expressed, however, do not necessarily reflect the UK government’s official policies. Biomarker analysis is funded by GHLabs (<a href="https://www.ghlabs.org/" class="uri">https://www.ghlabs.org/</a>).</p>
<section id="note-on-open-licences" class="level2" data-number="19.1">
<h2 data-number="19.1" class="anchored" data-anchor-id="note-on-open-licences"><span class="header-section-number">19.1</span> Note on open licences</h2>
<p>The EM code used here is modified from code found on <a href="https://dozenoaks.twelvetreeslab.co.uk/2019/06/mixture-models" class="uri"><em>https://dozenoaks.twelvetreeslab.co.uk/2019/06/mixture-models</em></a><em>. The source code appears to have been aggregated from various open sources and we interpret a copyright notice by the author of the webpage referred to here, to actually refer only to the body text and not to the code presented and subsequently modified for use here. We believe that all of the code statically linked from <a href="https://dozenoaks.twelvetreeslab.co.uk/2019/06/mixture-models" class="uri">https://dozenoaks.twelvetreeslab.co.uk/2019/06/mixture-models</a> is actually open source and likely to be derived from the following sources.</em></p>
<p><a href="https://cran.r-project.org/web/packages/mixtools/index.html" class="uri">https://cran.r-project.org/web/packages/mixtools/index.html</a></p>
<p><a href="https://cran.r-project.org/web/packages/mixtools/vignettes/mixtools.pdf" class="uri">https://cran.r-project.org/web/packages/mixtools/vignettes/mixtools.pdf</a></p>
<p><a href="https://exploringdatablog.blogspot.com/2011/08/fitting-mixture-distributions-with-r.html" class="uri">https://exploringdatablog.blogspot.com/2011/08/fitting-mixture-distributions-with-r.html</a></p>
<p><a href="http://tinyheero.github.io/2015/10/13/mixture-model.html" class="uri">http://tinyheero.github.io/2015/10/13/mixture-model.html</a></p>
<p><a href="http://tinyheero.github.io/2016/01/03/gmm-em.html#checking-for-convergence" class="uri">http://tinyheero.github.io/2016/01/03/gmm-em.html#checking-for-convergence</a></p>
<p>Please respect the licenses of the code originators.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Specimen_Testing.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Specimen Testing</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./appendix.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Funding &amp; Declarations</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>