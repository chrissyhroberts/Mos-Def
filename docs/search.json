[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Supplementary Material : A multiplex bead-based immunoassay and data analysis pipeline for 12 markers of fever severity in dried blood spots",
    "section": "",
    "text": "Tegwen Marlais1, Rebecca L. Handley1, FIEBRE Laos site colleagues, FIEBRE biomarker colleagues, Chris Drakeley1, Heidi Hopkins1, David Mabey1, Chrissy h. Roberts1\n1 Faculty of Infectious and Tropical Diseases, London School of Hygiene and Tropical Medicine, UK\n2 ….. Lao PDR\n\n\n1 Overview\nThis HTML book provides extended supplementary information for [insert final paper title and ref here].\nIt is intended that this resource should provide you with sufficient information to fully reproduce the assay presented in the paper. It also provides information on how to perform quality assurance experiments and to estimate evaluation performance parameters such as the coefficient of variation. We also provide some analysis protocols which will support you to import, process and perform a quality controlled analysis of data from this or any multiplexed immuno-bead assay created on the MagPix platform.\nWe provide a static copy of these documents as a supplement to the paper. A living version (which may be updated in the future) is available on [add github repo here]."
  },
  {
    "objectID": "Marker_List.html#markers-included-in-the-assay",
    "href": "Marker_List.html#markers-included-in-the-assay",
    "title": "2  List of Markers",
    "section": "2.1 Markers included in the assay",
    "text": "2.1 Markers included in the assay\n\n2.1.1 Angiopoietin-1 (Ang-1)\nConstitutively expressed by pericytes and smooth muscle cells, also stored in platelets (Brouwers et al. 2013). Ang-1 is an agonist binding the TIE2 receptor. It promotes endothelial cell survival and maintains vascular quiescence. Activates or inhibits angiogenesis, depending on the context. Ang-1 mediates blood vessel maturation/stability (Leligdowicz et al. 2018).\n\n\n2.1.2 Angiopoietin-2 (Ang-2)\nExpressed by endothelial cells. It binds to TIE2 in competition with Ang-1 but is an antagonist. Increased Ang-2 levels lead to increased vascular leakage, resulting from destabilised vascular endothelium, remodelling, and leakiness (Kim et al. 2016). Ang/Tie2 dysregulation is thought to be “pathogen agnostic” (Leligdowicz et al. 2018).\n\n\n2.1.3 Azurocidin 1 (Azu)\nReleased early in infection from granules in polymorphonuclear leukocytes. Azu acts as a chemo-attractant to several leukocyte types, provokes cytokine secretion, and induces capillary leakage. Azu is directly cytotoxic to certain Gram-negative bacteria (Fisher and Linder 2017).\n\n\n2.1.4 Chitinase 3-like 1 (CHI3L1)\nProduced by many cell types, including immune, epithelial and others. Overexpressed in infectious and non-infectious inflammatory conditions, including sepsis and cancer. Crucial role in protecting against pathogens, antigen- and oxidant-induced injury responses, inflammation, and tissue repair and remodelling. Regulates a range of essential biological processes (Zhao et al. 2020).\n\n\n2.1.5 Interleukin 6 (IL-6)\nTO READ- Rose-John 2018. Replace/cite text below- from Uniprot? Released by T cells and macrophages during chronic and acute inflammation - Key endogenous pyrogen mediating temperature changes leading to fever via stimulation of PGE2 in brain. Procoagulative. Especially elevated in bacterial infections\n\n\n2.1.6 Interleukin 8 (IL-8)\nis produced by many cell types including monocytes, lymphocytes, granulocytes, fibroblasts, endothelial cells, epithelial cells, hepatocytes, mesangial cells and chondrocytes and is released only under inflammatory conditions. Platelets store IL-8 in their granules and rapidly release IL-8 in inflammation (Matsushima, Yang, and Oppenheim 2022).\nReplace/cite text below- from Uniprot?\nMacrophage expression as early marker of infection, Chemotactic factor in target cells, triggers histamine release from target cells and causes angiogenesis. Minor pyrogen. Elevated in bacterial infections\n\n\n2.1.7 Interleukin 10 (IL-10)\nTO READ- Saraiva 2020 & Wei 2019. Replace Uniprot text below. Master regulator of cellular immune response and at high activity mediator of compensatory anti-inflammatory response syndrome in sepsis/SIRS\n\n\n2.1.8 Interferon gamma inducible protein 10 (IP-10)\nis a chemokine released from various immune cells in response to IFNg and other cytokines. Activates and recruits lymphocytes. Elevated in viral and HIV infection, particularly acute HIV [Lei et al. (2019)](Hayney et al. 2017). Associated with disease progression.\n\n\n2.1.9 Myxovirus resistance protein A (MxA)\nTO READ- Haller 2011 Cytoplasmic GTPase with activity against a wide range of viruses\n\n\n2.1.10 Soluble Tumor necrosis factor receptor 1 (sTNFR1)\nIncreased levels of soluble TNFR1 are competitive inhibitors for circulating TNF, thereby reducing signalling through TNFR1 (an endogenous pyrogen) that can promote cell death, tissue damage and subsequent inflammation.\n\n\n2.1.11 Soluble Triggering receptor expressed on myeloid cells (sTREM-1)\nSoluble form of TREM‐1 shed from the membrane of activated phagocytes in response to bacterial and fungal infections.\n\n\n2.1.12 TNF-related apoptosis-inducing ligand (TRAIL)\nElevated in viral infections and possibly downregulated in bacterial infections. Viruses may stimulate TRAIL expression in host or immune cells, may also sensitize host cells to TRAIL-mediated induction of apoptosis"
  },
  {
    "objectID": "Marker_List.html#markers-which-were-screened-but-which-failed-quality-tests",
    "href": "Marker_List.html#markers-which-were-screened-but-which-failed-quality-tests",
    "title": "2  List of Markers",
    "section": "2.2 Markers which were screened, but which failed quality tests",
    "text": "2.2 Markers which were screened, but which failed quality tests\n\n2.2.1 Procalcitonin\nadd some info here - also reason why screened out\n\n\n2.2.2 C-Reactive Protein\nadd some info here - also reason why screened out"
  },
  {
    "objectID": "Marker_List.html#sflt-1",
    "href": "Marker_List.html#sflt-1",
    "title": "2  List of Markers",
    "section": "2.3 sFlt-1",
    "text": "2.3 sFlt-1\nadd some info here - also reason why screened out\n\n\n\n\nBrouwers, Judith, Rintis Noviyanti, Rob Fijnheer, Philip G. de Groot, Leily Trianty, Siti Mudaliana, Mark Roest, Din Syafruddin, Andre van der Ven, and Quirijn de Mast. 2013. “Platelet Activation Determines Angiopoietin-1 and VEGF Levels in Malaria: Implications for Their Use as Biomarkers.” Edited by Ana Paula Arez. PLoS ONE 8 (6): e64850. https://doi.org/10.1371/journal.pone.0064850.\n\n\nFisher, J., and A. Linder. 2017. “Heparin-Binding Protein: A Key Player in the Pathophysiology of Organ Dysfunction in Sepsis.” Journal of Internal Medicine 281 (6): 562–74. https://doi.org/10.1111/joim.12604.\n\n\nHayney, Mary S., Kelsey M. Henriquez, Jodi H. Barnet, Tola Ewers, Heather M. Champion, Sean Flannery, and Bruce Barrett. 2017. “Serum IFN-γ-Induced Protein 10 (IP-10) as a Biomarker for Severity of Acute Respiratory Infection in Healthy Adults.” Journal of Clinical Virology 90 (May): 32–37. https://doi.org/10.1016/j.jcv.2017.03.003.\n\n\nKim, Minah, Breanna Allen, Emilia A. Korhonen, Maximilian Nitschké, Hee Won Yang, Peter Baluk, Pipsa Saharinen, et al. 2016. “Opposing Actions of Angiopoietin-2 on Tie2 Signaling and FOXO1 Activation.” Journal of Clinical Investigation 126 (9): 3511–25. https://doi.org/10.1172/jci84871.\n\n\nLei, Jie, Xiaowan Yin, Hong Shang, and Yongjun Jiang. 2019. “IP-10 Is Highly Involved in HIV Infection.” Cytokine 115 (March): 97–103. https://doi.org/10.1016/j.cyto.2018.11.018.\n\n\nLeligdowicz, Aleksandra, Melissa Richard-Greenblatt, Julie Wright, Valerie M. Crowley, and Kevin C. Kain. 2018. “Endothelial Activation: The Ang/Tie Axis in Sepsis.” Frontiers in Immunology 9 (April). https://doi.org/10.3389/fimmu.2018.00838.\n\n\nMatsushima, Kouji, De Yang, and Joost J. Oppenheim. 2022. “Interleukin-8: An Evolving Chemokine.” Cytokine 153 (May): 155828. https://doi.org/10.1016/j.cyto.2022.155828.\n\n\nZhao, Ting, Zhongping Su, Yingchang Li, Xiaoren Zhang, and Qiang You. 2020. “Chitinase-3 Like-Protein-1 Function and Its Role in Diseases.” Signal Transduction and Targeted Therapy 5 (1). https://doi.org/10.1038/s41392-020-00303-7."
  },
  {
    "objectID": "Buffers_and_Reagents.html#buffers-for-general-assay-procedures",
    "href": "Buffers_and_Reagents.html#buffers-for-general-assay-procedures",
    "title": "3  Buffers & Reagents",
    "section": "3.1 Buffers for general assay procedures",
    "text": "3.1 Buffers for general assay procedures\n\n3.1.1 Deionised water (dH2O)\nFilter 50 mL of deionised water through a 0.2 µm filter into a sterile container.\n\n\n3.1.2 PBS\n1 tablet (Sigma; P4417) per 200 mL deionised water.\n\n\n3.1.3 PBST (wash buffer)\nPBS + 0.5 mL/L (0.05% v/v) Tween 20\nMake fresh every week.\n\n\n3.1.4 PBS-TBN (blocking/storage/assay buffer)\nPBST + 10 mg/mL BSA + 0.5 mg/mL sodium azide\nPer 100 mL PBST, add:\n\n1 g BSA\n500 µL of 10% (100 mg/mL) sodium azide solution in deionised water\n\n*CAUTION* - use appropriate PPE and safety measures when handling solid and liquids with sodium azide.\n\n\nFilter through 0.2 µm filter and store in a fridge until use."
  },
  {
    "objectID": "Buffers_and_Reagents.html#buffers-for-bead-coupling",
    "href": "Buffers_and_Reagents.html#buffers-for-bead-coupling",
    "title": "3  Buffers & Reagents",
    "section": "3.2 Buffers for bead coupling",
    "text": "3.2 Buffers for bead coupling\n\n3.2.1 Activation buffer\n\n0.1 M sodium phosphate monobasic, pH 6.2\n1.19 g NaH2PO4 (Sigma, S8282)\n100 mL dH2O\n\nAdjust pH to 6.2 with 5 or 10 M NaOH Filter through 0.2 µm filter and store in a fridge until use.\n\n\n3.2.2 Blocking / Storage / Assay buffer PBS-TBN\n\nPBST + 10 mg/mL BSA + 0.5 mg/mL sodium azide\n500 µL of 10% (100 mg/mL) sodium azide solution in water.\n\n*CAUTION* - use appropriate PPE and safety measures.\n\nPer 100 mL PBST = 1 g BSA\n50 µL Tween (if made in PBS)\n\n\n\n3.2.3 Coupling buffer\n\n50 mM MES, pH 5.0\n\n0.976 g MES (Sigma, M3671)\n100 mL dH2O\n\n\nAdjust pH to 5 with 5 or 10 M NaOH Filter through 0.2 µm filter and store in a fridge until use.\n\n\n3.2.4 PBS\n\n1 tablet (Sigma; P4417) per 200 mL dH2O\n\n\n\n3.2.5 Wash buffer PBST\n\nPBS + 0.5 mL/L Tween 20\n\n\n\n3.2.6"
  },
  {
    "objectID": "Buffers_and_Reagents.html#reagents",
    "href": "Buffers_and_Reagents.html#reagents",
    "title": "3  Buffers & Reagents",
    "section": "3.3 Reagents",
    "text": "3.3 Reagents\nThe following equipment and reagents are needed\n\n\n\nBuy these things\n\n\n\n\n\n\n\n\nManufacturer\nPart No.\nQuantity\nPRODUCT DESCRIPTION\n\n\n\n\nbio-techne\n370-0010\n3\nLightning-Link (R) Rapid Type A Biotin Antibody Labeling Kit\n\n\nBio-Rad\n171025001\n40\nBio-Plex Pro Black plates\n\n\nNA\n40-50030\n40\nLuminex drive fluid pack of 4 (does 40 plates)\n\n\nNA\nNA\nNA\nPBS tabs (Sigma)\n\n\nRoche\n11697498001\n20 tabs\nProtease inhibitor 20 tabs\n\n\nThermo\nMPX-CAL-K25\n25 weeks\nMagPix Calibration kit\n\n\nThermo\nMPX-PVER-K25\n25 days\nMagPix Verification kit\n\n\nNA\nNA\nNA\nBSA\n\n\nSigma\n11851335\n5 g\nEDC\n\n\nSigma\n10391314\n500 mg\nNHS\n\n\nany suitable\nNA\nNA\nSticky plate covers\n\n\nany suitable\nS1111-1706\n10\n200 µl tips (Starlab)\n\n\nThermo\nS866\n100\nSA-PE (1 mg) [enough for 100 plates]"
  },
  {
    "objectID": "Capture_Antibody_Prep.html#capture-antibodies",
    "href": "Capture_Antibody_Prep.html#capture-antibodies",
    "title": "4  Capture Antibody Preparation",
    "section": "4.1 Capture Antibodies",
    "text": "4.1 Capture Antibodies\n\n\n\n\n\n\n\n\n\n\n\n\nManufacturer\nPart No.\nQuantity\nPRODUCT DESCRIPTION\nComponent\n\n\n\n\nbio-techne\nH00054210-M04\n100 µg\nTREM1 Antibody (2E2)\nCapture\n\n\nbio-techne\nMAB206-100\n100 µg\nHuman/Primate IL-6 MAb (Clone 6708)\nCapture\n\n\nbio-techne\nMAB206-500\n500 µg\nHuman/Primate IL-6 MAb (Clone 6708)\nCapture\n\n\nbio-techne\nMAB2172-100\n100 µg\nHuman IL-10 MAb (Clone 127107)\nCapture\n\n\nbio-techne\nMAB2172-500\n500 µg\nHuman IL-10 MAb (Clone 127107)\nCapture\n\n\nbio-techne\nMAB225-500\n500 µg\nHuman TNF RI/TNFRSF1A MAb (Clone 16803)\nCapture\n\n\nbio-techne\nMAB225-100\n100 µg\nHuman TNF RI/TNFRSF1A MAb (Clone 16803)\nCapture\n\n\nbio-techne\nMAB25991-100\n100 µg\nHuman/Primate Chitinase 3-like 1 MAb (Clone 384327)\nCapture\n\n\nbio-techne\nMAB266-100\n100 µg\nHuman CXCL10/IP-10/CRG-2 MAb (Clone 33036)\nCapture\n\n\nbio-techne\nMAB266-500\n500 µg\nHuman CXCL10/IP-10/CRG-2 MAb (Clone 33036)\nCapture\n\n\nbio-techne\nMAB375-500\n500 µg\nHuman TRAIL/TNFSF10 MAb (Clone 75411)\nCapture\n\n\nbio-techne\nMAB375-100\n100 µg\nHuman TRAIL/TNFSF10 MAb (Clone 75411)\nCapture\n\n\nbio-techne\nMAB9231-100\n100 µg\nHuman Angiopoietin-1 MAb (Clone 171733)\nCapture\n\n\nbio-techne\nNB110-85467\n100 µg\nAngiopoietin-2 Antibody (MM0020-1F29)\nCapture\n\n\nbio-techne\nNBP2-12045\n100 µg\nAzurocidin/CAP37/HBP Antibody (MM0099-7F31)\nCapture\n\n\nThermo\nM801\n500 µg\nAnti IL-8 (clone 3IL8-H10)\nCapture\n\n\nThermo\nMA5-24914\n100 µg\nAnti MxA\nCapture"
  },
  {
    "objectID": "Capture_Antibody_Prep.html#required-equipment-consumables",
    "href": "Capture_Antibody_Prep.html#required-equipment-consumables",
    "title": "4  Capture Antibody Preparation",
    "section": "4.2 Required Equipment & Consumables",
    "text": "4.2 Required Equipment & Consumables\n\n\n\n\n\n\n\n\nItem\nSupplier\nCatalogue Number\n\n\n\n\nPipettes and tips for 100-200 µL\nAny suitable\n\n\n\n0.2 µm syringe filter or bottle filter unit\nAny suitable\n\n\n\nSyringe, 50 mL, sterile\nAny suitable\n\n\n\n50 mL tube, sterile\nAny suitable\n\n\n\nProtein low-bind microtubes\nEppendorf\n0030108116\n\n\nLabels or permanent marker pen\nAny suitable\n\n\n\nPhosphate buffered saline (PBS)\nSigma"
  },
  {
    "objectID": "Capture_Antibody_Prep.html#protocol",
    "href": "Capture_Antibody_Prep.html#protocol",
    "title": "4  Capture Antibody Preparation",
    "section": "4.3 Protocol",
    "text": "4.3 Protocol\n\nMake up PBS as per Buffers protocol (S2 file).\nSet out\nRemove antibodies from freezer storage.\nAdd 100 µL of the PBS to each lyophilised antibody (anti IL-8 and MxA are already liquid).\nAllow to rehydrate for a few minutes, vortex gently.\nAliquot into 10 µL volumes and store at –20°C or below.\n\nAll capture antibodies are now at the same stock concentration of 1 mg/mL."
  },
  {
    "objectID": "Bead_Coupling.html#assay-specific-reagents",
    "href": "Bead_Coupling.html#assay-specific-reagents",
    "title": "5  Bead Coupling",
    "section": "5.1 Assay-specific reagents",
    "text": "5.1 Assay-specific reagents\n\n\n\n\n\n\n\n\n\n\n\nMarker\nComponent\nCatalogue #\nSupplier\nBead region\nµg antibody/million beads\n\n\n\n\nAng-1\nBeads\nMC10018-01\nLuminex\n18\n5\n\n\nAng-2\nBeads\nMC10015-01\nLuminex\n15\n5\n\n\nAzu\nBeads\nMC10027-01\nLuminex\n27\n7\n\n\nCHI3L1\nBeads\nMC10030-01\nLuminex\n30\n4.5\n\n\nIL-6\nBeads\nMC10021-01\nLuminex\n21\n5\n\n\nIL-8\nBeads\nMC10022-01\nLuminex\n22\n5\n\n\nIL-10\nBeads\nMC10026-01\nLuminex\n26\n4\n\n\nIP-10\nBeads\nMC10029-01\nLuminex\n29\n5\n\n\nMxA\nBeads\nMC10028-01\nLuminex\n28\n6\n\n\nsTNFR1\nBeads\nMC10020-01\nLuminex\n20\n6\n\n\nsTREM-1\nBeads\nMC10014-01\nLuminex\n14\n6\n\n\nTRAIL\nBeads\nMC10025-01\nLuminex\n25\n6\n\n\nAng-1\nCapture antibody\nMAB9231\nBio-techne\n18\n5\n\n\nAng-2\nCapture antibody\nNB110-85467\nBio-techne\n15\n5\n\n\nAzu\nCapture antibody\nNBP2-12045\nBio-techne\n27\n7\n\n\nCHI3L1\nCapture antibody\nMAB25991\nBio-techne\n30\n4.5\n\n\nIL-6\nCapture antibody\nMAB206\nBio-techne\n21\n5\n\n\nIL-8\nCapture antibody\nM801 (Thermo)\nBio-techne\n22\n5\n\n\nIL-10\nCapture antibody\nMAB2172\nBio-techne\n26\n4\n\n\nIP-10\nCapture antibody\nMAB266\nBio-techne\n29\n5\n\n\nMxA\nCapture antibody\nMA5-24914\nBio-techne\n28\n6\n\n\nsTNFR1\nCapture antibody\nMAB225\nBio-techne\n20\n6\n\n\nsTREM-1\nCapture antibody\nH00054210-M04\nBio-techne\n14\n6\n\n\nTRAIL\nCapture antibody\nMAB375\nBio-techne\n25\n6"
  },
  {
    "objectID": "Bead_Coupling.html#other-consumables-reagents-and-equipment-needed.",
    "href": "Bead_Coupling.html#other-consumables-reagents-and-equipment-needed.",
    "title": "5  Bead Coupling",
    "section": "5.2 Other consumables, reagents and equipment needed.",
    "text": "5.2 Other consumables, reagents and equipment needed.\n\n\n\n\n\n\n\n\nItem\nSupplier\nCatalogue number\n\n\n\n\nSodium phosphate monobasic (NaH2PO4)\nSigma\n\n\n\nSodium hydroxide (NaOH)\nSigma\n\n\n\nPhosphate buffered saline (PBS)\nSigma\n\n\n\nSulfo-NHS\nThermo\n24510\n\n\nEDC\nThermo\n22980\n\n\nProtein low-bind microtubes, 1 per coupling\nEppendorf\n0030108116/0030108132\n\n\nPipettes and tips for 10 µL, 200 µL, 1 mL\nAny suitable\n\n\n\n0.2 µm syringe filters\nAny suitable\n\n\n\nSyringe, 50 mL, sterile\nAny suitable\n\n\n\n50 mL tube, sterile\nAny suitable\n\n\n\nMagnetic tube rack\nInvitrogen\nCS15000\n\n\nEnd-over-end rotating mixer\nAny suitable\n\n\n\nFine balance\nAny suitable\n\n\n\npH meter\nAny suitable\n\n\n\nSonicating waterbath\nVWR\n142-6044"
  },
  {
    "objectID": "Bead_Coupling.html#preparation",
    "href": "Bead_Coupling.html#preparation",
    "title": "5  Bead Coupling",
    "section": "5.3 Preparation",
    "text": "5.3 Preparation\nThis protocol uses EDC [1-ethyl-3-(3-dimethylaminopropyl)carbodiimide hydrochloride)]. EDC absorbs moisture from the air. It is helpful to aliquot it into 50 mg, single-use, amounts in screw cap tubes on receipt and to store these in individual ziplock bags with desiccant, at -20° C.\nFor quality assurance processes, we recommend keeping note of the lot numbers and expiry dates of both beads and capture antibodies. The diagnostic performance of beads changes with time and we do not recommend using coupled beads that are more than two months old."
  },
  {
    "objectID": "Bead_Coupling.html#protocol-a---coupling-beads-for-8-plates",
    "href": "Bead_Coupling.html#protocol-a---coupling-beads-for-8-plates",
    "title": "5  Bead Coupling",
    "section": "5.4 Protocol A - Coupling beads for 8 plates",
    "text": "5.4 Protocol A - Coupling beads for 8 plates\n⌚ Timing: 2 hours, then 2 hours incubation, 1h45m to finish. Total approx. 5h45m.\nThis protocol takes place at ambient temperature. All incubations are at ambient temperature.\nTip: Protect beads from light with a foil cover when they are not being manipulated such as during incubations.\n\nLabel tubes (Eppendorf, protein lo-bind) one for each coupling, with at least antigen name and bead region.\nVortex and sonicate the bead stocks for ~60 seconds of each. Vortex some more immediately before pipetting.\nTransfer 120 µL of bead stock (1.5 x 106 beads for 8 full plates) into each respective tube.\nPut tubes in magnet rack for 60 s.\nRemove supernatant without disturbing beads.\nRemove tubes from magnet rack. Add 100 µL dH2O. Vortex & sonicate for ~20 s of each.\nTube into magnet rack, 60 s.\nRemove supernatant without disturbing beads.\nRemove tube from magnet rack. Add 80 µL Activation buffer (0.1 M sodium phosphate, pH 6.2). Vortex & sonicate, ~20 s each.\nMake up 50 mg/mL sulfo-NHS (Thermo, 24510) and 50 mg/mL EDC (Thermo, 22980) in Activation buffer, in separate tubes. Use max 25 mg in 500 µL (for 12 couplings).\nAdd 10 µL of the sulfo-NHS solution to the beads. Vortex.\nAdd 10 µL of the EDC solution to the beads. Vortex.\nIncubate 10 mins @ room temp. Vortex. Incubate for further 10 mins.\nDuring the incubation, set up new tubes for Ab dilution in MES buffer.\nTo 400 µL MES, minus the volume of Ab, add in this much of each Ab:\n\n\n\n\n\n\n\n\n\n\nAntibody on bead\nAb catalogue number (bio-techne unless stated)\nAntibody amount per million beads\nVolume of capture antibody needed for 1.5e6 beads (µL)\n\n\n\n\nAng-1\nMAB9231\n5\n7.5\n\n\nAng-2\nNB110-85467\n5\n7.5\n\n\nAzu\nNBP2-12045\n7\n10.5\n\n\nCHI3L1\nMAB25991\n4.5\n6.8\n\n\nIL-6\nMAB206\n5\n7.5\n\n\nIL-8\nM801 (Thermo)\n5\n7.5\n\n\nIL-10\nMAB2172\n4\n6.0\n\n\nIP-10\nMAB266\n5\n7.5\n\n\nMxA\nMA5-24914 (Thermo)\n6\n9.0\n\n\nsTNF-R1\nMAB225\n6\n9.0\n\n\nsTREM1\nH00054210-M04\n6\n9.0\n\n\nTRAIL\nMAB375\n6\n9.0\n\n\n\n\nSet these Ab tubes aside and continue with the beads.\nBead tube into magnet rack, 60 s.\nRemove supernatant without disturbing beads.\nMES wash 1: Remove tube from magnet rack. Add 250 µL MES buffer. Vortex & sonicate for ~ 20 s each.\nTube into magnet rack, 60 s.\nRemove supernatant without disturbing beads.\nMES wash 2: Remove tube from magnet rack. Add 250 µL MES buffer. Vortex & sonicate for ~ 20 s each.\nTube into magnet rack, 60 s.\nRemove supernatant without disturbing beads.\nAdd 100 µL MES buffer to each bead tube.\nTransfer 400 µL of each antibody dilution into the respective bead tubes and vortex.\nIncubate 2 hours on mixer at room temp. Start time _______________\nTube into magnet rack, 60 s.\nRemove supernatant without disturbing beads.\nRemove tube from magnet rack. Add 500 µL PBS-TBN. Vortex & sonicate for ~20 s.\nTube into magnet rack, 60 s.\nRemove supernatant without disturbing beads.\nPBS-TBN wash 1: Remove tube from magnet rack. Add 1 mL PBS-TBN. Vortex & sonicate for ~20 s.\nTube into magnet rack, 60 s.\nRemove supernatant without disturbing beads.\nPBS-TBN wash 2: Remove tube from magnet rack. Add 1 mL PBS-TBN. Vortex & sonicate for ~20 s.\nTube into magnet rack, 60 s.\nRemove supernatant without disturbing beads.\nRemove tube from magnet rack. Resuspend coupled beads in 200 µL PBS-TBN. Vortex.\nEnsure newly coupled beads are fully labelled.\nStore the coupled beads in the fridge."
  },
  {
    "objectID": "Bead_Coupling.html#protocol-b---coupling-beads-for-52-plates",
    "href": "Bead_Coupling.html#protocol-b---coupling-beads-for-52-plates",
    "title": "5  Bead Coupling",
    "section": "5.5 Protocol B - Coupling beads for 52 plates",
    "text": "5.5 Protocol B - Coupling beads for 52 plates\n⌚ Timing: 2 hours, then 2 hours incubation, 1h45m to finish. Total approx. 5h45m.\nThe protocol takes place at ambient temperature. All incubations are at ambient temperature.\n\nLabel tubes (Eppendorf, protein lo-bind) one for each coupling.\nVortex and sonicate the bead stocks for ~60 s of each. Vortex some more immediately before pipetting.\nTransfer 0.5 mL of bead stock (6.25 x 106 beads for ~52 full plates) into each respective tube.\nPut tube in magnet rack for 60 s.\nRemove supernatant without disturbing beads.\nRemove tube from magnet rack. Add 100 µL dH2O. Vortex & sonicate for ~20 s of each.\nTube into magnet rack, 60 s.\nRemove supernatant without disturbing beads.\nRemove tube from magnet rack. Add 80 µL Activation buffer. Vortex & sonicate, ~20 s each.\nIn separate tubes, make up 50 mg/mL sulfo-NHS and 50 mg/mL EDC in Activation buffer. These should always be made fresh, immediately before use, and not stored.\nAdd 10 µL of the sulfo-NHS solution to the beads. Vortex.\nAdd 10 µL of the EDC solution to the beads. Vortex.\nIncubate 10 mins @ room temp. Vortex. Incubate for further 10 mins.\nDuring the incubation, set up 1.5 mL tubes for antibody dilution in MES buffer. One tube per bead region.\nDispense 400 µL MES to each tube.\nRemove the MES volume indicated for each Ab in the table below (bold numbers).\nAdd in the indicated amount of Ab stock:\n\n\n\n\n\n\n\n\n\n\nAntibody on bead\nAb catalogue number (bio-techne unless stated)\nAntibody amount per million beads\nVolume of capture antibody needed for 1.5e6 beads (µL)\n\n\n\n\nAng-1\nMAB9231\n5\n31.3\n\n\nAng-2\nNB110-85467\n5\n31.3\n\n\nAzu\nNBP2-12045\n7\n43.8\n\n\nCH3L1\nMAB25991\n4.5\n28.1\n\n\nIL-6\nMAB206\n5\n31.3\n\n\nIL-8\nM801 (Thermo)\n5\n31.3\n\n\nIL-10\nMAB2172\n4\n25.0\n\n\nIP-10\nMAB266\n5\n31.3\n\n\nMxA\nMA5-24914 (Thermo)\n6\n37.5\n\n\nsTNF-R1\nMAB225\n6\n37.5\n\n\nsTREM1\nH00054210-M04\n6\n37.5\n\n\nTRAIL\nMAB375\n6\n37.5\n\n\n\nSet these Ab tubes aside and continue with the beads….\n\nBead tube into magnet rack, 60 s.\nRemove supernatant without disturbing beads.\nMES wash 1: Remove tube from magnet rack. Add 500 µL MES buffer. Vortex & sonicate for ~ 20 s each.\nTube into magnet rack, 60 s.\nRemove supernatant without disturbing beads.\nMES wash 2: Remove tube from magnet rack. Add 500 µL MES buffer. Vortex & sonicate for ~ 20 s each.\nTube into magnet rack, 60 s.\nRemove supernatant without disturbing beads.\nAdd 100 µL MES buffer to beads.\nTransfer all 400 µL of each antibody dilution into the respective bead tubes and vortex. (So the antibody amount is eventually diluted in 0.5 mL of MES by the time it is incubated with the beads, as per scale-up table).\nIncubate 2 hours on mixer at room temp. Start time _______________\nTube into magnet rack, 60 s.\nRemove supernatant without disturbing beads.\nRemove tube from magnet rack. Add 0.5 mL PBS-TBN. Vortex & sonicate for ~20 s.\nTube into magnet rack, 60 s.\nRemove supernatant without disturbing beads.\nPBS-TBN wash 1: Remove tube from magnet rack. Add 1 mL PBS-TBN. Vortex & sonicate for ~20 s.\nTube into magnet rack, 60 s.\nRemove supernatant without disturbing beads.\nPBS-TBN wash 2: Remove tube from magnet rack. Add 1 mL PBS-TBN. Vortex & sonicate for ~20 s.\nTube into magnet rack, 60 s.\nRemove supernatant without disturbing beads.\nRemove tube from magnet rack. Resuspend coupled beads in 830 µL PBS-TBN. Vortex. This is 1.66x the original volume (500 µL) to give a theoretical count of 7.5 x 106 beads/mL.\nFully label and store the newly coupled beads in the fridge."
  },
  {
    "objectID": "Coupling_Confirmation.html#overview",
    "href": "Coupling_Confirmation.html#overview",
    "title": "6  Coupling Confirmation",
    "section": "6.1 Overview",
    "text": "6.1 Overview\nThis protocol can be used to confirm that antibodies have been correctly conjugated to beads. It works by using anti-species antibodies. Anti mouse-biotin is diluted in a series and reacted with the newly coupled beads which are coupled to mouse and rat antibodies."
  },
  {
    "objectID": "Coupling_Confirmation.html#reagents-consumables-equipment",
    "href": "Coupling_Confirmation.html#reagents-consumables-equipment",
    "title": "6  Coupling Confirmation",
    "section": "6.2 Reagents, consumables & equipment",
    "text": "6.2 Reagents, consumables & equipment\n\n\n\nItem\nSupplier\nCatalogue number\n\n\n\n\nAnti mouse-biotin antibody\nBio-techne\nBAF018\n\n\nPhosphate buffered saline (PBST)\nSee buffers & reagents section\n\n\n\nPBS-TBN\nSee buffers & reagents section\n\n\n\nStreptavidin-R-Phycoerythrin (SA-PE, 1 mg/mL)\nThermo\nS806\n\n\nAntibody-coupled beads\nSee bead coupling section\n\n\n\nProtein low-bind microtubes 1.5 or 2 mL\n\n\n\n\nBlack 96-well plate\nBio-Rad\n\n\n\nPipettes and tips for 1-200 µL\n\n\n\n\n0.2 um syringe filters\n\n\n\n\nSyringe, 50 mL\n\n\n\n\nSterile 50 mL tube\n\n\n\n\nMagPix machine\nLuminex"
  },
  {
    "objectID": "Coupling_Confirmation.html#protocol",
    "href": "Coupling_Confirmation.html#protocol",
    "title": "6  Coupling Confirmation",
    "section": "6.3 Protocol",
    "text": "6.3 Protocol\n⌚ Timing: about 3 hours.\n\nOn first use of the anti mouse-biotin, rehydrate it to be 0.2 mg/mL and aliquot into small volumes for freezer storage to minimise freeze-thaw cycles.\nThaw an aliquot of anti mouse-biotin, 3 µL is required for running two columns on a plate.\nAdd 900 µL of PBS-TBN to a tube for diluting the beads.\nGet the newly coupled beads, vortex then sonicate each for 20 s.\nAdd 2 µL of each bead to the 0.5 mL. (To give a theoretical 20,000 beads/mL, or 1000 beads/well, assuming 5x106 stock).\nVortex the diluted beads.\nLabel 7 tubes (1-7) for the anti mouse-biotin dilutions, corresponding to concentrations: 2, 1, 0.5, 0.25, 0.125, 0.063, 0.031 µg/mL.\nSerially dilute anti mouse-biotin in PBS-TBN by adding 3 µL of the 0.2 mg/mL stock into 297 µL PBS-TBN and transferring 150 µL of this into 150 µL PBS-TBN sequentially until tube 7, vortex mixing between pipetting\n\n\n\n\nDilution series of anti mouse biotin. From 181207 Excel doc- update quality\n\n\n\nDispense 50 µL/well of beads to two columns of a black plate as per plate layout. 10. Add 50 µL/well of the anti mouse-biotin dilutions (1-7) in duplicate, and 50 µL PBS-TBN as the blank, as per plate layout:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n01\n02\n03\n04\n05\n06\n07\n08\n09\n10\n11\n12\n\n\n\n\nA\n2.00 µg/mL\n2.00 µg/mL\n\n\n\n\n\n\n\n\n\n\n\n\nB\n1.00 µg/mL\n1.00 µg/mL\n\n\n\n\n\n\n\n\n\n\n\n\nC\n0.50 µg/mL\n0.50 µg/mL\n\n\n\n\n\n\n\n\n\n\n\n\nD\n0.25 µg/mL\n0.25 µg/mL\n\n\n\n\n\n\n\n\n\n\n\n\nE\n0.125 µg/mL\n0.125 µg/mL\n\n\n\n\n\n\n\n\n\n\n\n\nF\n0.063 µg/mL\n0.063 µg/mL\n\n\n\n\n\n\n\n\n\n\n\n\nG\n0.031 µg/mL\n0.031 µg/mL\n\n\n\n\n\n\n\n\n\n\n\n\nH\n0.00 µg/mL\n0.00 µg/mL\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCover and incubate on shaker for 45 mins at ambient temperature.\nDuring the incubation, dilute SA-PE to 3 µg/mL by adding 2.7 µL of SA-PE to 900 µL PBS-TBN. Store this in the fridge until use.\nPut plate on magnet, wait 60 s, wash plate 3 times with 100 µL/well PBST, removing from the magnet when adding wash buffer.\nAdd 50 µL/well of diluted SA-PE to the plate.\nCover & incubate on shaker for 45 mins.\nWash plate 3 times as before with 100 µL/well PBST.\nAdd 100 µL PBS-TBN to each well and read on MagPix the same day using the 12-plex protocol."
  },
  {
    "objectID": "Coupling_Confirmation.html#analysis-interpretation-of-results",
    "href": "Coupling_Confirmation.html#analysis-interpretation-of-results",
    "title": "6  Coupling Confirmation",
    "section": "6.4 Analysis & interpretation of results",
    "text": "6.4 Analysis & interpretation of results\nWe performed a series of coupling confirmations. The MagPix output file is provided in data/coupling_confirmation/Bead_Coupling_Data.csv\nFor this analysis, we use only the median fluorescence data and only need to include the rows of the mfi data which relate to the experiments where a biotinylated, anti-mouse antibody was directed against the assay specific, mouse-Ab conjugated microbeads.\nThe basic steps include\n\nLoading the csv file, renaming problematic columns\nRemoving headers from the MagPix output file\nFiltering the data to include only mfi data\nFiltering the mfi data to include only the relevant lines of data\nPivoting the data in to a tidy format\nCharting the data\n\n\nlibrary(tidyverse)\n# read data in to df\ndf&lt;-read_csv(\"data/coupling_confirmation/Bead_Coupling_Data.csv\",skip = 41,na = c(\"\",\"NA\",\"NaN\"))%&gt;%\n                setNames(tolower(gsub(\"-\",\"_\",names(.)))) %&gt;%\n                mutate(sample= fct_explicit_na(sample)) %&gt;%\n                select_if(!names(.) %in% c('...16','...17', 'location', 'total events')) %&gt;%\n                rename_at(vars(matches(\"^CH3L1$\")), function(x) \"CHI3L1\")\n\n#remove extraneous lines and keep only mfi data for anti-mouse biotinylated detection antibodies.\ndf &lt;- df[49:64,]\n\n#pivot data\ndf &lt;- df %&gt;% pivot_longer(cols=(-sample),names_to = \"marker\",values_to = \"mfi\") %&gt;% \n  separate(col = sample,into = c(\"sample\",\"dilution\"),sep = \"biotin \") %&gt;% \n  mutate(dilution = as.numeric(dilution))\n\nggplot(df,aes(as.numeric(dilution),as.numeric(mfi)))+\n  geom_smooth()+\n  geom_point()+\n  facet_wrap(.~marker,scales = \"free\")+\n  xlab(\"Dilution Series\")+\n  ylab(\"mfi\")+\n  ggtitle(\"Absolute mfi [free y axis] of antibody conjugated microbeads\")\n\n\n\n\nThe chart above confirms that these microbeads (a) have sucessfully conjugated to the assay specific mouse antibodies and (b) that the mfi response varies in response to serial dilution of the biotinylated anti-mouse secondary antibody. The latter point indicates that in an experimental setting, all of these markers will exhibit variance when challeneged with analytes at different activities.\n\nggplot(df,aes(as.numeric(dilution),as.numeric(mfi)))+\n  geom_smooth()+\n  geom_point()+\n  facet_wrap(.~marker,scales = \"fixed\")+\n  xlab(\"Dilution Series\")+\n  ylab(\"mfi\")+\n  ggtitle(\"Absolute mfi [fixed y axis] of antibody conjugated microbeads\")\n\n\n\n\nWhen charted on a fixed y axis, it becomes clearer that some markers (i.e. CH13L1 and MxA) have a much lower mfi across the full range of dilutions. This could be explained by lower avidity or affinity between the primary and secondary antibodies, or by steric effects, or by experimental issues and faiure to conjugate efficiently.\nNote that whilst both MxA and CHI3L1 both had lower mfi vallues than other markers, they still exhibited a dose-response curve that seems appropriate for experimental use. The visualisation on the free y axes is the most useful, but the visualisation on the fixed axes is our first indication that normalisation processes might be needed in some downstream analyses. For assays such as MxA and CHI3L1 which both had low dose:response ratios are potentially usable, but the results may not accurately reflect variance in clinical specimens due to the low resolving power of such markers.\nWe would reject a bead-set where there was either (a) no, or extremely low fluorescence response or (b) no dose-response.\nAssay performance is likely to be linked to the shape and magnitude of these curves. An ideal curve would have (a) a relatively straight shape [see IP10], indicating that at the extremes there is neither saturation (top) nor a lack of sensitivity (bottom), and (b) a wide range of absolute response values across the dose-response curve [see IL-8, which covers values between 28 and 35,000 (4 log); compared to CHI3L1 which covers values between 23 and 253 (1 log)]\nAntibodies which perform poorly on the beads during these experiments should be substituted for alternatives."
  },
  {
    "objectID": "Detection_Antibody_Prep.html#detection-antibodies",
    "href": "Detection_Antibody_Prep.html#detection-antibodies",
    "title": "7  Detection Antibody Prep",
    "section": "7.1 Detection Antibodies",
    "text": "7.1 Detection Antibodies\n\n\n\n\n\n\n\n\n\n\n\n\nManufacturer\nPart No.\nQuantity\nPRODUCT DESCRIPTION\nComponent\n\n\n\n\nbio-techne\nAF2200\nNA\nHuman Azurocidin/CAP37/HBP Affinity Purified Polyclonal Ab\nDetection\n\n\nbio-techne\nAF7946\nNA\nHuman MxA/Mx1 Affinity Purified Polyclonal Ab\nDetection\n\n\nbio-techne\nBAF1278\nNA\nHuman TREM-1 Biotinylated Affinity Purified PAb\nDetection\n\n\nbio-techne\nBAF206\nNA\nHuman/Primate IL-6 Biotinylated Affinity Purified PAb\nDetection\n\n\nbio-techne\nBAF208\nNA\nHuman IL-8/CXCL8 Biotinylated Affinity Purified PAb\nDetection\n\n\nbio-techne\nBAF217\nNA\nHuman IL-10 Biotinylated Affinity Purified PAb\nDetection\n\n\nbio-techne\nBAF225\nNA\nHuman TNF RI/TNFRSF1A Biotinylated Affinity Purified PAb\nDetection\n\n\nbio-techne\nBAF2599\nNA\nHuman/Primate Chitinase 3-like 1 Biotinylated Aff Pur PAb\nDetection\n\n\nbio-techne\nBAF266\nNA\nHuman CXCL10/IP-10 Biotinylated Affinity Purified PAb\nDetection\n\n\nbio-techne\nBAF375\nNA\nHuman/Primate TRAIL/TNFSF10 Biotinylated Aff Pur PAb\nDetection\n\n\nbio-techne\nBAF623\nNA\nHuman Angiopoietin-2 Biotinylated Affinity Purified PAb\nDetection\n\n\nbio-techne\nBAF923\nNA\nHuman Angiopoietin-1 Biotinylated Affinity Purified PAb\nDetection"
  },
  {
    "objectID": "Detection_Antibody_Prep.html#reagents-and-materials-needed.",
    "href": "Detection_Antibody_Prep.html#reagents-and-materials-needed.",
    "title": "7  Detection Antibody Prep",
    "section": "7.2 Reagents and materials needed.",
    "text": "7.2 Reagents and materials needed.\n\n\n\nComponent\nSupplier\nCatalogue Number\n\n\n\n\nLightning Link biotin Type A kit\n\n370-0010\n\n\nAnti Azu"
  },
  {
    "objectID": "Detection_Antibody_Prep.html#protocol",
    "href": "Detection_Antibody_Prep.html#protocol",
    "title": "7  Detection Antibody Prep",
    "section": "7.3 Protocol",
    "text": "7.3 Protocol\n1. From LL-biotin kits, thaw LL-Modifier and LL-Quencher reagents and retrieve as many biotin vials as needed, one for each antibody to be conjugated.\n2. Label the LL glass vials with ‘Azu or MxA, date, 0.833 µg/mL’.\n3. Vortex and briefly spin down the LL-Modifier and LL-Quencher tubes.\n4. Rehydrate Anti Azu (AF2200) and Anti MxA (AF7946) each with 100 µL of filter sterilized PBS to give 1 mg/mL.\n5. Add 10 µL of LL-Modifier from the LL kit to each of the antibody aliquots and mix by pipetting up and down gently.\n6. Transfer all 110 µL to the respective glass vial and ensure that the lyophilised biotin is rehydrated by gently pipetting up and down once or twice.\n7. Incubate at least 15 mins at room temp. Can be left even overnight if needed.\n8. Add 10 µL of LL-Quencher to each glass vial and pipette gently to mix.\n9. Leave for 5 mins before use.\n10. Store the biotinylated antibodies in the fridge. Expiry is 18 months from conjugation date."
  },
  {
    "objectID": "antigens.html",
    "href": "antigens.html",
    "title": "8  Antigens",
    "section": "",
    "text": "The following list of purified antigens were used in cross-reactivity tests to establish which pairs of antibodies were specific and avid for binding to the target analytes. Purified antigens were also used as standards.\n\n\n\nBuy these things\n\n\n\n\n\n\n\n\nManufacturer\nPart No.\nQuantity\nPRODUCT DESCRIPTION\n\n\n\n\nbio-techne\n2599-CH-050\n50 µg\nRecombinant Human Chitinase 3-like 1 Protein\n\n\nbio-techne\n375-TL-010\n10 µg\nRecombinant Human TRAIL/TNFSF10 Protein\n\n\nbio-techne\n623-AN-025\n25 µg\nRecombinant Human Angiopoietin-2 Protein\n\n\nbio-techne\n636-R1-025\n25 µg\nRecombinant Human sTNF RI/TNFRSF1A Protein\n\n\nbio-techne\n923-AN-025\n25 µg\nRecombinant Human Angiopoietin-1 Protein\n\n\nbio-techne\n1064-IL-010\n10 µg\nRecombinant Human IL-10 (aa 19-178) Protein\n\n\nbio-techne\n1278-TR-050\n50 µg\nRecombinant Human TREM-1 Fc Chimera Protein\n\n\nbio-techne\n206-IL-010\n10 µg\nRecombinant Human IL-6 Protein\n\n\nbio-techne\n208-IL-010\n10 µg\nRecombinant Human IL-8/CXCL8 Protein\n\n\nbio-techne\n2200-SE-050\n50 µg\nRecombinant Human Azurocidin/CAP37/HBP Protein\n\n\nbio-techne\n266-IP-010\n10 µg\nRecombinant Human CXCL10/IP-10 Protein\n\n\nInsight Biotechnology\nTP307418\n20 µg\nMxA\n\n\n\n\n\nNOTE : Expiry dates are three months from re-hydration, according to the manufacturer."
  },
  {
    "objectID": "antibody_pairs.html#overview",
    "href": "antibody_pairs.html#overview",
    "title": "9  Screening antibody pairs",
    "section": "9.1 Overview",
    "text": "9.1 Overview\nThe following tables provide information on how capture and detection antibodies are paired in the assay. A relatively large number of pairs were tested and we continued to screen pairs until we identified a pair for each marker which met the following quality criteria.\nThe full list of antibodies screened and selected is provided here\n\nADD CRITERIA HERE\nAND HERE"
  },
  {
    "objectID": "antibody_pairs.html#screening-protocol",
    "href": "antibody_pairs.html#screening-protocol",
    "title": "9  Screening antibody pairs",
    "section": "9.2 Screening protocol",
    "text": "9.2 Screening protocol"
  },
  {
    "objectID": "antibody_pairs.html#example-data-analysis",
    "href": "antibody_pairs.html#example-data-analysis",
    "title": "9  Screening antibody pairs",
    "section": "9.3 Example data & analysis",
    "text": "9.3 Example data & analysis\nProvide one good example and one bad example"
  },
  {
    "objectID": "antibody_pairs.html#antibody-pairs-selected-for-the-final-assay",
    "href": "antibody_pairs.html#antibody-pairs-selected-for-the-final-assay",
    "title": "9  Screening antibody pairs",
    "section": "9.4 Antibody pairs selected for the final assay",
    "text": "9.4 Antibody pairs selected for the final assay\nADD SOME METRICS FOR THE QC\n\n\n\n\n\n\n\n\n\n\n\nMarker\nCapture Antibody\nDetection Antibody\nMetric 1\nMetric 2\nMetric 3\n\n\n\n\nAng-1\nMAB9231\nBAF923\n\n\n\n\n\nAng-2\nMAB098\nBAM0981\n\n\n\n\n\nAzu\nMAB2200\nAF2200\n\n\n\n\n\nCHI3L1\nMAB25991\nBAF2599\n\n\n\n\n\nCRP\nMAB17071\nBAM17072\n\n\n\n\n\nIL-6\nMAB206\nBAF206\n\n\n\n\n\nIL-8\nMAB208-SP\nBAF208\n\n\n\n\n\nIL-10\nMAB2172\nBAF217\n\n\n\n\n\nIP-10\nMAB266\nBAF266\n\n\n\n\n\nMxA\nAF7946\nAF7946\n\n\n\n\n\nsTNFR-1\nMAB625\nBAF225\n\n\n\n\n\nsTREM-1\nAF1278\nBAF1278\n\n\n\n\n\nTRAIL\nMAB3751\nBAF375"
  },
  {
    "objectID": "antibody_pairs.html#antibody-pairs-rejected-by-screening-process",
    "href": "antibody_pairs.html#antibody-pairs-rejected-by-screening-process",
    "title": "9  Screening antibody pairs",
    "section": "9.5 Antibody pairs rejected by screening process",
    "text": "9.5 Antibody pairs rejected by screening process\nADD SOME METRICS FOR THE QC\n\n\n\n\n\n\n\n\n\n\n\nMarker\nCapture Antibody\nDetection Antibody\nMetric 1\nMetric 2\nMetric 3\n\n\n\n\nAzu\nNBP2-12045\nAF2200\n\n\n\n\n\nCRP\nMAB17071\nBAM17072\n\n\n\n\n\nMxA\nMA5-24914\nAF7946\n\n\n\n\n\nPCT\nMAB83501\nMAB8350\n\n\n\n\n\nPCT\nMAB83502\nMAB83502\n\n\n\n\n\nPCT\nAF8350\nAF8350\n\n\n\n\n\nsFlT-1\nMAB321\nBAF321\n\n\n\n\n\nsFlT-1\nNBP2-34619\nBAF321\n\n\n\n\n\nsFlT-1\nAF321\nBAF321\n\n\n\n\n\nsTREM-1\nMAB1278-SP\nBAF1278\n\n\n\n\n\nsTREM-1\nH00054210-M04\nBAF1278"
  },
  {
    "objectID": "Cross_Reactivity.html#intro",
    "href": "Cross_Reactivity.html#intro",
    "title": "10  Cross-reactivity Testing",
    "section": "10.1 Intro",
    "text": "10.1 Intro\nCross-reactivity would occur if an analyte triggered a measurable response in an assay other than that which was intended, for instance if an assay based on detection antibodies intended to be specific for MxA were reactive to purified sTNFR1 antigen. Cross-reactive antibody pairs cannot be trusted to provide specific and accurate estimates of analyte activity.\nTo establish whether any assays were cross-reactive, we tested each assay against a standard curve of purified antigens for both its target analyte (which should be reactive) and all other analytes. Note that this approach cannot rule out assay cross-reactivity to analytes in the blood that were not directly tested here.\nThe data presented here include 13 antigens, including those on the list of markers, plus C-Reactive Protein (CRP) [ADD DETAILS OF THE CRP ANTIGEN], which was part of our initial screening process."
  },
  {
    "objectID": "Cross_Reactivity.html#protocol",
    "href": "Cross_Reactivity.html#protocol",
    "title": "10  Cross-reactivity Testing",
    "section": "10.2 Protocol",
    "text": "10.2 Protocol\nThe protocol is initiated by making 13X stocks of the pure recombinant protein standards. Individual antigens were then diluted to 1X for use in the assays. Equal volumes of the 13 analytes were then mixed to achieve a multi-analyte pool in which each of the 13 analytes had 1X activity. A heterogeneous in buffer while the others become 1X by combining them together in I.e. 12 equal volumes of 12X to become 1X each.\nALL TO BE UPDATED- I NEED TO RE-DO THE 12-PLEX DILUTION SERIES WITH SIMPLER CALCS.\n\nGet coupled beads from fridge, bring to RT, vortex and sonicate 30 sec of each.\nPut aliquots of the reference aliquots in the fridge to thaw\n\n\n10.2.1 Prepare reference analytes and pools of analytes\n\nPrepare analyte dilutions in PBS-TBN at 13X the final required concentration\nFor the multiplex standards, combine equal volumes of each of the 13X analyte stocks. Prepare sufficient volumes to fill seven 5 mL tubes\nIn another set of 7 x 13 tubes (or a low-bind 96-well plate), make a serial dilution of the analytes, where each step is a further 1 in 13 dilution. This can be achieved by mixing 23 ul of the antecedent dilution with 299 ul PBS-TBN\n\n\n\n\nPlate 1\n13-plex\nCHI3L1\nIL-8\nsTNFR1\nIL-6\nAng-2\n\n\n\n\nColumns\n01-02\n03-04\n05-06\n07-08\n09-10\n11-12\n\n\nRow A\n\n\n\n\n\n\n\n\nRow B\n\n\n\n\n\n\n\n\nRow C\n\n\n\n\n\n\n\n\nRow D\n\n\n\n\n\n\n\n\nRow E\n\n\n\n\n\n\n\n\nRow F\n\n\n\n\n\n\n\n\nRow G\n\n\n\n\n\n\n\n\nRow H\n\n\n\n\n\n\n\n\n\n\n\n\nPlate 2\nAng-1\nAzu\nMxA\nTRAIL\nIL-10\nIP-10\n\n\n\n\nColumns\n01-02\n03-04\n05-06\n07-08\n09-10\n11-12\n\n\nRow A\n\n\n\n\n\n\n\n\nRow B\n\n\n\n\n\n\n\n\nRow C\n\n\n\n\n\n\n\n\nRow D\n\n\n\n\n\n\n\n\nRow E\n\n\n\n\n\n\n\n\nRow F\n\n\n\n\n\n\n\n\nRow G\n\n\n\n\n\n\n\n\nRow H\n\n\n\n\n\n\n\n\n\n\n\n\nPlate 3\nsTREM1\nEMPTY\nEMPTY\nEMPTY\nEMPTY\nEMPTY\n\n\n\n\nColumns\n01-02\n03-04\n05-06\n07-08\n09-10\n11-12\n\n\nRow A\n\n\n\n\n\n\n\n\nRow B\n\n\n\n\n\n\n\n\nRow C\n\n\n\n\n\n\n\n\nRow D\n\n\n\n\n\n\n\n\nRow E\n\n\n\n\n\n\n\n\nRow F\n\n\n\n\n\n\n\n\nRow G\n\n\n\n\n\n\n\n\nRow H\n\n\n\n\n\n\n\n\n\n\n\n10.2.2 Prepare beads\n\nBeads for plates 1,2,3 (13-plex without PCT): add 12.840 ml of PBS-TBN to universal. Total final volume after addition of beads, will be 13.6 ml. (allowing excess 0.8 ml. 256 wells) 54.4*14 = 761.6 ul.\nVortex bead stocks again. To get 20k beads/ml [ie 1000 beads/well] based on stock of 5x106 beads/ml.\nAdd 54.4 ul of each bead to universal (except where indicated as 80% or 120%, based on cup conf bead counts).\nGet black plates and label with date etc.\nAdd 50 ul of diluted beads to all 96 wells of 2 plates, plus columns 01 and 02 of a third plate.\n\nNOTE: All 13 antibody-conjugated beads and all 13 SA-PE conjugated detection antibodies are present in all assays."
  },
  {
    "objectID": "Cross_Reactivity.html#results-analysis",
    "href": "Cross_Reactivity.html#results-analysis",
    "title": "10  Cross-reactivity Testing",
    "section": "10.3 Results & Analysis",
    "text": "10.3 Results & Analysis\nThe raw data are in long format in the file data/crossreactivity_data/crossreactivity_data_long.csv\nEach line represents a well of the Luminex plate in which there was…\n\nAn analyte at one of 8 activities\nDetection antibodies and associated chemistry for one of the 13 individual assays\n\n\n10.3.1 Load libraries\n\nlibrary(tidyverse)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(plotly)\nlibrary(knitr)\n\n\n\n10.3.2 Read in the data from the crossreactivity experiments.\n\nmfi_allplates = read_csv(\"data/crossreactivity_data/crossreactivity_data_long.csv\")\nkable(head(mfi_allplates,50))\n\n\n\n\nLocation\nanalyte\nmfi\nplate\nassay\nwell\nrow\nrep\nstandard\n\n\n\n\n1(1,A1)\nAng.1\n6665.5\n1\n13plex\n1\nA\n1\n1\n\n\n2(1,B1)\nAng.1\n2104.0\n1\n13plex\n2\nB\n1\n2\n\n\n3(1,C1)\nAng.1\n489.5\n1\n13plex\n3\nC\n1\n3\n\n\n4(1,D1)\nAng.1\n168.0\n1\n13plex\n4\nD\n1\n4\n\n\n5(1,E1)\nAng.1\n83.0\n1\n13plex\n5\nE\n1\n5\n\n\n6(1,F1)\nAng.1\n78.5\n1\n13plex\n6\nF\n1\n6\n\n\n7(1,G1)\nAng.1\n75.0\n1\n13plex\n7\nG\n1\n7\n\n\n8(1,H1)\nAng.1\n71.5\n1\n13plex\n8\nH\n1\n8\n\n\n9(1,A2)\nAng.1\n7102.0\n1\n13plex\n9\nA\n2\n1\n\n\n10(1,B2)\nAng.1\n2283.0\n1\n13plex\n10\nB\n2\n2\n\n\n11(1,C2)\nAng.1\n487.0\n1\n13plex\n11\nC\n2\n3\n\n\n12(1,D2)\nAng.1\n156.5\n1\n13plex\n12\nD\n2\n4\n\n\n13(1,E2)\nAng.1\n87.0\n1\n13plex\n13\nE\n2\n5\n\n\n14(1,F2)\nAng.1\n72.0\n1\n13plex\n14\nF\n2\n6\n\n\n15(1,G2)\nAng.1\n75.0\n1\n13plex\n15\nG\n2\n7\n\n\n16(1,H2)\nAng.1\n68.0\n1\n13plex\n16\nH\n2\n8\n\n\n17(1,A3)\nAng.1\n80.0\n1\nCHI3L1\n17\nA\n1\n1\n\n\n18(1,B3)\nAng.1\n75.0\n1\nCHI3L1\n18\nB\n1\n2\n\n\n19(1,C3)\nAng.1\n71.0\n1\nCHI3L1\n19\nC\n1\n3\n\n\n20(1,D3)\nAng.1\n74.0\n1\nCHI3L1\n20\nD\n1\n4\n\n\n21(1,E3)\nAng.1\n75.0\n1\nCHI3L1\n21\nE\n1\n5\n\n\n22(1,F3)\nAng.1\n70.0\n1\nCHI3L1\n22\nF\n1\n6\n\n\n23(1,G3)\nAng.1\n70.0\n1\nCHI3L1\n23\nG\n1\n7\n\n\n24(1,H3)\nAng.1\n69.0\n1\nCHI3L1\n24\nH\n1\n8\n\n\n25(1,A4)\nAng.1\n74.0\n1\nCHI3L1\n25\nA\n2\n1\n\n\n26(1,B4)\nAng.1\n70.0\n1\nCHI3L1\n26\nB\n2\n2\n\n\n27(1,C4)\nAng.1\n71.5\n1\nCHI3L1\n27\nC\n2\n3\n\n\n28(1,D4)\nAng.1\n68.0\n1\nCHI3L1\n28\nD\n2\n4\n\n\n29(1,E4)\nAng.1\n69.0\n1\nCHI3L1\n29\nE\n2\n5\n\n\n30(1,F4)\nAng.1\n78.5\n1\nCHI3L1\n30\nF\n2\n6\n\n\n31(1,G4)\nAng.1\n70.0\n1\nCHI3L1\n31\nG\n2\n7\n\n\n32(1,H4)\nAng.1\n72.0\n1\nCHI3L1\n32\nH\n2\n8\n\n\n33(1,A5)\nAng.1\n69.0\n1\nIL.8\n33\nA\n1\n1\n\n\n34(1,B5)\nAng.1\n65.0\n1\nIL.8\n34\nB\n1\n2\n\n\n35(1,C5)\nAng.1\n64.0\n1\nIL.8\n35\nC\n1\n3\n\n\n36(1,D5)\nAng.1\n66.0\n1\nIL.8\n36\nD\n1\n4\n\n\n37(1,E5)\nAng.1\n66.5\n1\nIL.8\n37\nE\n1\n5\n\n\n38(1,F5)\nAng.1\n65.0\n1\nIL.8\n38\nF\n1\n6\n\n\n39(1,G5)\nAng.1\n63.5\n1\nIL.8\n39\nG\n1\n7\n\n\n40(1,H5)\nAng.1\n76.0\n1\nIL.8\n40\nH\n1\n8\n\n\n41(1,A6)\nAng.1\n61.0\n1\nIL.8\n41\nA\n2\n1\n\n\n42(1,B6)\nAng.1\n75.0\n1\nIL.8\n42\nB\n2\n2\n\n\n43(1,C6)\nAng.1\n71.0\n1\nIL.8\n43\nC\n2\n3\n\n\n44(1,D6)\nAng.1\n70.0\n1\nIL.8\n44\nD\n2\n4\n\n\n45(1,E6)\nAng.1\n66.0\n1\nIL.8\n45\nE\n2\n5\n\n\n46(1,F6)\nAng.1\n71.0\n1\nIL.8\n46\nF\n2\n6\n\n\n47(1,G6)\nAng.1\n77.0\n1\nIL.8\n47\nG\n2\n7\n\n\n48(1,H6)\nAng.1\n70.0\n1\nIL.8\n48\nH\n2\n8\n\n\n49(1,A7)\nAng.1\n69.0\n1\nsTNFR.1\n49\nA\n1\n1\n\n\n50(1,B7)\nAng.1\n68.0\n1\nsTNFR.1\n50\nB\n1\n2\n\n\n\n\n\n\n\n10.3.3 Create counterfactuals and bind to data\nThe counterfactuals are used in the charts below to show the response curves when the assay is tested against its own analyte. These are shown as grey bars in the charts.\n\ncounterfactuals = filter(mfi_allplates,assay==analyte) %&gt;% \n  select(\n    assay,\n    standard,\n    rep,\n    mfi\n  ) %&gt;% \n  rename(mfi.cf = mfi)\n\nmfi_allplates &lt;- left_join(mfi_allplates,counterfactuals)\n\n\n\n10.3.4 Show results for individual analytes against all assays\nEach experiment was repeated and charts below show the results of experiments 1 & 2.\nDefine a function to plot each analyte.\n\nassay.plot&lt;-function(showanalyte){\nggplot(filter(mfi_allplates,analyte==showanalyte,assay!=\"13plex\"))+\n  geom_bar(stat = \"identity\",aes(standard,mfi.cf),fill=\"grey\",alpha=0.5)+\n  geom_bar(stat = \"identity\",aes(standard,mfi),fill=\"black\")+\n  \n  facet_grid(analyte~assay) +\n  xlab(\"Assay & Standard being tested\") +\n  ylab(\"Analyte Response (MFI)\")\n}\n\n\n10.3.4.1 Ang-1\n\nassay.plot(showanalyte = \"Ang.1\")\n\n\n\n\n\n\n10.3.4.2 Ang-2\n\nassay.plot(showanalyte = \"Ang.2\")\n\n\n\n\n\n\n10.3.4.3 Azu\n\nassay.plot(showanalyte = \"Azu\")\n\n\n\n\n\n\n10.3.4.4 CHI3L1\n\nassay.plot(showanalyte = \"CHI3L1\")\n\n\n\n\n\n\n10.3.4.5 CRP\n\nassay.plot(showanalyte = \"CRP\")\n\n\n\n\n\n\n10.3.4.6 IL-10\n\nassay.plot(showanalyte = \"IL.10\")\n\n\n\n\n\n\n10.3.4.7 IL-6\n\nassay.plot(showanalyte = \"IL.6\")\n\n\n\n\n\n\n10.3.4.8 IL-8\n\nassay.plot(showanalyte = \"IL.8\")\n\n\n\n\n\n\n10.3.4.9 IP-10\n\nassay.plot(showanalyte = \"IP.10\")\n\n\n\n\n\n\n10.3.4.10 MxA\n\nassay.plot(showanalyte = \"MxA\")\n\n\n\n\n\n\n10.3.4.11 sTNF-R1\n\nassay.plot(showanalyte = \"sTNFR.1\")\n\n\n\n\n\n\n10.3.4.12 sTREM-1\n\nassay.plot(showanalyte = \"sTREM.1\")\n\n\n\n\n\n\n10.3.4.13 TRAIL\n\nassay.plot(showanalyte = \"TRAIL\")\n\n\n\n\n\n\n10.3.4.14 Show 13 plex results\n\nggplot(filter(mfi_allplates,assay!=\"13plex\"))+\n  geom_bar(stat = \"identity\",aes(standard,mfi.cf),fill=\"grey\",alpha=0.5)+\n  geom_bar(stat = \"identity\",aes(standard,mfi),fill=\"black\")+\n  \n  facet_grid(analyte~assay) +\n  xlab(\"Assay & Standard being tested\") +\n  ylab(\"Analyte Response (MFI)\")"
  },
  {
    "objectID": "Standards_Prep.html#overview",
    "href": "Standards_Prep.html#overview",
    "title": "11  Standard curves",
    "section": "11.1 Overview",
    "text": "11.1 Overview\nThis protocol will support you to create a set of standard curves against which experimental fluorescence measurements from clinical specimens will be calibrated, normalised, and converted in to analyte concentration estimates. The standards are made as a multiplexed pool of the cognate recombinant antigens for the various bead-conjugated sandwich assays (see bead coupling and antibody pairs) in the test. This pool is diluted several times, and the dilution series (along with an antigen free ‘buffer blank’ are included on every plate that is run on the MagPix device. This allows the user to normalise fluorescence signal variation between plates, and to establish a dose-response curve for each antigen on each plate. The dose-response curve is later used to convert the fluorescence signals from the multiplexed testing of clinical specimens in to estimates of the concentration/activity of each analyte (see Analysis).\nASK TEGWEN - Is the stock concentration fixed? As in, will the stock of MxA always be 2.2e-4"
  },
  {
    "objectID": "Standards_Prep.html#protocol",
    "href": "Standards_Prep.html#protocol",
    "title": "11  Standard curves",
    "section": "11.2 Protocol",
    "text": "11.2 Protocol\n\nTo determine the stock concentrations do this…???\nYou will aim to create a multiplexed top-standard by mixing volumes of the recombinant antigen stocks together and then making up the residual volume with PBS-TBN buffer. A worked example is provided below.\n\n\n11.2.1 Calculations\n\ntarget_volume_ml is the total volume (mL) of standards to be created\nStock_g_ml is a list of the activites (g/mL) of the stock antigens\nTarget_g_ml is a list of the desired activities (g/mL) of the antigens in the multiplexed top-standard\ndilution_factor is a list of the factors required to dilute each antigen to the Target_g_ml activity. It is calculated as \\[dilution\\_factor = \\frac{Stock\\_g\\_ml}{Target\\_g\\_ml}\\]\nvolume_stock_ml is a list of the volumes of each stock antigen solution which will contribute to the target_volume_ml. It is calculated as \\[volume\\_stock\\_ml = \\frac{target\\_volume\\_ml}{dilution\\_factor}\\]\n\n\n### Composition of top standard from docx\n\n\nformulation_standards = \n  tibble(\n  Assay = c(\"IL-8\",\"IL-10\",\"sTREM1\",\"Ang-2\",\"Ang-1\",\"sTNFR1\",\"IL-6\",\"TRAIL\",\"AZU\",\"MXA\",\"IP10\",\"CHI3L1\"),\n  \n  Stock_g_ml = c(100e-6,100e-6,100e-6,100e-6,100e-6,25e-6,100e-6,100e-6,200e-6,220e-6,100e-6,200e-6),\n  \n  Target_g_ml = c(2.5e-9,4e-9,10e-9,100e-9,50e-9,2.5e-9,10e-9,10e-9,200e-9,300e-9,10e-9,100e-9),\n  \n  dilution_factor = Stock_g_ml/Target_g_ml,\n  \n  target_volume_ml = 1,\n  \n  volume_stock_ml = format(target_volume_ml/dilution_factor,scientific=T,digits=3)\n        ) %&gt;% \n  \n  \n  mutate(dilution_factor = format(dilution_factor,scientific=F,digits=1))\n\n\nkable(select(formulation_standards,-target_volume_ml),digits=10)\n\n\n\n\nAssay\nStock_g_ml\nTarget_g_ml\ndilution_factor\nvolume_stock_ml\n\n\n\n\nIL-8\n1.0e-04\n2.5e-09\n40000\n2.50e-05\n\n\nIL-10\n1.0e-04\n4.0e-09\n25000\n4.00e-05\n\n\nsTREM1\n1.0e-04\n1.0e-08\n10000\n1.00e-04\n\n\nAng-2\n1.0e-04\n1.0e-07\n1000\n1.00e-03\n\n\nAng-1\n1.0e-04\n5.0e-08\n2000\n5.00e-04\n\n\nsTNFR1\n2.5e-05\n2.5e-09\n10000\n1.00e-04\n\n\nIL-6\n1.0e-04\n1.0e-08\n10000\n1.00e-04\n\n\nTRAIL\n1.0e-04\n1.0e-08\n10000\n1.00e-04\n\n\nAZU\n2.0e-04\n2.0e-07\n1000\n1.00e-03\n\n\nMXA\n2.2e-04\n3.0e-07\n733\n1.36e-03\n\n\nIP10\n1.0e-04\n1.0e-08\n10000\n1.00e-04\n\n\nCHI3L1\n2.0e-04\n1.0e-07\n2000\n5.00e-04\n\n\n\n\n\nAfter mixing the appropriate volumes (volume_stock_ml) of antigen stocks together in a single tube, the remaining volume of the target_volume_ml is made up with PBS-TBN buffer (see buffers & reagents).\nThe required volume (mL) of PBS-TBN `volume_is calculated as \\[volume\\_PBS\\_TBN = target\\_volume\\_ml - (\\sum_{i=1}^{n} volume\\_stock\\_ml_i)\\]\n\nvolume_PBS_TBN = formulation_standards$target_volume_ml[1]-sum(as.numeric(formulation_standards$volume_stock_ml),na.rm=T)\n\nmessage(str_c(format(volume_PBS_TBN,scientific = T), \" mL\"))\n\n9.95075e-01 mL\n\n\nThe final step is to carry out a serial dilution of the top-standard, using 1:4 v/v dilutions in PBS-TBN buffer. We used six serial dilutions (creating seven standards including the top-standard) and an 8th “buffer blank” specimen which contained only PBS-TBN buffer (no antigen). During analysis the buffer blank specimen was used to calculate background fluorescence."
  },
  {
    "objectID": "Standards_Prep.html#recommendations",
    "href": "Standards_Prep.html#recommendations",
    "title": "11  Standard curves",
    "section": "11.3 Recommendations",
    "text": "11.3 Recommendations\n\nLabel all vials with with expiry date (as per data sheet, but rule of thumb 3 months)\nTest new standards side-by-side with older formulations, to assess conformity and uniformity\nAliquot standard curves in single-plate volumes (70 µL) and store at -70° C\nDefrosted aliquots should be used within 24 hours and should be stored at 4° C\nMake substantial volumes for homogeneity. Ideally you should synthesise enough standards for all of your test plates using a single batch of standards. If you have 100 plates to run, you will need 100 * 70 µL = 7 mL. You should make at least 20% extra to account for liquid handling errors and the need to occasionally repeat runs.\nStandards degrade with time. You should aim to process all of your plates in the shortest time-frame possible."
  },
  {
    "objectID": "Magpix_Protocol.html#overview",
    "href": "Magpix_Protocol.html#overview",
    "title": "12  MagPix Protocol",
    "section": "12.1 Overview",
    "text": "12.1 Overview\nThis protocol will support you to set up a run on the xPONENT software. This protocol is used to test specimens with the final 12-plex assay on the MagPix machine, as well as to carry out the confirmations of bead conjugation and the cross-reactivity tests,\nPlease note that this protocol does not detail basic operations, routine maintenance and calibration of the MagPix. Please refer to the manufacturer’s guidance on this."
  },
  {
    "objectID": "Magpix_Protocol.html#setup",
    "href": "Magpix_Protocol.html#setup",
    "title": "12  MagPix Protocol",
    "section": "12.2 Setup",
    "text": "12.2 Setup\n\nIn the xPONENT software, go to ‘Protocols’ &gt; ‘Create new Protocol’.\nEnter a name for the protocol e.g. “12-plex Biomarker” and select the plate type [TM1] from the drop-down menu.\nSet the sample volume to 50uL. Click ‘Next’.\nSelect and label the required bead regions with their coupled antibodies so that the table on screen looks maps to the table below (double-check that the regions are in this order before labelling [TM2] them):\n\n\n\n\nName\nAnalysis\nUnits\nCount\nRegion\n\n\n\n\nsTREM1\nNo Analysis\n\n50\n14\n\n\nAng2\nNo Analysis\n\n50\n15\n\n\nAng1\nNo Analysis\n\n50\n18\n\n\nsTNFR1\nNo Analysis\n\n50\n20\n\n\nIL6\nNo Analysis\n\n50\n21\n\n\nIL8\nNo Analysis\n\n50\n22\n\n\nTRAIL\nNo Analysis\n\n50\n25\n\n\nIL10\nNo Analysis\n\n50\n26\n\n\nAzu\nNo Analysis\n\n50\n27\n\n\nMxA\nNo Analysis\n\n50\n28\n\n\nIP10\nNo Analysis\n\n50\n29\n\n\nCH3L1\nNo Analysis\n\n50\n30\n\n\n\n\nClick ‘Next’"
  },
  {
    "objectID": "Magpix_Protocol.html#plate-layout",
    "href": "Magpix_Protocol.html#plate-layout",
    "title": "12  MagPix Protocol",
    "section": "12.3 Plate Layout",
    "text": "12.3 Plate Layout\n\nHighlight all wells and select 'Unknown' so that the whole plate is yellow.\nEnsure that 'Direction' is the left-hand option for vertical reading order.\nAdd a 'Post-Batch Routine' under 'Commands and Routines'.\nClick 'Save'.\n\nThe protocol is ready to use and can now be found under ‘Protocols’ or ‘Batches’."
  },
  {
    "objectID": "Magpix_Protocol.html#initiating-the-run",
    "href": "Magpix_Protocol.html#initiating-the-run",
    "title": "12  MagPix Protocol",
    "section": "12.4 Initiating the run",
    "text": "12.4 Initiating the run\nAdd details about how to put the plate in and start the run\nCheck what the options are & which one to use. [TM1]\nCheck whether they come up in numeric order or in the order that they are clicked on. [TM2]"
  },
  {
    "objectID": "Magpix_Protocol.html#exporting-the-data-to-csv",
    "href": "Magpix_Protocol.html#exporting-the-data-to-csv",
    "title": "12  MagPix Protocol",
    "section": "12.5 Exporting the data to CSV",
    "text": "12.5 Exporting the data to CSV\nAdd some instructions for export"
  },
  {
    "objectID": "Analysis_01.html",
    "href": "Analysis_01.html",
    "title": "15  Data Analysis - A Tutorial based on the Mos-Def study",
    "section": "",
    "text": "16 Example Analysis 4 : Identifying clusters via Expectation Maximisation\nSometimes you will perform some measures on specimens and will want to identify clusters, or groups of specimens in a way that is driven only by the data. A simple way to do this is to use an expectation maximisation algorithm. The assumption here is that there are two or more normal distributions that overlap, and that those groups reflect some biological or real world characteristic. We often assume that there will be one tall and narrow (the ‘normal’ group) and another low and wide (disease group). This is not always the case, but does reflect the biological reality that biomarker levels are typically low and have low variance when there’s no immune response, but when an immune response happens, expression increases, but with substantial heterogeneity that leads to the wide variance.\nIn this model we run an EM algorithm from the mixtools package. We’ll set a fixed seed for each modelling process, to ensure reproducibility.\nset.seed(12341)\nOD2&lt;-normalmixEM(day0_stnfr1$Estimate.norm.adj)\n\nnumber of iterations= 500\nIt’s a fairly simple process to extract and plot the posterior probability distributions from the model and to chart them. We can also add a vertical line on the 95% centile of the ‘negative’ group. This is controlled by defining how many standard deviations away from the mean the line should be (1.96*OD1$sigma). 1.96 is the 95th centile, but this could be increased for higher specificity or decreased for lower specificity.\nReally this analysis has a lot of analogies with ROC. They are related in lots of ways. Note that here we are making an assumption about normal distributions that may not be true. It also assumes that there’s only two distributions in there.\nggplot(day0_stnfr1, aes(x = Estimate.norm.adj)) +\n  geom_histogram(binwidth = 0.007,color=\"white\",fill=\"grey\") +\n  mapply(\n    function(mean, sd, lambda, n, binwidth) {\n      stat_function(\n        fun = function(x) {\n          (dnorm(x, mean = mean, sd = sd)) * n * binwidth * lambda\n        }\n      )\n    },\n    mean = OD2[[\"mu\"]], #mean\n    sd = OD2[[\"sigma\"]], #standard deviation\n    lambda = OD2[[\"lambda\"]], #amplitude\n    n = length(day0_stnfr1$Estimate.norm.adj), #sample size\n    binwidth = 0.007 #binwidth used for histogram\n  )+\n  geom_vline(xintercept = OD2$mu[1]+(1.96*OD2$sigma[1]),lty=2,lwd=1)\nIf you thought that the data were better described by four distributions, then you could simply change the assumptions of the EM model. You may also need to increase the value of maxit to allow more iterations. More complex models take longer to converge\nset.seed(12341)\nOD3&lt;-normalmixEM(day0_stnfr1$Estimate.norm.adj, k=3,maxit = 5000)\n\nnumber of iterations= 1408\nYou may want to add multiple lines to complex models like this\nggplot(day0_stnfr1, aes(x = Estimate.norm.adj)) +\n  geom_histogram(binwidth = 0.007,color=\"white\",fill=\"grey\") +\n  mapply(\n    function(mean, sd, lambda, n, binwidth) {\n      stat_function(\n        fun = function(x) {\n          (dnorm(x, mean = mean, sd = sd)) * n * binwidth * lambda\n        }\n      )\n    },\n    mean = OD3[[\"mu\"]], #mean\n    sd = OD3[[\"sigma\"]], #standard deviation\n    lambda = OD3[[\"lambda\"]], #amplitude\n    n = length(day0_stnfr1$Estimate.norm.adj), #sample size\n    binwidth = 0.007 #binwidth used for histogram\n  )+\n  geom_vline(xintercept = OD3$mu[1]+(1.96*OD3$sigma[1]),lty=2,lwd=1,col=\"red\")+\n  geom_vline(xintercept = OD3$mu[2]+(1.96*OD3$sigma[2]),lty=2,lwd=1,col=\"blue\")\nAs with most modelling exercises, you may want to compare multiple models to see which describes your data best. Don’t forget that you have some assumptions being used here.\nLet’s test to see if a two, three, four, or five distribution model best describes the data.\nWe’ve already done two and three, so let’s add four\nset.seed(12343)\nOD4&lt;-normalmixEM(day0_stnfr1$Estimate.norm.adj, k=4,maxit = 6000)\n\nnumber of iterations= 4133\nand five\nset.seed(12341)\nOD5&lt;-normalmixEM(day0_stnfr1$Estimate.norm.adj, k=5,maxit = 6000)\n\nnumber of iterations= 3212\nand six\nset.seed(12341)\nOD6&lt;-normalmixEM(day0_stnfr1$Estimate.norm.adj, k=6,maxit = 10000)\n\nnumber of iterations= 2294\nTo find the best model, we simply look at the log likelihood values for each model.\nmod.table &lt;- tibble(\n                    models = 2:6,\n                    log.liklihood = c(OD2$loglik,OD3$loglik,OD4$loglik,OD5$loglik,OD6$loglik)\n                    )\n  \nkable(mod.table)\n\n\n\n\nmodels\nlog.liklihood\n\n\n\n\n2\n0.5605473\n\n\n3\n4.2371302\n\n\n4\n5.0427587\n\n\n5\n6.4627512\n\n\n6\n14.1006697\nYou can see that mathematically, and taking in to account the assumptions, the best model we tested (i.e. the one with the fewest components but the largest log liklihood) is a model with six components. Note in the chart below that the three minor groups are pretty spiky and pretty small. It really looks like a two component model with some noise.\nIt’s hard to imagine how a 5 component model can be useful in the contenxt of developing a dipstick test. This is a good demonstration of the fact that the maths doesn’t always match the pragmatic operational use of a test. Two component models are pretty much the only viable option for most people.\nggplot(day0_stnfr1, aes(x = Estimate.norm.adj)) +\n  geom_histogram(binwidth = 0.007,color=\"white\",fill=\"grey\") +\n  mapply(\n    function(mean, sd, lambda, n, binwidth) {\n      stat_function(\n        fun = function(x) {\n          (dnorm(x, mean = mean, sd = sd)) * n * binwidth * lambda\n        }\n      )\n    },\n    mean = OD6[[\"mu\"]], #mean\n    sd = OD6[[\"sigma\"]], #standard deviation\n    lambda = OD6[[\"lambda\"]], #amplitude\n    n = length(day0_stnfr1$Estimate.norm.adj), #sample size\n    binwidth = 0.007 #binwidth used for histogram\n  )\nPrincipal Components Analysis (PCA) is a relatively simple way to identify clusters and to visualise patterns in the profile-wide expression of cytokines. In order to perform PCA in R, we need to pivot the data in to a wide format.\nb&lt;-full_data %&gt;% \n  pivot_wider(id_cols = c(test.id,timepoint),names_from = assay, values_from = Estimate.norm) %&gt;% \n  left_join(.,select(full_data,sample,test.id,cf_5_inpatient_outcome)) %&gt;% \n  distinct()\nThe first step in PCA is to run the prcomp command on the columns of interest. This is necessarily a complete case table with numeric values, so missing values should be imputed. The mice package is good for imputation in R, but isn’t used here as the data are mostly complete. There’s just one missing value which we’ll drop to keep this tutorial focussed.\nb&lt;-filter(b,!is.na(ang_1))\nstr(b)\n\ntibble [3,198 × 16] (S3: tbl_df/tbl/data.frame)\n $ test.id               : chr [1:3198] \"SHGKD1852U\" \"ILAID4151N\" \"VGHJM4359F\" \"KOANM9309M\" ...\n $ timepoint             : Factor w/ 3 levels \"control\",\"day0\",..: 2 2 3 3 2 3 2 3 2 2 ...\n $ il_8                  : num [1:3198] -0.1791 -0.0661 -0.1587 -0.0346 -0.0695 ...\n $ stnf_r1               : num [1:3198] -0.3732 -0.17 -0.3819 -0.0615 -0.1188 ...\n $ il_6                  : num [1:3198] -0.1027 -0.0358 -0.0839 -0.024 -0.0436 ...\n $ ang_2                 : num [1:3198] -0.2539 -0.1161 -0.1742 -0.0261 -0.0956 ...\n $ ang_1                 : num [1:3198] -0.3441 -0.1223 -0.2815 -0.0393 -0.0189 ...\n $ trail                 : num [1:3198] -0.175 0.0304 -0.2398 -0.0887 -0.1111 ...\n $ il_10                 : num [1:3198] -0.1949 -0.1095 -0.1655 -0.0417 -0.0922 ...\n $ strem1                : num [1:3198] -0.47555 -0.15306 -0.30833 -0.12808 0.00108 ...\n $ ip_10                 : num [1:3198] -0.0353 0.5973 -0.2134 -0.1718 -0.1771 ...\n $ azu                   : num [1:3198] -0.0553 -0.0437 -0.0117 0.0234 -0.0241 ...\n $ mxa                   : num [1:3198] -0.0995 0.0628 -0.1966 -0.098 -0.0689 ...\n $ chit                  : num [1:3198] -0.26251 0.09555 -0.19727 0.00249 -0.11032 ...\n $ sample                : chr [1:3198] \"LA11033\" \"LA11039\" \"LA11037\" \"LA11039\" ...\n $ cf_5_inpatient_outcome: chr [1:3198] NA NA NA NA ...\nThis now looks fine as all the variables are in the right format, so let’s run the PCA commands on the biomarker columns, scaling the data as we go.\nset.seed(888)\n\ndf.pca&lt;-prcomp(select(b,il_8:chit),scale. = T)\ndf.pca.summary&lt;-summary(df.pca)\ndf.pca.summary\n\nImportance of components:\n                          PC1    PC2    PC3     PC4     PC5     PC6     PC7\nStandard deviation     2.5870 1.2280 1.1281 0.81305 0.77020 0.64417 0.55925\nProportion of Variance 0.5577 0.1257 0.1061 0.05509 0.04943 0.03458 0.02606\nCumulative Proportion  0.5577 0.6834 0.7894 0.84450 0.89393 0.92851 0.95458\n                           PC8     PC9    PC10    PC11    PC12\nStandard deviation     0.50403 0.31443 0.26796 0.25643 0.23370\nProportion of Variance 0.02117 0.00824 0.00598 0.00548 0.00455\nCumulative Proportion  0.97575 0.98399 0.98997 0.99545 1.00000\nWhenever you work with PCA, it is useful to start by looking at the scree plots, which show (a) the proportion of all variance in the data that are explained by each principal component and (b) the cumulative proportion of variance explained by PCs 1-n.\ndf.importance&lt;-tibble(pc = 1:length(df.pca.summary$importance[1,]),\n                      standard.deviation = df.pca.summary$importance[1,],\n                      prop.of.variance = df.pca.summary$importance[2,],\n                      cumulative.variance = df.pca.summary$importance[3,]\n)\n\nggplot(df.importance,aes(pc,prop.of.variance))+geom_bar(stat=\"identity\") +\nggplot(df.importance,aes(pc,cumulative.variance))+geom_bar(stat=\"identity\")\nIt looks like most of the variance is explained by the first principal component.\nThe prcomp data outputs are not compatible with ggplot, so we’ll grab the PC values and add them to our data frame. This is possible because the prcomp data is embedded in an object x which maps to the original df on a row-by-row basis. This allows merging via the bind_cols function.\nb&lt;- bind_cols(b,as.data.frame(df.pca$x))\nJust because the first PC explains the majority of the variance, this doesn’t mean that it is the most informative PC with respect to the differences between different clinical groups.\nWe can use linear regression to explore this in terms of the day of the specimen.\nsummary(\n  glm(data = b,formula = timepoint ~ PC1+PC2+PC3+PC4+PC5+PC6+PC7+PC8+PC9+PC10+PC11+PC12,family = \"binomial\")\n)\n\n\nCall:\nglm(formula = timepoint ~ PC1 + PC2 + PC3 + PC4 + PC5 + PC6 + \n    PC7 + PC8 + PC9 + PC10 + PC11 + PC12, family = \"binomial\", \n    data = b)\n\nCoefficients:\n            Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)  2.71972    0.09996  27.209  &lt; 2e-16 ***\nPC1          0.16861    0.03038   5.551 2.85e-08 ***\nPC2         -1.10026    0.09917 -11.095  &lt; 2e-16 ***\nPC3          0.21725    0.06723   3.231 0.001232 ** \nPC4         -0.20182    0.09381  -2.151 0.031456 *  \nPC5         -0.57254    0.14473  -3.956 7.62e-05 ***\nPC6         -0.68553    0.11987  -5.719 1.07e-08 ***\nPC7         -0.07090    0.17274  -0.410 0.681469    \nPC8         -0.03923    0.21440  -0.183 0.854820    \nPC9         -0.20160    0.22024  -0.915 0.360011    \nPC10         0.36295    0.23847   1.522 0.128001    \nPC11         0.91237    0.26266   3.474 0.000514 ***\nPC12         0.86924    0.29326   2.964 0.003037 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 2347.8  on 3197  degrees of freedom\nResidual deviance: 1897.3  on 3185  degrees of freedom\nAIC: 1923.3\n\nNumber of Fisher Scoring iterations: 7\nHere we can see that several PCs are associated with differences between groups in terms of the timepoint.\nBiplots are used to explore PCA data visually. We’ll start by looking at PC1 and PC2. Our chart will be scaled on the x and y axes [using the aspect ratio controls within theme()]so that the dimensions of the chart don’t misrepresent the proportion of variance explained by each PC. The ellipses show the 95% confidence interval for the various groups.\nggplot(b,aes(PC1,PC2,color=timepoint,label=sample,pch=timepoint))+\n  geom_point(alpha=0.4,size=1) +\n  stat_ellipse(geom=\"polygon\", aes(fill = timepoint), alpha = 0.2, show.legend = FALSE, level = 0.95)+\n  xlab(label = str_c(\"PC1 (\",round(100*df.importance$prop.of.variance[1],2),\" %)\",sep = \"\"))+\n  ylab(label = str_c(\"PC2 (\",round(100*df.importance$prop.of.variance[2],2),\" %)\",sep = \"\"))+\n  theme(aspect.ratio=df.importance$prop.of.variance[2]/df.importance$prop.of.variance[1],\n                  legend.position = \"bottom\"\n)\nThere’s some gross effects here that are pretty easy to see. The day 0 specimens are more positive in PC1 and more negative in PC2 than the other two groups. The day 28 specimens look identical to controls. This fits with what we saw in individual marker analysis earlier.\nIt is hard to interpret this in the context of various markers without understanding which variables contributed to the observed variance in the PCA. A loadings plot is really useful for this. We can get the Loadings from the prcomp object.\ndf.pca %&gt;%\n    tidy(matrix = \"rotation\") %&gt;% \n    filter(PC==\"1\" | PC==\"2\") %&gt;% \n    ggplot(aes(column,value)) +\n  geom_bar(stat=\"identity\")+\n    facet_grid(PC~.)+\n  coord_flip()\nThe loadings plot seems to show that basically all the markers are explaining variation in PC1. A simple interpretation here is that an immune response across the whole profile is the single biggest variation between controls, day 0 and day 28 specimens. Meanwhile there’s more nuance in PC2, where Azu, IP-10 and Mxa associate with movement in the negative direction, whilst Ang-1 and Chit associate with movement in the positive direction. Notable also is that those five markers which associate most with PC2 are the least informative with respect to PC1. This is exactly what we expect with PCA, which is essentially a kind of nth dimensional spatial analysis, where movement in one direction is somewhat counter to movement in another direction.\nIn some circumstances, you might want to look at more specific questions, like “how well does PC1 diagnose bad outcomes?”. For a simple diagnostic like this, we might want to drop the control group so that we are only looking at bad vs good outcomes. We’ll create a new df which just includes these outcomes, then run the PCA.\nset.seed(888)\n\nd&lt;-full_data %&gt;% \n  pivot_wider(id_cols = c(test.id,timepoint),names_from = assay, values_from = Estimate.norm) %&gt;% \n  left_join(.,select(full_data,sample,test.id,cf_5_inpatient_outcome)) %&gt;% \n  distinct() %&gt;% \n  filter(\n         timepoint == \"day0\",\n         !is.na(ang_1),\n         !is.na(cf_5_inpatient_outcome)\n        ) %&gt;% \n  mutate(\n    outcome = as.factor(case_when(\n                                                      cf_5_inpatient_outcome == \"died\" ~ \"Bad\",\n                                                      cf_5_inpatient_outcome == \"discharged_pallative\" ~ \"Bad\",\n                                                      cf_5_inpatient_outcome == \"discharged\" ~ \"Good\"\n                                  )),\n                                    \n                                  outcome = relevel(as.factor(outcome), ref=\"Good\")\n  ) %&gt;% \n  filter(!is.na(outcome))\n         \n\ndf.pca&lt;-prcomp(select(d,il_8:chit),scale. = T)\ndf.pca.summary&lt;-summary(df.pca)\ndf.pca.summary\n\nImportance of components:\n                          PC1    PC2     PC3     PC4     PC5     PC6    PC7\nStandard deviation     2.6575 1.1813 1.04338 0.81799 0.78088 0.64429 0.5299\nProportion of Variance 0.5885 0.1163 0.09072 0.05576 0.05081 0.03459 0.0234\nCumulative Proportion  0.5885 0.7048 0.79552 0.85128 0.90210 0.93669 0.9601\n                           PC8     PC9    PC10    PC11    PC12\nStandard deviation     0.48301 0.29251 0.25392 0.22645 0.21043\nProportion of Variance 0.01944 0.00713 0.00537 0.00427 0.00369\nCumulative Proportion  0.97953 0.98666 0.99204 0.99631 1.00000\nThen save the importance data to an object and show the scree plots\ndf.importance&lt;-tibble(pc = 1:length(df.pca.summary$importance[1,]),\n                      standard.deviation = df.pca.summary$importance[1,],\n                      prop.of.variance = df.pca.summary$importance[2,],\n                      cumulative.variance = df.pca.summary$importance[3,]\n)\n\nggplot(df.importance,aes(pc,prop.of.variance))+geom_bar(stat=\"identity\") +\nggplot(df.importance,aes(pc,cumulative.variance))+geom_bar(stat=\"identity\")\nIt looks like most of the variance is explained by the first principal component.\nd&lt;- bind_cols(d,as.data.frame(df.pca$x))\nWe can use linear regression to explore this in terms of the outcomes.\nsummary(\n  glm(data = d,formula = outcome ~ PC1+PC2+PC3+PC4+PC5+PC6+PC7+PC8+PC9+PC10+PC11+PC12,family = \"binomial\")\n)\n\n\nCall:\nglm(formula = outcome ~ PC1 + PC2 + PC3 + PC4 + PC5 + PC6 + PC7 + \n    PC8 + PC9 + PC10 + PC11 + PC12, family = \"binomial\", data = d)\n\nCoefficients:\n             Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept) -2.698675   0.163441 -16.512  &lt; 2e-16 ***\nPC1          0.081807   0.053149   1.539 0.123761    \nPC2          0.122197   0.116907   1.045 0.295908    \nPC3         -0.006795   0.108802  -0.062 0.950202    \nPC4          0.274704   0.156756   1.752 0.079700 .  \nPC5         -0.618653   0.183398  -3.373 0.000743 ***\nPC6          0.036631   0.197055   0.186 0.852530    \nPC7         -0.544967   0.246411  -2.212 0.026993 *  \nPC8         -0.731695   0.248660  -2.943 0.003255 ** \nPC9         -0.389617   0.441692  -0.882 0.377723    \nPC10        -1.449233   0.512330  -2.829 0.004674 ** \nPC11        -0.508922   0.554347  -0.918 0.358589    \nPC12         1.557524   0.654692   2.379 0.017359 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 452.60  on 781  degrees of freedom\nResidual deviance: 398.44  on 769  degrees of freedom\nAIC: 424.44\n\nNumber of Fisher Scoring iterations: 6\nHere we can see that several PCs are associated with differences between groups in terms of the timepoint.\nBased on the evidence here, there’s no way to accurately prognosticate the clinical outcome on the basis of these markers, either individually or according to multi-marker expression profiles. This is not surprising given the small number of bad outcomes in the data and given the heterogeneous disease backgrounds of the samples.\nThis document provides functions and should have taught you how to\nThe Specimens used in this analysis were collected as part of the Febrile Illness Evaluation in a Broad Range of Endemicity (FIEBRE) study (https://pubmed.ncbi.nlm.nih.gov/32699131/). Clinical work and specimen collection took place at the Institute of Research and Education Development, University of Health Sciences, Ministry of Health, Vientiane, Lao People’s Democratic Republic.\nThe Febrile Illness Evaluation in a Broad Range of Endemicities study is funded by UK Aid from the UK government; the views expressed, however, do not necessarily reflect the UK government’s official policies. Biomarker analysis is funded by GHLabs (https://www.ghlabs.org/).\nThe EM code was slightly modified from https://dozenoaks.twelvetreeslab.co.uk/2019/06/mixture-models."
  },
  {
    "objectID": "Analysis_01.html#introduction",
    "href": "Analysis_01.html#introduction",
    "title": "15  Data Analysis - A Tutorial based on the Mos-Def study",
    "section": "15.1 Introduction",
    "text": "15.1 Introduction\nThe first part of this analysis defines functions to read in a Luminex Magpix data file and analyse the data one assay at a time.\nThis requires a standards file to be provided (MOSDEF_Standard_Concs). It should look like the one below. Beware that the names of the assays and the names of the standards both need to match exactly to those in the data sets. Standard 8 is a background control (i.e. buffer blank). You could manually build this if you wanted to with the tibble command."
  },
  {
    "objectID": "Analysis_01.html#libraries",
    "href": "Analysis_01.html#libraries",
    "title": "15  Data Analysis - A Tutorial based on the Mos-Def study",
    "section": "15.2 Libraries",
    "text": "15.2 Libraries\nLoad the libraries used in this analysis and set a seed so that this is fully reproducible.\n\n  library(drc)\n  library(plotly)\n  library(psych)\n  library(ROCit)\n  library(patchwork)\n  library(broom)\n  library(knitr)\n  library(tidyverse)\n  library(epiR)\n  library(mixtools)\n\nset.seed(51202487)\nknitr::opts_chunk$set(echo = TRUE, fig.width = 16, fig.height = 10)\n\n\nstandards = read_csv(\"data/MOSDEF_Standard_Concs.csv\")\nkable(standards)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nassay\nunit\nS1\nS2\nS3\nS4\nS5\nS6\nS7\nS8\n\n\n\n\nCRP\npg_ml\n10000\n2500.0\n625.000\n156.25000\n39.0625000\n9.7656250\n2.4414062\n0\n\n\nsTREM1\npg_ml\n10000\n2500.0\n625.000\n156.25000\n39.0625000\n9.7656250\n2.4414062\n0\n\n\nAng-2\nng_ml\n100\n25.0\n6.250\n1.56250\n0.3906250\n0.0976562\n0.0244141\n0\n\n\nAng-1\nng_ml\n50\n12.5\n3.125\n0.78125\n0.1953125\n0.0488281\n0.0122070\n0\n\n\nsTNF-R1\npg_ml\n2500\n625.0\n156.250\n39.06250\n9.7656250\n2.4414062\n0.6103516\n0\n\n\nIL-6\npg_ml\n10000\n2500.0\n625.000\n156.25000\n39.0625000\n9.7656250\n2.4414062\n0\n\n\nTRAIL\npg_ml\n10000\n2500.0\n625.000\n156.25000\n39.0625000\n9.7656250\n2.4414062\n0\n\n\nIL-10\npg_ml\n4000\n1000.0\n250.000\n62.50000\n15.6250000\n3.9062500\n0.9765625\n0\n\n\nAzu\nng_ml\n200\n50.0\n12.500\n3.12500\n0.7812500\n0.1953125\n0.0488281\n0\n\n\nMxA\nng_ml\n300\n75.0\n18.750\n4.68750\n1.1718750\n0.2929688\n0.0732422\n0\n\n\nIP-10\npg_ml\n10000\n2500.0\n625.000\n156.25000\n39.0625000\n9.7656250\n2.4414062\n0\n\n\nChit\nng_ml\n100\n25.0\n6.250\n1.56250\n0.3906250\n0.0976562\n0.0244141\n0\n\n\nIL-8\npg_ml\n2500\n625.0\n156.250\n39.06250\n9.7656250\n2.4414062\n0.6103516\n0\n\n\n\n\nrm(standards)"
  },
  {
    "objectID": "Analysis_01.html#define-functions",
    "href": "Analysis_01.html#define-functions",
    "title": "15  Data Analysis - A Tutorial based on the Mos-Def study",
    "section": "15.3 Define Functions",
    "text": "15.3 Define Functions\n\n15.3.1 Read and analyse Luminex Plates\nNote that there’s a section in this which creates a median/range normalised value. This could be useful under some circumstances, but you should think about the underlying assumptions if you are using something like this. For the most part, I can’t imagine that it would be helpful unless you were using a very high multiplex and/or had very rare cases among a huge control data set. For the most part, calibrating using the standard curve should be sufficient and the underlying assumption is not that the median values should be normalised/homogenised. You should therefore use Estimate rather than Estimate.norm\n\nluminex.process.data&lt;-function(file,standards.file=\"data/MOSDEF_Standard_Concs.csv\"){\n\n######################################################################\n# Load in data from luminex machine\n######################################################################\n  df&lt;-read_csv(file,skip = 41,na = c(\"\",\"NA\",\"NaN\"))%&gt;%\n                setNames(tolower(gsub(\"-\",\"_\",names(.)))) %&gt;%\n                mutate(sample= fct_explicit_na(sample)) %&gt;%\n                select_if(!names(.) %in% c('...17', 'location', 'total events')) %&gt;%\n                rename_at(vars(matches(\"^ch3l1$\")), function(x) \"chit\")\n\n  if('crp' %in% names(df) == FALSE){df$crp &lt;- NA} \n\n######################################################################\n# Make function to create a unique ID for each test\n######################################################################\n  randomid &lt;- function(n = 1) {\n    a &lt;- do.call(paste0, replicate(5, sample(LETTERS, n, TRUE), FALSE))\n    paste0(a, sprintf(\"%04d\", sample(9999, n, TRUE)), sample(LETTERS, n, TRUE))\n  }\n######################################################################\n# Make data tidy and then remove when beadcount is below 15 or when sample ID is missing\n# Also assign a unique random ID to each test (deals with issues of duplicate names or replicate tests)\n######################################################################\n  MFI.medians&lt;- df[1:(which(str_detect(string = df$sample,pattern = \"Net MFI\"))[1]-1),]  %&gt;%\n                mutate(test.id=randomid(n=nrow(.))) %&gt;%\n                pivot_longer(cols=2:14, names_to = \"assay\", values_to = \"mfi\")\n\n  MFI.counts&lt;- df[((which(str_detect(string = df$sample,pattern = \"Count\")))[1]+2):(which(str_detect(string = df$sample,pattern = \"Avg Net MFI\"))[1]-1),] %&gt;%\n                pivot_longer(cols=2:14, names_to = \"assay\", values_to = \"bead.count\") %&gt;%\n                mutate(test.id=MFI.medians$test.id)\n\n\n  df&lt;- full_join(MFI.medians,MFI.counts) %&gt;%\n                mutate(\n                      mfi = as.numeric(as.character(mfi)),\n                      bead.count = as.numeric(as.character(bead.count))\n                      ) %&gt;%\n                filter(\n                      sample!=\"(Missing)\",\n                      sample!=\"NA\",\n                      sample!=\"Na\",\n                      sample!=\"NULL\",\n                      bead.count&gt;15,\n                      !is.na(mfi)\n                      )\n\n  ######################################################################\n  # Bind standards from file\n  ######################################################################\n\n   standards&lt;-read_csv(standards.file) %&gt;%\n                      pivot_longer(cols=S1:S8, names_to = \"sample\", values_to = \"conc\") %&gt;%\n                      mutate(\n                            conc = as.numeric(\n                                              case_when(\n                                                        unit=='ng_ml' ~ conc * 1000,\n                                                        TRUE ~ conc\n                                                        )\n                                              ),\n                            assay=tolower(assay),\n                            assay=gsub(x = assay,pattern = \"-\",replacement = \"_\")\n                            ) %&gt;%\n                      select(-unit) %&gt;%\n                      mutate(class=\"standard\")\n\n\n  df &lt;- left_join(df,standards)\n  df$class[which(is.na(df$class))]&lt;-\"specimen\" \n  \n  ################################################################################\n  ################################################################################\n  # Nested function to predict relative concentrations in a curve\n  ################################################################################\n  ################################################################################\n\n\n  luminex.standard.curve.estimator&lt;-function(data,test.assay){\n\n  x&lt;-filter(data,assay == test.assay)       # filter the data to the current assay (test.assay)\n  bg &lt;- filter(x,sample==\"S8\")              # get value of background from standard 8 (buffer blank)\n  x&lt;- mutate(x, bg= min(bg$mfi,na.rm = T))  # set the background value for all lines of data to the minium value of standard 8\n  tp &lt;- filter(x,sample==\"S1\")              # get highest value of the curve from standard 1\n  x &lt;- mutate(x,tp=max(tp$mfi,na.rm = T))   # set the top value for all lines of data using tp\n  mn &lt;- filter(x,sample==\"S7\")              # get lowest value of the curve from standard 7\n  x &lt;- mutate(x,mn=min(mn$mfi,na.rm = T))   # set the bottom value for all lines of data using mn\n  # DON'T subtract background from MFI - In tests it worked better this way\n  # For other data sets, it may be worth doing this\n\n  x &lt;- x %&gt;% mutate(\n                    log10.mfi = log10(mfi), # log transform mfi data\n                    conc=log10(conc)        # log transform the standard concentration data\n                    ) %&gt;%\n             filter(sample!=\"S8\")           # remove standard 8 (background, which isn't used again)   \n\n    x.standards&lt;-x %&gt;% filter(class==\"standard\",log10.mfi&gt;=0) # Get standards only, and remove any spurious values with negative mfi\n    # in practice this will only happen if subtracting background from mfi, which isn't done here. This line is to remind future users\n    # that they should probably do this, or do something bout negative values, like set them to zero.\n\n    x.samples&lt;-x %&gt;% filter(class!=\"standard\",log10.mfi&gt;=0)   # Get specimens only\n\n\n\n  # run dose response model (drm command from drc package, see helpfiles for info)\n  model1&lt;-drm(conc~log10.mfi,\n              fct=LL.4(names=c(\"Slope\", \"Lower\", \"Upper\", \"ED50\")),\n              data=x.standards)\n\n\n  # get the predicted values of concentration from the measured values of the experimental specimens\n  # also create the normalised estimate of the same. \n  # normalisation used here is (Estimate - median of all Estimates) / 95th centile of range of values\n  x&lt;-x %&gt;%\n    mutate(\n      Estimate = predict(model1,data.frame(log10.mfi=x$log10.mfi)),\n      Estimate.norm = (Estimate - median(Estimate,na.rm=T))/(quantile(Estimate,0.95) - quantile(Estimate,0.05))\n    )\n\n    return(x) # Return the estimate and normalised estimate to the parent function\n  }\n\n  ######################################################################\n  # run the standard curves for all assays\n  ######################################################################\n\n  unique.assays&lt;-unique(df$assay) # gets a list of the unique assays in the study\n  \n  #run the luminex.standard.curve.estimator function on assay 1, creating a data set called df.out\n  df.out&lt;-luminex.standard.curve.estimator(data = df,test.assay = unique.assays[1]) \n\n  #run the luminex.standard.curve.estimator function on assays 2-n, binding returned dfs to df.out\n for(i in 2:length(unique.assays)){\n                                  df.out&lt;-bind_rows(df.out,luminex.standard.curve.estimator(data = df,test.assay = unique.assays[i]))\n }\n  \n  ######################################################################\n  # get plate name from file name\n  ######################################################################\n\n  plate = str_replace(string = file,pattern =  \"data_in//\",replacement = \"\") # remove pathname\n  plate = str_replace(string = plate,pattern =  \".csv\",replacement = \"\")     # remove file extension\n  df.out$plate&lt;-plate                                                        # add plate name to the df\n  return(df.out)                                                             # return df, which has processed all assays for the plate\n}"
  },
  {
    "objectID": "Analysis_01.html#plate-setup-and-data-reading",
    "href": "Analysis_01.html#plate-setup-and-data-reading",
    "title": "15  Data Analysis - A Tutorial based on the Mos-Def study",
    "section": "15.4 Plate Setup and data reading",
    "text": "15.4 Plate Setup and data reading\n\n15.4.1 Setup Plate data\nList all the Luminex plate data files in a folder\n\nc.files&lt;-list.files(\"data/luminex_files/\",pattern = \".csv\",full.names = T)\nunlist(c.files)\n\n [1] \"data/luminex_files//plate_01.csv\" \"data/luminex_files//plate_02.csv\"\n [3] \"data/luminex_files//plate_03.csv\" \"data/luminex_files//plate_04.csv\"\n [5] \"data/luminex_files//plate_05.csv\" \"data/luminex_files//plate_06.csv\"\n [7] \"data/luminex_files//plate_07.csv\" \"data/luminex_files//plate_08.csv\"\n [9] \"data/luminex_files//plate_09.csv\" \"data/luminex_files//plate_10.csv\"\n[11] \"data/luminex_files//plate_11.csv\" \"data/luminex_files//plate_12.csv\"\n[13] \"data/luminex_files//plate_13.csv\" \"data/luminex_files//plate_14.csv\"\n[15] \"data/luminex_files//plate_15.csv\" \"data/luminex_files//plate_16.csv\"\n[17] \"data/luminex_files//plate_17.csv\" \"data/luminex_files//plate_18.csv\"\n[19] \"data/luminex_files//plate_19.csv\" \"data/luminex_files//plate_20.csv\"\n[21] \"data/luminex_files//plate_21.csv\" \"data/luminex_files//plate_22.csv\"\n[23] \"data/luminex_files//plate_23.csv\" \"data/luminex_files//plate_24.csv\"\n[25] \"data/luminex_files//plate_25.csv\" \"data/luminex_files//plate_26.csv\"\n[27] \"data/luminex_files//plate_27.csv\" \"data/luminex_files//plate_28.csv\"\n[29] \"data/luminex_files//plate_29.csv\" \"data/luminex_files//plate_30.csv\"\n[31] \"data/luminex_files//plate_31.csv\" \"data/luminex_files//plate_32.csv\"\n[33] \"data/luminex_files//plate_33.csv\" \"data/luminex_files//plate_34.csv\"\n[35] \"data/luminex_files//plate_40.csv\" \"data/luminex_files//plate_41.csv\"\n[37] \"data/luminex_files//plate_42.csv\" \"data/luminex_files//plate_43.csv\"\n[39] \"data/luminex_files//plate_44.csv\" \"data/luminex_files//plate_45.csv\"\n\n\n\n\n15.4.2 Run first plate\n\na&lt;-luminex.process.data(file = c.files[1],standards.file = \"data/MOSDEF_Standard_Concs.csv\")\nkable(tail(a,100))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nsample\ntest.id\nassay\nmfi\nbead.count\nconc\nclass\nbg\ntp\nmn\nlog10.mfi\nEstimate\nEstimate.norm\nplate\n\n\n\n\nLA13044CFP\nSWXZA6598N\nmxa\n400.0\n147\nNA\nspecimen\n130\n21363\n173\n2.602060\n2.403529\n-0.0233599\ndata/luminex_files//plate_01\n\n\nLA13047CFP\nNPDXB8563J\nmxa\n279.0\n134\nNA\nspecimen\n130\n21363\n173\n2.445604\n2.228883\n-0.0966425\ndata/luminex_files//plate_01\n\n\nLA13044FP\nPEVIK2267H\nmxa\n705.0\n212\nNA\nspecimen\n130\n21363\n173\n2.848189\n2.708080\n0.1044318\ndata/luminex_files//plate_01\n\n\nLA13046FP\nXFJNU8182S\nmxa\n1274.0\n195\nNA\nspecimen\n130\n21363\n173\n3.105169\n3.064582\n0.2540227\ndata/luminex_files//plate_01\n\n\nLA13046CFP\nOQKJI1993Q\nmxa\n433.0\n162\nNA\nspecimen\n130\n21363\n173\n2.636488\n2.443938\n-0.0064036\ndata/luminex_files//plate_01\n\n\nLA12587CFP\nDYKJQ0547B\nmxa\n332.5\n166\nNA\nspecimen\n130\n21363\n173\n2.521792\n2.312086\n-0.0617297\ndata/luminex_files//plate_01\n\n\nS1\nKUGAX1968M\nchit\n47395.0\n164\n5.00000\nstandard\n107\n47395\n124\n4.675732\n4.596498\n0.2284353\ndata/luminex_files//plate_01\n\n\nS2\nYCIPI4839P\nchit\n43295.5\n146\n4.39794\nstandard\n107\n47395\n124\n4.636443\n4.534898\n0.1997217\ndata/luminex_files//plate_01\n\n\nS3\nHXARC3921M\nchit\n24411.5\n162\n3.79588\nstandard\n107\n47395\n124\n4.387594\n4.154079\n0.0222091\ndata/luminex_files//plate_01\n\n\nS4\nRENFU0997O\nchit\n5922.0\n184\n3.19382\nstandard\n107\n47395\n124\n3.772468\n3.288613\n-0.3812137\ndata/luminex_files//plate_01\n\n\nS5\nFAPGM9685C\nchit\n957.0\n169\n2.59176\nstandard\n107\n47395\n124\n2.980912\n2.356741\n-0.8155909\ndata/luminex_files//plate_01\n\n\nS6\nHYMGE3339V\nchit\n266.0\n77\n1.98970\nstandard\n107\n47395\n124\n2.424882\n1.838669\n-1.0570816\ndata/luminex_files//plate_01\n\n\nS7\nVVBAO6795F\nchit\n126.5\n174\n1.38764\nstandard\n107\n47395\n124\n2.102091\n1.592431\n-1.1718612\ndata/luminex_files//plate_01\n\n\nS1\nLVIWY2295U\nchit\n45946.0\n127\n5.00000\nstandard\n107\n47395\n124\n4.662248\n4.575312\n0.2185599\ndata/luminex_files//plate_01\n\n\nS2\nLJANW6592I\nchit\n44417.0\n139\n4.39794\nstandard\n107\n47395\n124\n4.647549\n4.552272\n0.2078200\ndata/luminex_files//plate_01\n\n\nS3\nUKRAL2169L\nchit\n22638.0\n110\n3.79588\nstandard\n107\n47395\n124\n4.354838\n4.105194\n-0.0005777\ndata/luminex_files//plate_01\n\n\nS4\nEGSNN8900J\nchit\n5999.0\n159\n3.19382\nstandard\n107\n47395\n124\n3.778079\n3.295980\n-0.3777799\ndata/luminex_files//plate_01\n\n\nS5\nJBVKY4698E\nchit\n1022.5\n208\n2.59176\nstandard\n107\n47395\n124\n3.009663\n2.386690\n-0.8016305\ndata/luminex_files//plate_01\n\n\nS6\nKOCQE8393Q\nchit\n274.5\n210\n1.98970\nstandard\n107\n47395\n124\n2.438542\n1.849982\n-1.0518082\ndata/luminex_files//plate_01\n\n\nS7\nUGOYG8637W\nchit\n124.0\n172\n1.38764\nstandard\n107\n47395\n124\n2.093422\n1.586378\n-1.1746830\ndata/luminex_files//plate_01\n\n\nLA11033FP\nSHGKD1852U\nchit\n9166.0\n176\nNA\nspecimen\n107\n47395\n124\n3.962180\n3.543280\n-0.2625050\ndata/luminex_files//plate_01\n\n\nLA11039FP\nILAID4151N\nchit\n31025.5\n196\nNA\nspecimen\n107\n47395\n124\n4.491719\n4.311422\n0.0955518\ndata/luminex_files//plate_01\n\n\nLA11037CFP\nVGHJM4359F\nchit\n11562.0\n196\nNA\nspecimen\n107\n47395\n124\n4.063033\n3.683236\n-0.1972670\ndata/luminex_files//plate_01\n\n\nLA11039CFP\nKOANM9309M\nchit\n22870.0\n196\nNA\nspecimen\n107\n47395\n124\n4.359266\n4.111785\n0.0024945\ndata/luminex_files//plate_01\n\n\nLA11037FP\nEGPPE6968D\nchit\n15636.5\n218\nNA\nspecimen\n107\n47395\n124\n4.194140\n3.869756\n-0.1103237\ndata/luminex_files//plate_01\n\n\nLA11036CFP\nLWPQA3913Y\nchit\n35098.5\n194\nNA\nspecimen\n107\n47395\n124\n4.545289\n4.393504\n0.1338133\ndata/luminex_files//plate_01\n\n\nLA11036FP\nWIUSH3317X\nchit\n39089.0\n179\nNA\nspecimen\n107\n47395\n124\n4.592055\n4.465778\n0.1675022\ndata/luminex_files//plate_01\n\n\nLA11034CFP\nHASCA4592S\nchit\n7312.0\n192\nNA\nspecimen\n107\n47395\n124\n3.864036\n3.410109\n-0.3245806\ndata/luminex_files//plate_01\n\n\nLA11040FP\nSTYAL4876A\nchit\n33963.0\n123\nNA\nspecimen\n107\n47395\n124\n4.531006\n4.371546\n0.1235776\ndata/luminex_files//plate_01\n\n\nLA11034FP\nHLPGU1397F\nchit\n9173.0\n160\nNA\nspecimen\n107\n47395\n124\n3.962511\n3.543735\n-0.2622930\ndata/luminex_files//plate_01\n\n\nLA11033CFP\nUPJRU9129S\nchit\n14845.0\n169\nNA\nspecimen\n107\n47395\n124\n4.171580\n3.837299\n-0.1254527\ndata/luminex_files//plate_01\n\n\nLA11040CFP\nJVOSI1587O\nchit\n7597.0\n162\nNA\nspecimen\n107\n47395\n124\n3.880642\n3.432429\n-0.3141766\ndata/luminex_files//plate_01\n\n\nLA12027CFP\nFCIFG0648D\nchit\n34638.0\n157\nNA\nspecimen\n107\n47395\n124\n4.539553\n4.384680\n0.1296997\ndata/luminex_files//plate_01\n\n\nLA12027FP\nHJYDE3625F\nchit\n17165.5\n162\nNA\nspecimen\n107\n47395\n124\n4.234656\n3.928420\n-0.0829782\ndata/luminex_files//plate_01\n\n\nLA12026CFP\nVRHCL9504V\nchit\n28559.0\n171\nNA\nspecimen\n107\n47395\n124\n4.455743\n4.256727\n0.0700566\ndata/luminex_files//plate_01\n\n\nLA12026FP\nVAYHW1782L\nchit\n37131.0\n208\nNA\nspecimen\n107\n47395\n124\n4.569737\n4.431216\n0.1513919\ndata/luminex_files//plate_01\n\n\nLA12024CFP\nNPLGF7754K\nchit\n28885.0\n151\nNA\nspecimen\n107\n47395\n124\n4.460672\n4.264201\n0.0735403\ndata/luminex_files//plate_01\n\n\nLA12022CFP\nJQKTV5449U\nchit\n34388.0\n159\nNA\nspecimen\n107\n47395\n124\n4.536407\n4.379843\n0.1274452\ndata/luminex_files//plate_01\n\n\nLA12024FP\nFOLVC5757H\nchit\n33679.0\n171\nNA\nspecimen\n107\n47395\n124\n4.527359\n4.365948\n0.1209681\ndata/luminex_files//plate_01\n\n\nLA12028FP\nYDITP1935G\nchit\n13637.5\n172\nNA\nspecimen\n107\n47395\n124\n4.134735\n3.784611\n-0.1500125\ndata/luminex_files//plate_01\n\n\nLA12021CFP\nQBWQM4347F\nchit\n18157.0\n161\nNA\nspecimen\n107\n47395\n124\n4.259044\n3.963960\n-0.0664121\ndata/luminex_files//plate_01\n\n\nLA12028CFP\nZZIZF0455C\nchit\n26270.0\n181\nNA\nspecimen\n107\n47395\n124\n4.419460\n4.201918\n0.0445086\ndata/luminex_files//plate_01\n\n\nLA12022FP\nWTCZZ6985E\nchit\n27339.0\n183\nNA\nspecimen\n107\n47395\n124\n4.436783\n4.228041\n0.0566852\ndata/luminex_files//plate_01\n\n\nLA12021FP\nOIXZA0659A\nchit\n1192.5\n180\nNA\nspecimen\n107\n47395\n124\n3.076458\n2.457441\n-0.7686509\ndata/luminex_files//plate_01\n\n\nLA12023FP\nTUCFK1156H\nchit\n12064.0\n189\nNA\nspecimen\n107\n47395\n124\n4.081491\n3.709186\n-0.1851708\ndata/luminex_files//plate_01\n\n\nLA12034FP\nJFNKQ9365E\nchit\n21850.0\n116\nNA\nspecimen\n107\n47395\n124\n4.339451\n4.082335\n-0.0112334\ndata/luminex_files//plate_01\n\n\nLA12031FP\nKKTBR9167G\nchit\n10950.0\n169\nNA\nspecimen\n107\n47395\n124\n4.039414\n3.650181\n-0.2126749\ndata/luminex_files//plate_01\n\n\nLA12030FP\nZLHKQ3056W\nchit\n32480.0\n169\nNA\nspecimen\n107\n47395\n124\n4.511616\n4.341821\n0.1097218\ndata/luminex_files//plate_01\n\n\nLA12032FP\nOPEWU1360J\nchit\n44005.0\n177\nNA\nspecimen\n107\n47395\n124\n4.643502\n4.545937\n0.2048673\ndata/luminex_files//plate_01\n\n\nLA12033FP\nCUVAC1977G\nchit\n40933.0\n204\nNA\nspecimen\n107\n47395\n124\n4.612074\n4.496888\n0.1820040\ndata/luminex_files//plate_01\n\n\nLA12025FP\nQYMHD2998X\nchit\n24232.0\n179\nNA\nspecimen\n107\n47395\n124\n4.384389\n4.149283\n0.0199733\ndata/luminex_files//plate_01\n\n\nLA12029FP\nVHKUC4047G\nchit\n11726.0\n197\nNA\nspecimen\n107\n47395\n124\n4.069150\n3.691824\n-0.1932637\ndata/luminex_files//plate_01\n\n\nLA19076FP\nVFZHQ3422A\nchit\n17629.0\n129\nNA\nspecimen\n107\n47395\n124\n4.246228\n3.945261\n-0.0751280\ndata/luminex_files//plate_01\n\n\nLA19075FP\nKHUXL8867Y\nchit\n11563.0\n191\nNA\nspecimen\n107\n47395\n124\n4.063071\n3.683288\n-0.1972424\ndata/luminex_files//plate_01\n\n\nLA19074FP\nSQSNR6198H\nchit\n31448.5\n172\nNA\nspecimen\n107\n47395\n124\n4.497600\n4.320396\n0.0997350\ndata/luminex_files//plate_01\n\n\nLA19073FP\nSSWIM3847X\nchit\n33707.0\n162\nNA\nspecimen\n107\n47395\n124\n4.527720\n4.366502\n0.1212263\ndata/luminex_files//plate_01\n\n\nLA19072FP\nFOIZY7136I\nchit\n19664.0\n185\nNA\nspecimen\n107\n47395\n124\n4.293672\n4.014714\n-0.0427538\ndata/luminex_files//plate_01\n\n\nLA19071FP\nWGJOZ6938A\nchit\n26330.0\n189\nNA\nspecimen\n107\n47395\n124\n4.420451\n4.203410\n0.0452040\ndata/luminex_files//plate_01\n\n\nLA19070FP\nFCNHC5405J\nchit\n32785.0\n181\nNA\nspecimen\n107\n47395\n124\n4.515675\n4.348035\n0.1126186\ndata/luminex_files//plate_01\n\n\nLA19069FP\nBJNDC1787J\nchit\n31667.5\n184\nNA\nspecimen\n107\n47395\n124\n4.500614\n4.324999\n0.1018804\ndata/luminex_files//plate_01\n\n\nLA19068FP\nSOAWG2729N\nchit\n26859.0\n128\nNA\nspecimen\n107\n47395\n124\n4.429090\n4.216430\n0.0512730\ndata/luminex_files//plate_01\n\n\nLA19067FP\nYKYZG4464G\nchit\n24071.0\n163\nNA\nspecimen\n107\n47395\n124\n4.381494\n4.144953\n0.0179549\ndata/luminex_files//plate_01\n\n\nLA19066FP\nZABYK9626H\nchit\n29642.0\n153\nNA\nspecimen\n107\n47395\n124\n4.471908\n4.281259\n0.0814919\ndata/luminex_files//plate_01\n\n\nLA19065FP\nFCIID4951Q\nchit\n16713.5\n174\nNA\nspecimen\n107\n47395\n124\n4.223067\n3.911592\n-0.0908225\ndata/luminex_files//plate_01\n\n\nLA19064FP\nFFARN9962A\nchit\n19824.0\n151\nNA\nspecimen\n107\n47395\n124\n4.297191\n4.019891\n-0.0403404\ndata/luminex_files//plate_01\n\n\nLA19063FP\nYSPMQ7157A\nchit\n7087.0\n222\nNA\nspecimen\n107\n47395\n124\n3.850462\n3.391929\n-0.3330546\ndata/luminex_files//plate_01\n\n\nLA19062FP\nXKMHL2286R\nchit\n16094.0\n214\nNA\nspecimen\n107\n47395\n124\n4.206664\n3.887839\n-0.1018945\ndata/luminex_files//plate_01\n\n\nLA19061FP\nZJUTH0630E\nchit\n28419.0\n177\nNA\nspecimen\n107\n47395\n124\n4.453609\n4.253493\n0.0685492\ndata/luminex_files//plate_01\n\n\nLA19060FP\nPQNTB0480Q\nchit\n18365.0\n128\nNA\nspecimen\n107\n47395\n124\n4.263991\n3.971189\n-0.0630421\ndata/luminex_files//plate_01\n\n\nLA19059FP\nVFWTH5193U\nchit\n31604.5\n118\nNA\nspecimen\n107\n47395\n124\n4.499749\n4.323678\n0.1012646\ndata/luminex_files//plate_01\n\n\nLA19058FP\nZKQKJ4765K\nchit\n23945.0\n107\nNA\nspecimen\n107\n47395\n124\n4.379215\n4.141546\n0.0163667\ndata/luminex_files//plate_01\n\n\nLA19057FP\nBJLNT2569K\nchit\n16394.0\n177\nNA\nspecimen\n107\n47395\n124\n4.214685\n3.899444\n-0.0964850\ndata/luminex_files//plate_01\n\n\nLA19056FP\nWDIEJ7300D\nchit\n25363.5\n154\nNA\nspecimen\n107\n47395\n124\n4.404209\n4.178988\n0.0338198\ndata/luminex_files//plate_01\n\n\nLA19055FP\nWBEMZ8364O\nchit\n22725.0\n171\nNA\nspecimen\n107\n47395\n124\n4.356504\n4.107673\n0.0005777\ndata/luminex_files//plate_01\n\n\nLA19054FP\nGQLIG2522J\nchit\n25889.0\n179\nNA\nspecimen\n107\n47395\n124\n4.413115\n4.192371\n0.0400582\ndata/luminex_files//plate_01\n\n\nLA14029FP\nCEOMW0540K\nchit\n42000.5\n160\nNA\nspecimen\n107\n47395\n124\n4.623254\n4.514309\n0.1901243\ndata/luminex_files//plate_01\n\n\nLA14029CFP\nCGNQI1160J\nchit\n17772.0\n203\nNA\nspecimen\n107\n47395\n124\n4.249736\n3.950375\n-0.0727442\ndata/luminex_files//plate_01\n\n\nLA14028FP\nUKESF7004Q\nchit\n29761.0\n127\nNA\nspecimen\n107\n47395\n124\n4.473648\n4.283904\n0.0827249\ndata/luminex_files//plate_01\n\n\nLA14027FP\nYSQYR9458Q\nchit\n26256.0\n165\nNA\nspecimen\n107\n47395\n124\n4.419229\n4.201570\n0.0443461\ndata/luminex_files//plate_01\n\n\nLA14028CFP\nIQWRF4475A\nchit\n36194.5\n192\nNA\nspecimen\n107\n47395\n124\n4.558643\n4.414084\n0.1434060\ndata/luminex_files//plate_01\n\n\nLA14027CFP\nHDHBH5824I\nchit\n28571.0\n169\nNA\nspecimen\n107\n47395\n124\n4.455925\n4.257003\n0.0701854\ndata/luminex_files//plate_01\n\n\nLA14026CFP\nNIVWI2815C\nchit\n21558.0\n179\nNA\nspecimen\n107\n47395\n124\n4.333609\n4.073671\n-0.0152717\ndata/luminex_files//plate_01\n\n\nLA14026FP\nTWRXA5018E\nchit\n5411.0\n232\nNA\nspecimen\n107\n47395\n124\n3.733277\n3.237440\n-0.4050675\ndata/luminex_files//plate_01\n\n\nLA14025CFP\nQZAQT6173F\nchit\n16233.0\n193\nNA\nspecimen\n107\n47395\n124\n4.210399\n3.893240\n-0.0993767\ndata/luminex_files//plate_01\n\n\nLA14025FP\nKCGKZ4596G\nchit\n5400.0\n196\nNA\nspecimen\n107\n47395\n124\n3.732394\n3.236291\n-0.4056027\ndata/luminex_files//plate_01\n\n\nLA14024FP\nQHAAS3070U\nchit\n28896.0\n170\nNA\nspecimen\n107\n47395\n124\n4.460838\n4.264451\n0.0736572\ndata/luminex_files//plate_01\n\n\nLA14024CFP\nUGUGS0605Z\nchit\n39745.0\n149\nNA\nspecimen\n107\n47395\n124\n4.599283\n4.476998\n0.1727326\ndata/luminex_files//plate_01\n\n\nLA13051FP\nLPAMF2203X\nchit\n9338.0\n211\nNA\nspecimen\n107\n47395\n124\n3.970254\n3.554369\n-0.2573359\ndata/luminex_files//plate_01\n\n\nLA13050FP\nHPEUL6649T\nchit\n36107.5\n178\nNA\nspecimen\n107\n47395\n124\n4.557597\n4.412472\n0.1426545\ndata/luminex_files//plate_01\n\n\nLA13051CFP\nTOWYT4920L\nchit\n19797.0\n175\nNA\nspecimen\n107\n47395\n124\n4.296599\n4.019020\n-0.0407464\ndata/luminex_files//plate_01\n\n\nLA13050CFP\nGTKLW6867M\nchit\n16790.0\n198\nNA\nspecimen\n107\n47395\n124\n4.225051\n3.914469\n-0.0894814\ndata/luminex_files//plate_01\n\n\nLA13048FP\nTUFEH9339A\nchit\n1322.5\n192\nNA\nspecimen\n107\n47395\n124\n3.121396\n2.505958\n-0.7460358\ndata/luminex_files//plate_01\n\n\nLA13048CFP\nWSATP2009K\nchit\n24000.0\n163\nNA\nspecimen\n107\n47395\n124\n4.380211\n4.143035\n0.0170609\ndata/luminex_files//plate_01\n\n\nLA13047FP\nPIRTJ0833C\nchit\n9020.0\n151\nNA\nspecimen\n107\n47395\n124\n3.955207\n3.533718\n-0.2669619\ndata/luminex_files//plate_01\n\n\nLA13044CFP\nSWXZA6598N\nchit\n11052.0\n134\nNA\nspecimen\n107\n47395\n124\n4.043441\n3.655804\n-0.2100536\ndata/luminex_files//plate_01\n\n\nLA13047CFP\nNPDXB8563J\nchit\n10940.5\n140\nNA\nspecimen\n107\n47395\n124\n4.039037\n3.649655\n-0.2129202\ndata/luminex_files//plate_01\n\n\nLA13044FP\nPEVIK2267H\nchit\n36310.0\n185\nNA\nspecimen\n107\n47395\n124\n4.560026\n4.416219\n0.1444012\ndata/luminex_files//plate_01\n\n\nLA13046FP\nXFJNU8182S\nchit\n30445.0\n164\nNA\nspecimen\n107\n47395\n124\n4.483516\n4.298920\n0.0897244\ndata/luminex_files//plate_01\n\n\nLA13046CFP\nOQKJI1993Q\nchit\n21359.0\n167\nNA\nspecimen\n107\n47395\n124\n4.329581\n4.067705\n-0.0180527\ndata/luminex_files//plate_01\n\n\nLA12587CFP\nDYKJQ0547B\nchit\n9441.0\n205\nNA\nspecimen\n107\n47395\n124\n3.975018\n3.560922\n-0.2542814\ndata/luminex_files//plate_01\n\n\n\n\n\n\n\n15.4.3 Look at the plate 1 standards and specimens\n\n       ( \n        ggplot(filter(a,class==\"standard\"),aes(log10.mfi,Estimate.norm,color=class))+\n        facet_wrap(assay~.)+\n        geom_point(data=filter(a,class==\"specimen\"),aes(log10.mfi,Estimate.norm),size=0.2,alpha=0.3)+\n        geom_point(size=0.2)\n       )\n\n\n\n\nThe pink dots show the specimens and the blue dots (and line) show the standard curve. You can see that most specimen estimates fall inside the standard curve, which is desirable and which is essentially forced by our choice of dose-response model. Note also that CRP didn’t work on this plate. This is not unexpected. It was quite an ask to get CRP on to this multiplex as it has very high activity compared to other markers. For the most part these all look pretty good.\n\n\n15.4.4 Read in the rest of the plates\n\nfor(i in 2:length(c.files)){a&lt;-bind_rows(a,luminex.process.data(file = c.files[i],standards.file = \"data/MOSDEF_Standard_Concs.csv\"))}\n\n\n\n15.4.5 Chart the results for all assays on all plates\n\n######################################################################\n# Draw charts\n######################################################################\n\n(ggplot(a,aes(log10.mfi,Estimate,color=class))+geom_point(size=0.1)+facet_wrap(.~assay,scales = \"free\"))\n\n\n\ntry(dir.create(\"output\"))#make an output folder to save hard copies\n\na$plate&lt;-str_remove(string = a$plate,\"data/luminex_files/\")\na$plate&lt;-str_remove(string = a$plate,\".csv\")\n\nAs you can see, the CRP assay didn’t really work at all, so we’ll remove it.\n\na&lt;-a %&gt;%  filter(assay!=\"crp\",\n                class==\"specimen\") %&gt;% \n          distinct()\n\nYou can also see that some plates behaved unusually in the Azu assay. We’ll investigate those further next."
  },
  {
    "objectID": "Analysis_01.html#visualisation",
    "href": "Analysis_01.html#visualisation",
    "title": "15  Data Analysis - A Tutorial based on the Mos-Def study",
    "section": "15.5 Visualisation",
    "text": "15.5 Visualisation\n\n15.5.1 Define a function that will draw a chart for each assay, showing effects of normalisation on a plate-by-plate basis\nThis type of chart is useful for identifying outlier plates which may have behaved differently. You should note that if you’ve got all of your clinical cases on one plate, but all your control cases on another, then you’d expect to see outliers because of this.\n\nplot.assay&lt;-function(test.assay){\n  ggplot(filter(a,assay==test.assay),aes(plate,Estimate))+\n    geom_boxplot(size=0.3)+\n    ggtitle(test.assay)+\n    facet_wrap(.~class,scales = \"free\")+\n    theme(legend.position = \"none\",axis.text.x = element_text(angle = 90,size=3))\n}\n\n\n\n15.5.2 Apply the function to all assays\nNotably, the standards were odd in these plates, which suggests that there may be some issues that could be solved by running the plates again.\n\n15.5.2.1 IL-8\n\nplot.assay(\"il_8\")\n\n\n\n\n\n\n15.5.2.2 Azu\n\nplot.assay(\"azu\");\n\n\n\n\n\n\n15.5.2.3 STNF-R1\n\nplot.assay(\"stnf_r1\")\n\n\n\n\n\n\n15.5.2.4 IL-6\n\nplot.assay(\"il_6\")\n\n\n\n\n\n\n15.5.2.5 ANG-2\n\nplot.assay(\"ang_2\")\n\n\n\n\n\n\n15.5.2.6 ANG-1\n\nplot.assay(\"ang_1\")\n\n\n\n\n\n\n15.5.2.7 TRAIL\n\nplot.assay(\"trail\")\n\n\n\n\n\n\n15.5.2.8 IL-10\n\nplot.assay(\"il_10\")\n\n\n\n\n\n\n15.5.2.9 STREM-1\n\nplot.assay(\"strem1\")\n\n\n\n\n\n\n15.5.2.10 IP-10\n\nplot.assay(\"ip_10\")\n\n\n\n\n\n\n15.5.2.11 Mxa\n\nplot.assay(\"mxa\")\n\n\n\n\n\n\n15.5.2.12 Chit\n\nplot.assay(\"chit\")"
  },
  {
    "objectID": "Analysis_01.html#clinical-data",
    "href": "Analysis_01.html#clinical-data",
    "title": "15  Data Analysis - A Tutorial based on the Mos-Def study",
    "section": "15.6 Clinical data",
    "text": "15.6 Clinical data\nThe data imported from the Luminex files do not include clinical parameters that will be used in an analysis. The ID numbers do contain some information though. Here, the last characters of the sample variable tell us whether the data relate to a specimen taken at day 0 (FP) or day 28 (CFP). We’ll make a new variable which captures this, then remove those characters from the sample variable.\n\na&lt;- a %&gt;% \n  mutate(\n    timepoint = case_when(\n                          str_detect(sample, pattern = \"CFP\") ~ \"day28\",\n                          str_detect(sample, pattern = \"FP\") ~ \"day0\"\n                          ),\n    timepoint = factor(timepoint),\n    sample = str_remove(sample,\"CFP|FP\")\n  )\n\nThe clinical data are provided in the file 0000_clinical_data.csv and include the following variables\n\nsample\n\nThe sample ID now stored in the Luminex derived df\n\ninpatient_outpatient\n\nThis is a factor indicating whether the person was\n\nA person with a clinical case of fever, who was treated as an outpatient\n\nA person with a clinical case of fever, who was treated as an inpatient\n\nA person without fever, living in the same communities as the cases\n\n\noutcome\n\ngood\n\nThe person recovered by day 28\n\nbad\n\nThe person was still ill, or was dead at day 28\n\ncontrol\n\nCommunity Control, no fever\n\nltfu\n\nLost to follow-up\n\n\nfever_days\n\nThe number of days that the person was symptomatic prior to triage at day 0\n\ntime_death\n\nThe days elapsed between day 0 and death\n\ntime_death_plus_fever_days\n\nThe days elapsed between symptom onset and death\n\nFor cases where symptom onset was unknown, this was set to the modal value (2)\n\n\n\n\nclinical.and.control.data &lt;- read_csv(\"data/0000_clinical_data.csv\")\nkable(clinical.and.control.data[1:100,])\n\n\n\n\nsample\ninpatient_outpatient\ncf_5_inpatient_outcome\n\n\n\n\nZW70734\ninpatient\ndischarged\n\n\nLA12100\ninpatient\ndischarged\n\n\nLA12397\ninpatient\ndischarged\n\n\nMW24057\ninpatient\ndischarged\n\n\nMZ42156\ninpatient\ndied\n\n\nLA12188\ninpatient\ndischarged\n\n\nLA12126\ninpatient\ndischarged\n\n\nLA12329\ninpatient\ndischarged\n\n\nLA12568\ninpatient\ndischarged_pallative\n\n\nMZ42199\ninpatient\ndischarged\n\n\nLA11188\ninpatient\ndischarged\n\n\nMZ42209\ninpatient\ndied\n\n\nLA12408\ninpatient\ndischarged\n\n\nMW29098\ninpatient\ndischarged\n\n\nLA12567\ninpatient\ndischarged\n\n\nZW56286\ninpatient\nother_health_facility\n\n\nLA12229\ninpatient\ndischarged\n\n\nLA12419\ninpatient\ndied\n\n\nLA12414\ninpatient\ndischarged\n\n\nLA12162\ninpatient\ndischarged\n\n\nMW22859\ninpatient\ndied\n\n\nZW57902\ninpatient\ndischarged\n\n\nZW70834\ninpatient\ndischarged\n\n\nLA12286\ninpatient\ndischarged\n\n\nZW57757\ninpatient\ndischarged\n\n\nLA12050\ninpatient\ndischarged\n\n\nLA12472\ninpatient\ndischarged\n\n\nMZ42136\ninpatient\ndischarged\n\n\nZW58240\ninpatient\ndischarged\n\n\nZW60132\ninpatient\ndischarged\n\n\nZW70641\ninpatient\ndischarged\n\n\nMW22330\ninpatient\ndischarged\n\n\nMZ42278\ninpatient\ndischarged\n\n\nLA12158\ninpatient\ndischarged\n\n\nLA12163\ninpatient\ndischarged\n\n\nMZ42501\ninpatient\ndischarged\n\n\nLA12309\ninpatient\ndischarged\n\n\nLA12411\ninpatient\ndischarged\n\n\nMZ42099\ninpatient\ndischarged_pallative\n\n\nLA12026\ninpatient\ndischarged\n\n\nLA12292\ninpatient\ndischarged\n\n\nZW50085\ninpatient\ndischarged\n\n\nZW60011\ninpatient\ndischarged\n\n\nLA12306\ninpatient\ndischarged\n\n\nLA12589\ninpatient\ndischarged\n\n\nLA12348\ninpatient\ndischarged\n\n\nZW70731\ninpatient\ndischarged\n\n\nMW25505\ninpatient\ndischarged\n\n\nMW29383\ninpatient\ndischarged\n\n\nLA12203\ninpatient\ndischarged\n\n\nZW60254\ninpatient\ndischarged\n\n\nMZ42145\ninpatient\ndied\n\n\nZW70464\ninpatient\ndischarged\n\n\nLA12241\ninpatient\ndischarged\n\n\nMZ42098\ninpatient\ndischarged\n\n\nZW60253\ninpatient\ndischarged\n\n\nLA12255\ninpatient\ndischarged\n\n\nLA11285\ninpatient\ndischarged\n\n\nLA12118\ninpatient\nother_health_facility\n\n\nLA12339\ninpatient\ndischarged\n\n\nMZ42168\ninpatient\ndischarged\n\n\nLA12370\ninpatient\ndischarged\n\n\nMW20937\ninpatient\ndied\n\n\nLA12318\ninpatient\ndischarged\n\n\nZW51134\ninpatient\nother_health_facility\n\n\nZW60255\ninpatient\ndischarged\n\n\nLA12134\ninpatient\nother_health_facility\n\n\nZW58499\ninpatient\ndischarged\n\n\nZW52581\ninpatient\ndischarged\n\n\nZW58900\ninpatient\ndischarged\n\n\nLA12001\ninpatient\ndischarged\n\n\nZW60605\ninpatient\ndischarged\n\n\nMZ42151\ninpatient\ndischarged\n\n\nMZ42566\ninpatient\ndied\n\n\nLA12183\ninpatient\ndischarged\n\n\nMZ42240\ninpatient\nother_health_facility\n\n\nLA12540\ninpatient\ndischarged\n\n\nLA12392\ninpatient\ndischarged\n\n\nMZ42017\ninpatient\ndischarged\n\n\nLA12448\ninpatient\ndischarged\n\n\nMZ42060\ninpatient\ndischarged\n\n\nMZ42175\ninpatient\ndied\n\n\nLA12043\ninpatient\ndischarged_pallative\n\n\nMW28841\ninpatient\ndischarged\n\n\nZW70859\ninpatient\ndischarged\n\n\nZW51034\ninpatient\ndied\n\n\nLA12357\ninpatient\ndischarged\n\n\nLA11354\ninpatient\ndischarged_pallative\n\n\nLA12313\ninpatient\ndischarged\n\n\nLA12434\ninpatient\ndischarged_pallative\n\n\nLA12289\ninpatient\ndischarged\n\n\nLA12258\ninpatient\ndischarged\n\n\nMW28366\ninpatient\ndischarged\n\n\nLA12494\ninpatient\ndischarged\n\n\nLA12249\ninpatient\ndischarged\n\n\nMZ42474\ninpatient\nother_health_facility\n\n\nLA12310\ninpatient\ndischarged\n\n\nLA12573\ninpatient\ndischarged\n\n\nLA12456\ninpatient\ndied\n\n\nLA12359\ninpatient\ndischarged\n\n\n\n\n\nThe next step is to merge the clinical data with the luminex data and then to clarify that day_0 controls are separate from day 0 cases\n\nfull_data&lt;- left_join(a,clinical.and.control.data,by=\"sample\")\nfull_data$timepoint&lt;-as.character(full_data$timepoint)\nfull_data$timepoint[which(as.character(full_data$inpatient_outpatient)==\"control\")] &lt;- \"control\"\nfull_data$timepoint&lt;-as.factor(full_data$timepoint)\nkable(full_data[1:100,])\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nsample\ntest.id\nassay\nmfi\nbead.count\nconc\nclass\nbg\ntp\nmn\nlog10.mfi\nEstimate\nEstimate.norm\nplate\ntimepoint\ninpatient_outpatient\ncf_5_inpatient_outcome\n\n\n\n\nLA11033\nSHGKD1852U\nil_8\n412.0\n135\nNA\nspecimen\n311.5\n37005.0\n346\n2.614897\n0.2633586\n-0.1791349\n/plate_01\nday0\nNA\nNA\n\n\nLA11039\nILAID4151N\nil_8\n555.0\n161\nNA\nspecimen\n311.5\n37005.0\n346\n2.744293\n0.5170225\n-0.0661484\n/plate_01\nday0\nNA\nNA\n\n\nLA11037\nVGHJM4359F\nil_8\n434.5\n188\nNA\nspecimen\n311.5\n37005.0\n346\n2.637990\n0.3093415\n-0.1586533\n/plate_01\nday28\nNA\nNA\n\n\nLA11039\nKOANM9309M\nil_8\n604.5\n136\nNA\nspecimen\n311.5\n37005.0\n346\n2.781396\n0.5879573\n-0.0345527\n/plate_01\nday28\nNA\nNA\n\n\nLA11037\nEGPPE6968D\nil_8\n550.0\n163\nNA\nspecimen\n311.5\n37005.0\n346\n2.740363\n0.5094613\n-0.0695163\n/plate_01\nday0\nNA\nNA\n\n\nLA11036\nLWPQA3913Y\nil_8\n1066.5\n126\nNA\nspecimen\n311.5\n37005.0\n346\n3.027961\n1.0388960\n0.1663035\n/plate_01\nday28\nNA\nNA\n\n\nLA11036\nWIUSH3317X\nil_8\n1147.5\n174\nNA\nspecimen\n311.5\n37005.0\n346\n3.059753\n1.0944655\n0.1910552\n/plate_01\nday0\nNA\nNA\n\n\nLA11034\nHASCA4592S\nil_8\n569.0\n157\nNA\nspecimen\n311.5\n37005.0\n346\n2.755112\n0.5377902\n-0.0568981\n/plate_01\nday28\nNA\nNA\n\n\nLA11040\nSTYAL4876A\nil_8\n504.5\n106\nNA\nspecimen\n311.5\n37005.0\n346\n2.702861\n0.4368614\n-0.1018536\n/plate_01\nday0\nNA\nNA\n\n\nLA11034\nHLPGU1397F\nil_8\n642.5\n126\nNA\nspecimen\n311.5\n37005.0\n346\n2.807873\n0.6380836\n-0.0122256\n/plate_01\nday0\nNA\nNA\n\n\nLA11033\nUPJRU9129S\nil_8\n441.0\n128\nNA\nspecimen\n311.5\n37005.0\n346\n2.644439\n0.3221276\n-0.1529581\n/plate_01\nday28\nNA\nNA\n\n\nLA11040\nJVOSI1587O\nil_8\n430.0\n139\nNA\nspecimen\n311.5\n37005.0\n346\n2.633469\n0.3003627\n-0.1626526\n/plate_01\nday28\nNA\nNA\n\n\nLA12027\nFCIFG0648D\nil_8\n643.5\n138\nNA\nspecimen\n311.5\n37005.0\n346\n2.808549\n0.6393570\n-0.0116584\n/plate_01\nday28\ninpatient\ndischarged\n\n\nLA12027\nHJYDE3625F\nil_8\n816.0\n139\nNA\nspecimen\n311.5\n37005.0\n346\n2.911690\n0.8306722\n0.0735569\n/plate_01\nday0\ninpatient\ndischarged\n\n\nLA12026\nVRHCL9504V\nil_8\n652.0\n153\nNA\nspecimen\n311.5\n37005.0\n346\n2.814248\n0.6500906\n-0.0068775\n/plate_01\nday28\ninpatient\ndischarged\n\n\nLA12026\nVAYHW1782L\nil_8\n1457.0\n153\nNA\nspecimen\n311.5\n37005.0\n346\n3.163460\n1.2717008\n0.2699990\n/plate_01\nday0\ninpatient\ndischarged\n\n\nLA12024\nNPLGF7754K\nil_8\n593.0\n151\nNA\nspecimen\n311.5\n37005.0\n346\n2.773055\n0.5720799\n-0.0416249\n/plate_01\nday28\ninpatient\ndischarged\n\n\nLA12022\nJQKTV5449U\nil_8\n640.0\n126\nNA\nspecimen\n311.5\n37005.0\n346\n2.806180\n0.6348904\n-0.0136479\n/plate_01\nday28\ninpatient\ndischarged\n\n\nLA12024\nFOLVC5757H\nil_8\n654.0\n164\nNA\nspecimen\n311.5\n37005.0\n346\n2.815578\n0.6525930\n-0.0057628\n/plate_01\nday0\ninpatient\ndischarged\n\n\nLA12028\nYDITP1935G\nil_8\n713.5\n152\nNA\nspecimen\n311.5\n37005.0\n346\n2.853394\n0.7233048\n0.0257335\n/plate_01\nday0\ninpatient\ndischarged\n\n\nLA12021\nQBWQM4347F\nil_8\n625.5\n134\nNA\nspecimen\n311.5\n37005.0\n346\n2.796227\n0.6160862\n-0.0220236\n/plate_01\nday28\ninpatient\ndischarged\n\n\nLA12028\nZZIZF0455C\nil_8\n520.5\n160\nNA\nspecimen\n311.5\n37005.0\n346\n2.716421\n0.4632064\n-0.0901191\n/plate_01\nday28\ninpatient\ndischarged\n\n\nLA12022\nWTCZZ6985E\nil_8\n1051.0\n125\nNA\nspecimen\n311.5\n37005.0\n346\n3.021603\n1.0277124\n0.1613222\n/plate_01\nday0\ninpatient\ndischarged\n\n\nLA12021\nOIXZA0659A\nil_8\n501.0\n159\nNA\nspecimen\n311.5\n37005.0\n346\n2.699838\n0.4309725\n-0.1044766\n/plate_01\nday0\ninpatient\ndischarged\n\n\nLA12023\nTUCFK1156H\nil_8\n678.0\n127\nNA\nspecimen\n311.5\n37005.0\n346\n2.831230\n0.6819618\n0.0073186\n/plate_01\nday0\ninpatient\ndischarged\n\n\nLA12034\nJFNKQ9365E\nil_8\n916.0\n111\nNA\nspecimen\n311.5\n37005.0\n346\n2.961895\n0.9215474\n0.1140343\n/plate_01\nday0\ninpatient\nother_health_facility\n\n\nLA12031\nKKTBR9167G\nil_8\n672.0\n149\nNA\nspecimen\n311.5\n37005.0\n346\n2.827369\n0.6747316\n0.0040981\n/plate_01\nday0\ninpatient\ndischarged\n\n\nLA12030\nZLHKQ3056W\nil_8\n1376.5\n134\nNA\nspecimen\n311.5\n37005.0\n346\n3.138776\n1.2300742\n0.2514578\n/plate_01\nday0\ninpatient\ndischarged\n\n\nLA12032\nOPEWU1360J\nil_8\n2434.0\n153\nNA\nspecimen\n311.5\n37005.0\n346\n3.386321\n1.6320710\n0.4305145\n/plate_01\nday0\ninpatient\nother_health_facility\n\n\nLA12033\nCUVAC1977G\nil_8\n1171.5\n176\nNA\nspecimen\n311.5\n37005.0\n346\n3.068742\n1.1100728\n0.1980070\n/plate_01\nday0\ninpatient\ndischarged_pallative\n\n\nLA12025\nQYMHD2998X\nil_8\n1262.0\n138\nNA\nspecimen\n311.5\n37005.0\n346\n3.101059\n1.1657965\n0.2228273\n/plate_01\nday0\ninpatient\ndischarged_pallative\n\n\nLA12029\nVHKUC4047G\nil_8\n431.5\n162\nNA\nspecimen\n311.5\n37005.0\n346\n2.634981\n0.3033674\n-0.1613143\n/plate_01\nday0\ninpatient\ndischarged\n\n\nLA19076\nVFZHQ3422A\nil_8\n595.0\n110\nNA\nspecimen\n311.5\n37005.0\n346\n2.774517\n0.5748661\n-0.0403838\n/plate_01\ncontrol\ncontrol\nControl\n\n\nLA19075\nKHUXL8867Y\nil_8\n577.0\n178\nNA\nspecimen\n311.5\n37005.0\n346\n2.761176\n0.5493993\n-0.0517272\n/plate_01\ncontrol\ncontrol\nControl\n\n\nLA19074\nSQSNR6198H\nil_8\n809.0\n156\nNA\nspecimen\n311.5\n37005.0\n346\n2.907948\n0.8238407\n0.0705140\n/plate_01\ncontrol\ncontrol\nControl\n\n\nLA19073\nSSWIM3847X\nil_8\n694.0\n129\nNA\nspecimen\n311.5\n37005.0\n346\n2.841359\n0.7008926\n0.0157507\n/plate_01\ncontrol\ncontrol\nControl\n\n\nLA19072\nFOIZY7136I\nil_8\n700.0\n157\nNA\nspecimen\n311.5\n37005.0\n346\n2.845098\n0.7078641\n0.0188559\n/plate_01\ncontrol\ncontrol\nControl\n\n\nLA19071\nWGJOZ6938A\nil_8\n1203.0\n172\nNA\nspecimen\n311.5\n37005.0\n346\n3.080266\n1.1300111\n0.2068879\n/plate_01\ncontrol\ncontrol\nControl\n\n\nLA19070\nFCNHC5405J\nil_8\n1019.0\n156\nNA\nspecimen\n311.5\n37005.0\n346\n3.008174\n1.0040155\n0.1507671\n/plate_01\ncontrol\ncontrol\nControl\n\n\nLA19069\nBJNDC1787J\nil_8\n680.5\n176\nNA\nspecimen\n311.5\n37005.0\n346\n2.832828\n0.6849530\n0.0086509\n/plate_01\ncontrol\ncontrol\nControl\n\n\nLA19068\nSOAWG2729N\nil_8\n944.0\n123\nNA\nspecimen\n311.5\n37005.0\n346\n2.974972\n0.9449757\n0.1244697\n/plate_01\ncontrol\ncontrol\nControl\n\n\nLA19067\nYKYZG4464G\nil_8\n559.0\n123\nNA\nspecimen\n311.5\n37005.0\n346\n2.747412\n0.5230161\n-0.0634787\n/plate_01\ncontrol\ncontrol\nControl\n\n\nLA19066\nZABYK9626H\nil_8\n615.0\n121\nNA\nspecimen\n311.5\n37005.0\n346\n2.788875\n0.6021579\n-0.0282275\n/plate_01\ncontrol\ncontrol\nControl\n\n\nLA19065\nFCIID4951Q\nil_8\n719.0\n144\nNA\nspecimen\n311.5\n37005.0\n346\n2.856729\n0.7295005\n0.0284932\n/plate_01\ncontrol\ncontrol\nControl\n\n\nLA19064\nFFARN9962A\nil_8\n743.0\n107\nNA\nspecimen\n311.5\n37005.0\n346\n2.870989\n0.7559196\n0.0402607\n/plate_01\ncontrol\ncontrol\nControl\n\n\nLA19063\nYSPMQ7157A\nil_8\n547.0\n164\nNA\nspecimen\n311.5\n37005.0\n346\n2.737987\n0.5048872\n-0.0715537\n/plate_01\ncontrol\ncontrol\nControl\n\n\nLA19062\nXKMHL2286R\nil_8\n880.5\n156\nNA\nspecimen\n311.5\n37005.0\n346\n2.944729\n0.8906408\n0.1002680\n/plate_01\ncontrol\ncontrol\nControl\n\n\nLA19061\nZJUTH0630E\nil_8\n713.5\n172\nNA\nspecimen\n311.5\n37005.0\n346\n2.853394\n0.7233048\n0.0257335\n/plate_01\ncontrol\ncontrol\nControl\n\n\nLA19060\nPQNTB0480Q\nil_8\n744.0\n105\nNA\nspecimen\n311.5\n37005.0\n346\n2.871573\n0.7569993\n0.0407416\n/plate_01\ncontrol\ncontrol\nControl\n\n\nLA19059\nVFWTH5193U\nil_8\n587.0\n101\nNA\nspecimen\n311.5\n37005.0\n346\n2.768638\n0.5636568\n-0.0453766\n/plate_01\ncontrol\ncontrol\nControl\n\n\nLA19058\nZKQKJ4765K\nil_8\n682.5\n108\nNA\nspecimen\n311.5\n37005.0\n346\n2.834103\n0.6873370\n0.0097128\n/plate_01\ncontrol\ncontrol\nControl\n\n\nLA19057\nBJLNT2569K\nil_8\n565.0\n149\nNA\nspecimen\n311.5\n37005.0\n346\n2.752048\n0.5319161\n-0.0595145\n/plate_01\ncontrol\ncontrol\nControl\n\n\nLA19056\nWDIEJ7300D\nil_8\n617.0\n133\nNA\nspecimen\n311.5\n37005.0\n346\n2.790285\n0.6048316\n-0.0270366\n/plate_01\ncontrol\ncontrol\nControl\n\n\nLA19055\nWBEMZ8364O\nil_8\n735.0\n173\nNA\nspecimen\n311.5\n37005.0\n346\n2.866287\n0.7472224\n0.0363868\n/plate_01\ncontrol\ncontrol\nControl\n\n\nLA19054\nGQLIG2522J\nil_8\n728.0\n153\nNA\nspecimen\n311.5\n37005.0\n346\n2.862131\n0.7395236\n0.0329576\n/plate_01\ncontrol\ncontrol\nControl\n\n\nLA14029\nCEOMW0540K\nil_8\n14689.0\n167\nNA\nspecimen\n311.5\n37005.0\n346\n4.166992\n2.6923326\n0.9027743\n/plate_01\nday0\ninpatient\ndischarged\n\n\nLA14029\nCGNQI1160J\nil_8\n562.0\n177\nNA\nspecimen\n311.5\n37005.0\n346\n2.749736\n0.5274796\n-0.0614906\n/plate_01\nday28\ninpatient\ndischarged\n\n\nLA14028\nUKESF7004Q\nil_8\n607.0\n107\nNA\nspecimen\n311.5\n37005.0\n346\n2.783189\n0.5913637\n-0.0330355\n/plate_01\nday0\ninpatient\nother_health_facility\n\n\nLA14027\nYSQYR9458Q\nil_8\n864.0\n143\nNA\nspecimen\n311.5\n37005.0\n346\n2.936514\n0.8757883\n0.0936524\n/plate_01\nday0\ninpatient\ndischarged\n\n\nLA14028\nIQWRF4475A\nil_8\n956.0\n154\nNA\nspecimen\n311.5\n37005.0\n346\n2.980458\n0.9547749\n0.1288345\n/plate_01\nday28\ninpatient\nother_health_facility\n\n\nLA14027\nHDHBH5824I\nil_8\n600.5\n154\nNA\nspecimen\n311.5\n37005.0\n346\n2.778513\n0.5824739\n-0.0369952\n/plate_01\nday28\ninpatient\ndischarged\n\n\nLA14026\nNIVWI2815C\nil_8\n595.5\n170\nNA\nspecimen\n311.5\n37005.0\n346\n2.774882\n0.5755610\n-0.0400743\n/plate_01\nday28\ninpatient\ndischarged\n\n\nLA14026\nTWRXA5018E\nil_8\n502.0\n191\nNA\nspecimen\n311.5\n37005.0\n346\n2.700704\n0.4326598\n-0.1037251\n/plate_01\nday0\ninpatient\ndischarged\n\n\nLA14025\nQZAQT6173F\nil_8\n496.0\n154\nNA\nspecimen\n311.5\n37005.0\n346\n2.695482\n0.4224787\n-0.1082599\n/plate_01\nday28\ninpatient\ndischarged\n\n\nLA14025\nKCGKZ4596G\nil_8\n476.0\n151\nNA\nspecimen\n311.5\n37005.0\n346\n2.677607\n0.3875092\n-0.1238360\n/plate_01\nday0\ninpatient\ndischarged\n\n\nLA14024\nQHAAS3070U\nil_8\n2032.0\n123\nNA\nspecimen\n311.5\n37005.0\n346\n3.307924\n1.5084428\n0.3754482\n/plate_01\nday0\ninpatient\ndischarged\n\n\nLA14024\nUGUGS0605Z\nil_8\n861.0\n155\nNA\nspecimen\n311.5\n37005.0\n346\n2.935003\n0.8730532\n0.0924341\n/plate_01\nday28\ninpatient\ndischarged\n\n\nLA13051\nLPAMF2203X\nil_8\n1110.0\n149\nNA\nspecimen\n311.5\n37005.0\n346\n3.045323\n1.0693159\n0.1798531\n/plate_01\nday0\nNA\nNA\n\n\nLA13050\nHPEUL6649T\nil_8\n1246.0\n175\nNA\nspecimen\n311.5\n37005.0\n346\n3.095518\n1.1562843\n0.2185904\n/plate_01\nday0\nNA\nNA\n\n\nLA13051\nTOWYT4920L\nil_8\n961.0\n163\nNA\nspecimen\n311.5\n37005.0\n346\n2.982723\n0.9588165\n0.1306347\n/plate_01\nday28\nNA\nNA\n\n\nLA13050\nGTKLW6867M\nil_8\n812.0\n133\nNA\nspecimen\n311.5\n37005.0\n346\n2.909556\n0.8267767\n0.0718217\n/plate_01\nday28\nNA\nNA\n\n\nLA13048\nTUFEH9339A\nil_8\n495.5\n152\nNA\nspecimen\n311.5\n37005.0\n346\n2.695044\n0.4216240\n-0.1086406\n/plate_01\nday0\nNA\nNA\n\n\nLA13048\nWSATP2009K\nil_8\n512.0\n148\nNA\nspecimen\n311.5\n37005.0\n346\n2.709270\n0.4493265\n-0.0963014\n/plate_01\nday28\nNA\nNA\n\n\nLA13047\nPIRTJ0833C\nil_8\n638.5\n110\nNA\nspecimen\n311.5\n37005.0\n346\n2.805161\n0.6329677\n-0.0145043\n/plate_01\nday0\nNA\nNA\n\n\nLA13044\nSWXZA6598N\nil_8\n642.0\n139\nNA\nspecimen\n311.5\n37005.0\n346\n2.807535\n0.6374461\n-0.0125095\n/plate_01\nday28\nNA\nNA\n\n\nLA13047\nNPDXB8563J\nil_8\n582.0\n101\nNA\nspecimen\n311.5\n37005.0\n346\n2.764923\n0.5565627\n-0.0485365\n/plate_01\nday28\nNA\nNA\n\n\nLA13044\nPEVIK2267H\nil_8\n584.0\n165\nNA\nspecimen\n311.5\n37005.0\n346\n2.766413\n0.5594086\n-0.0472689\n/plate_01\nday0\nNA\nNA\n\n\nLA13046\nXFJNU8182S\nil_8\n877.0\n133\nNA\nspecimen\n311.5\n37005.0\n346\n2.943000\n0.8875170\n0.0988766\n/plate_01\nday0\nNA\nNA\n\n\nLA13046\nOQKJI1993Q\nil_8\n824.0\n165\nNA\nspecimen\n311.5\n37005.0\n346\n2.915927\n0.8383984\n0.0769983\n/plate_01\nday28\nNA\nNA\n\n\nLA12587\nDYKJQ0547B\nil_8\n576.0\n176\nNA\nspecimen\n311.5\n37005.0\n346\n2.760422\n0.5479581\n-0.0523691\n/plate_01\nday28\ninpatient\ndischarged\n\n\nLA11033\nSHGKD1852U\nstnf_r1\n235.0\n161\nNA\nspecimen\n208.0\n16683.5\n219\n2.371068\n0.2688853\n-0.3731516\n/plate_01\nday0\nNA\nNA\n\n\nLA11039\nILAID4151N\nstnf_r1\n291.5\n146\nNA\nspecimen\n208.0\n16683.5\n219\n2.464639\n0.6972570\n-0.1700360\n/plate_01\nday0\nNA\nNA\n\n\nLA11037\nVGHJM4359F\nstnf_r1\n233.0\n141\nNA\nspecimen\n208.0\n16683.5\n219\n2.367356\n0.2505310\n-0.3818544\n/plate_01\nday28\nNA\nNA\n\n\nLA11039\nKOANM9309M\nstnf_r1\n332.0\n149\nNA\nspecimen\n208.0\n16683.5\n219\n2.521138\n0.9260595\n-0.0615476\n/plate_01\nday28\nNA\nNA\n\n\nLA11037\nEGPPE6968D\nstnf_r1\n309.5\n146\nNA\nspecimen\n208.0\n16683.5\n219\n2.490661\n0.8052771\n-0.1188175\n/plate_01\nday0\nNA\nNA\n\n\nLA11036\nLWPQA3913Y\nstnf_r1\n697.0\n132\nNA\nspecimen\n208.0\n16683.5\n219\n2.843233\n1.8890279\n0.3950509\n/plate_01\nday28\nNA\nNA\n\n\nLA11036\nWIUSH3317X\nstnf_r1\n533.0\n174\nNA\nspecimen\n208.0\n16683.5\n219\n2.726727\n1.5988437\n0.2574579\n/plate_01\nday0\nNA\nNA\n\n\nLA11034\nHASCA4592S\nstnf_r1\n325.5\n158\nNA\nspecimen\n208.0\n16683.5\n219\n2.512551\n0.8926402\n-0.0773937\n/plate_01\nday28\nNA\nNA\n\n\nLA11040\nSTYAL4876A\nstnf_r1\n282.0\n128\nNA\nspecimen\n208.0\n16683.5\n219\n2.450249\n0.6355232\n-0.1993075\n/plate_01\nday0\nNA\nNA\n\n\nLA11034\nHLPGU1397F\nstnf_r1\n340.0\n136\nNA\nspecimen\n208.0\n16683.5\n219\n2.531479\n0.9656801\n-0.0427612\n/plate_01\nday0\nNA\nNA\n\n\nLA11033\nUPJRU9129S\nstnf_r1\n258.0\n109\nNA\nspecimen\n208.0\n16683.5\n219\n2.411620\n0.4624834\n-0.2813556\n/plate_01\nday28\nNA\nNA\n\n\nLA11040\nJVOSI1587O\nstnf_r1\n235.0\n118\nNA\nspecimen\n208.0\n16683.5\n219\n2.371068\n0.2688853\n-0.3731516\n/plate_01\nday28\nNA\nNA\n\n\nLA12027\nFCIFG0648D\nstnf_r1\n346.0\n143\nNA\nspecimen\n208.0\n16683.5\n219\n2.539076\n0.9943597\n-0.0291626\n/plate_01\nday28\ninpatient\ndischarged\n\n\nLA12027\nHJYDE3625F\nstnf_r1\n519.5\n138\nNA\nspecimen\n208.0\n16683.5\n219\n2.715586\n1.5680079\n0.2428369\n/plate_01\nday0\ninpatient\ndischarged\n\n\nLA12026\nVRHCL9504V\nstnf_r1\n288.0\n187\nNA\nspecimen\n208.0\n16683.5\n219\n2.459392\n0.6749178\n-0.1806283\n/plate_01\nday28\ninpatient\ndischarged\n\n\nLA12026\nVAYHW1782L\nstnf_r1\n977.5\n224\nNA\nspecimen\n208.0\n16683.5\n219\n2.990117\n2.1829638\n0.5344227\n/plate_01\nday0\ninpatient\ndischarged\n\n\nLA12024\nNPLGF7754K\nstnf_r1\n341.5\n152\nNA\nspecimen\n208.0\n16683.5\n219\n2.533391\n0.9729312\n-0.0393231\n/plate_01\nday28\ninpatient\ndischarged\n\n\nLA12022\nJQKTV5449U\nstnf_r1\n378.0\n151\nNA\nspecimen\n208.0\n16683.5\n219\n2.577492\n1.1339740\n0.0370365\n/plate_01\nday28\ninpatient\ndischarged\n\n\nLA12024\nFOLVC5757H\nstnf_r1\n276.5\n170\nNA\nspecimen\n208.0\n16683.5\n219\n2.441695\n0.5981338\n-0.2170360\n/plate_01\nday0\ninpatient\ndischarged\n\n\nLA12028\nYDITP1935G\nstnf_r1\n432.0\n143\nNA\nspecimen\n208.0\n16683.5\n219\n2.635484\n1.3285197\n0.1292818\n/plate_01\nday0\ninpatient\ndischarged"
  },
  {
    "objectID": "Analysis_01.html#removing-bad-plates",
    "href": "Analysis_01.html#removing-bad-plates",
    "title": "15  Data Analysis - A Tutorial based on the Mos-Def study",
    "section": "15.7 Removing bad plates",
    "text": "15.7 Removing bad plates\nIt is really important to remember that a plate may have a very different distribution of values if it contains mostly controls/mostly cases/mostly day 0 specimens etc. or if something went wrong.\nLet’s look at what’s on each plate\n\ntmp&lt;-full_data %&gt;% \n  select(plate,sample,timepoint,cf_5_inpatient_outcome,inpatient_outpatient) %&gt;% \n  distinct() %&gt;% \n  group_by(plate,timepoint,cf_5_inpatient_outcome,inpatient_outpatient) %&gt;% \n  count() %&gt;% \n  mutate(type = str_c(inpatient_outpatient,timepoint,cf_5_inpatient_outcome,sep=\" \"))\n\nggplotly(ggplot(tmp,aes(plate,n))+geom_bar(stat=\"identity\")+\n  facet_wrap(.~type)+\n  theme(legend.position = \"none\",axis.text.x = element_text(angle = 90,size=3))\n)\n\n\n\n\nrm(tmp)\n\nIt is clear from this chart that the unusual patterns observed for plate 14 are actually likely to relate to the fact that plate 14 had lots of specimens from people who had bad outcomes. These are likely to be the most sick. Removing this plate would be a very bad idea. Similarly there’s some plates to the right of plate 14 which have more ‘good’ outcomes than the other plates. You can see this in the boxplots above this chart, where those plates had slightly depressed levels of some of the cytokines compared to other plates.\nThere appears to be no reason why the Azu and a few other markers behaved differently in plates 6, 7 and 8. These may have failed for technical reasons and should be removed\n\nfull_data&lt;- full_data %&gt;% \n        filter(\n              plate != \"plate_06\",\n              plate != \"plate_07\",\n              plate != \"plate_08\"\n              )\n\nWrite the main data frame a to an R object for future use\n\nsaveRDS(full_data,file = \"data/a.RDS\")"
  },
  {
    "objectID": "Analysis_01.html#reality-check",
    "href": "Analysis_01.html#reality-check",
    "title": "15  Data Analysis - A Tutorial based on the Mos-Def study",
    "section": "15.8 Reality check",
    "text": "15.8 Reality check\nThink carefully about what you’re going to use this data for. If you’re working in a lab that has routine access to a Luminex machine, then doing fancy maths (transformations, dimensionality reduction, etc) on the variables is a viable option. If you’re really just looking for a marker that you could add to a diagnostic rapid test strip, then you need something really simple. Analysis should always be led by your ultimate purpose."
  },
  {
    "objectID": "Analysis_01.html#analysis",
    "href": "Analysis_01.html#analysis",
    "title": "15  Data Analysis - A Tutorial based on the Mos-Def study",
    "section": "15.9 Analysis",
    "text": "15.9 Analysis\n\n15.9.1 Expression of markers in different clinical classes at day 0\nThis example shows how to assess variance in the markers according to clinical class or another variable such as patient admission types.\n\nggplot(filter(full_data,(timepoint==\"day0\" | timepoint==\"control\") & !is.na(inpatient_outpatient)),aes(Estimate.norm,fill=inpatient_outpatient))+\n    geom_density(alpha=0.3)+\n    theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),\n          legend.position = \"bottom\",\n          strip.background = element_blank(),\n          strip.placement='outside'\n          )+\n    facet_wrap(.~assay,\n               ncol = 2,\n               scales=\"free_y\",\n               strip.position = 'left')\n\n\n\n\nHere we can also show the results for the “IL-8” assay on its own\n\nggplot(filter(full_data,(timepoint==\"day0\" | timepoint==\"control\") & assay==\"il_8\" & !is.na(inpatient_outpatient)),aes(Estimate.norm,fill=inpatient_outpatient))+\n  geom_density(alpha=0.3)+  \n  geom_boxplot()+\n  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),\n        legend.position = c(.8, .8)\n        )+\n  ggtitle(\"IL-8\")\n\n\n\n\nIt’s pretty easy to see the difference between cases and controls. Be careful what you set out to do/prove/associate with a set of immuno-assays such as these ones because not all markers work this well. For instance, IP10 is also really good\n\nggplot(filter(full_data,(timepoint==\"day0\" | timepoint==\"control\") & assay==\"ip_10\" & !is.na(inpatient_outpatient)),aes(Estimate.norm,fill=inpatient_outpatient))+\n  geom_density(alpha=0.3)+  \n  geom_boxplot()+\n  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),\n        legend.position = c(.8, .8)\n        )+\n  ggtitle(\"IP-10\")\n\n\n\n\nbut TRAIL doesn’t look very specific with respect to severity, and also has a lot of overlap between disease cases and control specimens.\n\nggplot(filter(full_data,(timepoint==\"day0\" | timepoint==\"control\") & assay==\"trail\" & !is.na(inpatient_outpatient)),aes(Estimate.norm,fill=inpatient_outpatient))+\n  geom_density(alpha=0.3)+  \n  geom_boxplot()+\n  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),\n        legend.position = c(.8, .8)\n        )+\n  ggtitle(\"TRAIL\")\n\n\n\n\n\n\n15.9.2 Expression of markers at different time points\nThis is similar in most respects to the analysis above. Here we make use of the fact that for some participants, there are paired specimens from day 0 and day 28. We won’t include the people with bad outcomes here because most of them were either dead (so could not provide day 28 specimen), or just did not provide a paired day 28 specimen. To address questions about how measuring increases or decreases in biomarker levels might be prognostic of disease severity/prognosis/progression, you’d need a more granular sampling frame, for instance specimens collected in a longitudinal series.\nHere, we can look at how patterns of marker expression changed 28 days after the initial day 0 visit. Note the free y axes on these charts below.\n\nggplot(full_data,aes(Estimate.norm,fill=timepoint))+\n  geom_density(alpha=0.3)+\n  facet_wrap(assay~.,\n              scales = \"free_y\",\n              strip.position = 'left'\n             )+\n    theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),\n          legend.position = \"bottom\",\n          strip.background = element_blank(),\n          strip.placement='outside'\n          )\n\n\n\n\nThis shows pretty much what we’d expect to see in the context of a diseased state at day 0 and a resolved disease state at day 28. Most of these immune response markers were higher at day 0 than at day 28. How much we choose to read in to the individual assay responses is contextual to the specific disease/condition/infection and to different population settings. In this setting, we see a very high level of IP-10 at day 0, and a clear distinction between the day 0 and day 28 groups. These specimens were collected during an outbreak of Dengue virus, and IP-10 has well described associations with Dengue infections.\nWe can’t infer from the decrease in the resolved cases by day 28 that there was a concomitant increase in biomarker levels in cases which progressed to bad outcomes. We can infer that a number of these markers are indicative of a diseased state, especially if we add back the control group.\nLooking at an individual marker can be useful. IL-8 clearly discriminates day 0 cases from controls and day 28 specimens\n\nggplot(filter(full_data,assay==\"il_8\"),aes(Estimate.norm,fill=timepoint))+\n  geom_density(alpha=0.3)+\n\n    geom_boxplot(alpha=0.3)+\n  facet_wrap(.~assay)+\n    theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),\n          legend.position = c(0.8,0.8),\n          strip.background = element_blank(),\n          strip.placement='outside'\n          )\n\n\n\n\nMeanwhile IP-10 is also great\n\nggplot(filter(full_data,assay==\"ip_10\"),aes(Estimate.norm,fill=timepoint))+\n  geom_density(alpha=0.3)+\n\n    geom_boxplot(alpha=0.3)+\n  facet_wrap(.~assay)+\n    theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),\n          legend.position = c(0.8,0.8),\n          strip.background = element_blank(),\n          strip.placement='outside'\n          )\n\n\n\n\nbut TRAIL is less conclusive\n\nggplot(filter(full_data,assay==\"trail\"),aes(Estimate.norm,fill=timepoint))+\n  geom_density(alpha=0.3)+\n\n    geom_boxplot(alpha=0.3)+\n  facet_wrap(.~assay)+\n    theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),\n          legend.position = c(0.8,0.8),\n          strip.background = element_blank(),\n          strip.placement='outside'\n          )\n\n\n\n\nThere’s very obvious differences between the diseased state and those who are recovered for some, but not all of these markers.\n\n\n15.9.3 Towards a rapid prognostic test\nWe can take a look at day 0 and see if we can see differences in IP-10 expression between those who go on to have bad outcomes and those who don’t. Here, we are imagining that a simple rapid ‘dipstick’ type test is the ultimate goal. That limits what manipulations we can do, because tests like that are based on ‘more is worse’ type tests. While the dose response curve of a real world rapid test is not usually strictly linear, we have to find candidate markers that indicate disease/infection when they are more abundant.\n\nday0_ip10&lt;- filter(full_data,assay==\"ip_10\",timepoint==\"day0\",cf_5_inpatient_outcome!=\"other_health_facility\",!is.na(cf_5_inpatient_outcome))\nggplot(day0_ip10,aes(Estimate.norm,fill=cf_5_inpatient_outcome))+\n  geom_density(alpha=0.3)\n\n\n\n\nLet’s also go back to the data and look at day 0 for all assays\n\nday_0 &lt;- filter(full_data,timepoint==\"day0\",cf_5_inpatient_outcome!=\"other_health_facility\",!is.na(cf_5_inpatient_outcome))\nggplot(day_0,aes(Estimate.norm,fill=cf_5_inpatient_outcome))+\n  geom_density(alpha=0.3)+\n  facet_wrap(assay~.,\n              scales=\"free_y\",\n              strip.position = 'left'\n             \n             )+\n    theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),\n          legend.position = \"bottom\",\n          strip.background = element_blank(),\n          strip.placement='outside'\n          )\n\n\n\n\nIl-8 looks interesting because a lot of the distribution of ‘bad’ values is to the right of the ‘good’ values. This suggests that more of this marker is prognostic of a bad outcome. Interestingly, whilst IP-10 was good at distinguishing the diseased/non-diseased states, it has less obvious use as a prognostic for outcomes. Meanwhile, sTNF-R1, which didn’t look very interesting before, looks like a decent prognostic.\nFor the following analyses, it’s a pain if any values cross zero, so to make our maths a bit easier, we’ll add a constant to the values. This has the effect of shifting everything to the right so that the minimum value is 1. Doing this also allows for log, square root and other transformations (but we won’t use those here, remembering that we are working towards a dipstick test and want linear responses. The constant is calculated by adding 1 plus the absolute value of the minimum estimated value to each value of Estimate.norm.\n\\(Estimate.adj = Estimate+(1+abs(min(Estimate)))\\)\n\nday0_stnfr1&lt;- filter(full_data,\n                     assay==\"stnf_r1\",\n                     cf_5_inpatient_outcome!=\"other_health_facility\",\n                     !is.na(cf_5_inpatient_outcome),\n                     timepoint==\"day0\"\n                     ) %&gt;%               \n              mutate(\n                    Estimate.norm.adj = Estimate.norm+(1+abs(min(Estimate.norm)))\n                    )\n\nggplot(day0_stnfr1,aes(Estimate.norm.adj,fill=cf_5_inpatient_outcome,alpha=0.3))+\n  geom_density(alpha=0.3)+\n    theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),\n          legend.position = c(0.8,0.8),\n          strip.background = element_blank(),\n          strip.placement='outside'\n          )\n\n\n\n\nThere’s better ways to look at how prognostic this type of measurement could be. Let’s try a ROC analysis, using the ROCit package. We’ll apply the rocit command to our sTNF-R1 data (day 0 only).\nWhen using a ROC analysis, you need to be careful to ensure that your outcome variable is a binary factor with the correct reference group. Here, we want to predict who is going to have a bad outcome, so good outcomes should be the reference point.\nWe also need to collapse the bad outcomes in to a single class “good” (discharged) or “bad” (palliative care / dead)\n\nday0_stnfr1 &lt;- day0_stnfr1 %&gt;% mutate(\n                                  outcome = as.factor(case_when(\n                                                      cf_5_inpatient_outcome == \"died\" ~ \"Bad\",\n                                                      cf_5_inpatient_outcome == \"discharged_pallative\" ~ \"Bad\",\n                                                      cf_5_inpatient_outcome == \"discharged\" ~ \"Good\"\n                                  )),\n                                    \n                                  outcome = relevel(as.factor(outcome), ref=\"Good\")\n                                  )\nsummary(day0_stnfr1$outcome)\n\nGood  Bad \n 717   66 \n\n\nNow that we have the correct reference group, we can run the ROC analysis.\n\nsummary(rocit(score=day0_stnfr1$Estimate.norm.adj,class=day0_stnfr1$outcome))\n\n                           \n Method used: empirical    \n Number of positive(s): 66 \n Number of negative(s): 717\n Area under curve: 0.5701  \n\n\nIt seems to be a reasonably good (but not great) prognostic as the area under the curve (a general indicator of overall performance across a range of threshold values) is somewhat greater than 0.5 (the toss of a coin odds of getting the class right).\n\n15.9.3.1 Function to draw ROC chart in ggplot\nROCit is a really neat package with lots of features, but doesn’t make ggplots. The following function makes a ggplot version of the ROC curves calculated with the rocit command\n\nROCit_plot&lt;-function(df){\n\n  roc.curve&lt;-tibble(\n    TPR=df$TPR,\n    FPR=df$FPR\n  )\n\n  p&lt;- ggplot(data = roc.curve,aes(FPR,TPR))+\n    geom_line()+\n    geom_abline(intercept = 0,slope = 1,lty=2)+\n    annotate(geom = \"text\", x = 0.8, y = 0.05, label = str_c(\"AUC = \", \n                                                             round(df$AUC,2),sep = \"\") \n            )\n    annotate(geom = \"text\", x = 0.8, y = 0.05, label = str_c(\"AUC = \", \n                                                             round(df$AUC,2),sep = \"\")\n             )\n  return(p)\n}\n\nLet’s now plot the ROC curve and visualise the overall performance of the test.\n\nROCit_plot(rocit(score=day0_stnfr1$Estimate.norm.adj,class=day0_stnfr1$outcome))\n\n\n\n\nTo use this data to inform the design of a rapid test, we’d need to find a cutoff value where we felt we got the best balance between sensitivity and specificity.\nLet’s get some values out of the ROC analysis, using an arbitrarily chosen threshold at 1.5 units of Estimate.norm.adj\n\nroc.stnfr1 &lt;- rocit(score=day0_stnfr1$Estimate.norm.adj,class=day0_stnfr1$outcome)\n\nIt is pretty simple to extract the sensitivity and specificity values for any threshold value.\n\ncutoff = 1.5\nstr_c(\"Cutoff = \",cutoff)\n\n[1] \"Cutoff = 1.5\"\n\nstr_c(\"Sensitivity = \",round(roc.stnfr1$TPR[max(which(roc.stnfr1$Cutoff&gt;cutoff))],3))\n\n[1] \"Sensitivity = 0.727\"\n\nstr_c(\"Specificity = \", round(1-(roc.stnfr1$FPR[max(which(roc.stnfr1$Cutoff&gt;cutoff))]),3))\n\n[1] \"Specificity = 0.331\"\n\n\nAs with basic diagnostics theory, if you increase the threshold, you get more specificity, whilst decreasing the threshold buys you more sensitivity. With different thresholds, you can see this in action\n\ncutoff = 1.1\n\n\nkable(\n  tibble(\n        Cutoff = c(1.1,1.4,1.75),\n        Sensitivity = c(round(roc.stnfr1$TPR[max(which(roc.stnfr1$Cutoff&gt;1.1))],3),\n                        round(roc.stnfr1$TPR[max(which(roc.stnfr1$Cutoff&gt;1.4))],3),\n                        round(roc.stnfr1$TPR[max(which(roc.stnfr1$Cutoff&gt;1.75))],3)),\n        Specificity = c(round(1-(roc.stnfr1$FPR[max(which(roc.stnfr1$Cutoff&gt;1.1))]),3),\n                        round(1-(roc.stnfr1$FPR[max(which(roc.stnfr1$Cutoff&gt;1.4))]),3),\n                        round(1-(roc.stnfr1$FPR[max(which(roc.stnfr1$Cutoff&gt;1.75))]),3))\n        )\n    )\n\n\n\n\nCutoff\nSensitivity\nSpecificity\n\n\n\n\n1.10\n0.985\n0.003\n\n\n1.40\n0.833\n0.188\n\n\n1.75\n0.485\n0.690\n\n\n\n\n\nPicking a cutoff is not a trivial pursuit and a lot of care and thought should go in to this.\nYour primary thought should be about how you plan to use the test. If you want a really specific test, then a high classification threshold is more appropriate. If you want a more sensitive test, then place the threshold lower down. Some situations may have reasons to avoid the extremes and to go for a threshold somewhere in the middle."
  },
  {
    "objectID": "appendix.html",
    "href": "appendix.html",
    "title": "16  Funding & Declarations",
    "section": "",
    "text": "17 Open Source License"
  },
  {
    "objectID": "appendix.html#funding",
    "href": "appendix.html#funding",
    "title": "16  Funding & Declarations",
    "section": "16.1 Funding",
    "text": "16.1 Funding\nThis work was funded by …"
  },
  {
    "objectID": "appendix.html#ethics-statement",
    "href": "appendix.html#ethics-statement",
    "title": "16  Funding & Declarations",
    "section": "16.2 Ethics statement",
    "text": "16.2 Ethics statement\nEthical approval for this study was granted by the ethics committee of the London School of Hygiene & Tropical Medicine, as well as the National Ethics Committee for Health Research of the Lao People's Democratic Republic (Lao PDR), where sample collection took place. Informed consent or assent was given by all participants, or their carers or guardians, as appropriate."
  },
  {
    "objectID": "CRediT.html#conceptualization",
    "href": "CRediT.html#conceptualization",
    "title": "17  CRediT Framework",
    "section": "17.1 Conceptualization",
    "text": "17.1 Conceptualization\nIdeas; formulation or evolution of overarching research goals and aims\nChrissy Roberts, Tegwen Marlais, Heidi Hopkins, David Mabey, Chris Drakeley - add others quique etc."
  },
  {
    "objectID": "CRediT.html#methodology",
    "href": "CRediT.html#methodology",
    "title": "17  CRediT Framework",
    "section": "17.2 Methodology",
    "text": "17.2 Methodology\nDevelopment or design of methodology; creation of models\nChrissy Roberts, Tegwen Marlais"
  },
  {
    "objectID": "CRediT.html#software",
    "href": "CRediT.html#software",
    "title": "17  CRediT Framework",
    "section": "17.3 Software",
    "text": "17.3 Software\nProgramming, software development; designing computer programs; implementation of the computer code and supporting algorithms; testing of existing code components\nChrissy Roberts, Tegwen Marlais"
  },
  {
    "objectID": "CRediT.html#validation",
    "href": "CRediT.html#validation",
    "title": "17  CRediT Framework",
    "section": "17.4 Validation",
    "text": "17.4 Validation\nVerification, whether as a part of the activity or separate, of the overall replication/ reproducibility of results/experiments and other research outputs\nChrissy Roberts, Tegwen Marlais"
  },
  {
    "objectID": "CRediT.html#formal-analysis",
    "href": "CRediT.html#formal-analysis",
    "title": "17  CRediT Framework",
    "section": "17.5 Formal Analysis",
    "text": "17.5 Formal Analysis\nApplication of statistical, mathematical, computational, or other formal techniques to analyze or synthesize study data\nChrissy Roberts, Tegwen Marlais"
  },
  {
    "objectID": "CRediT.html#investigation",
    "href": "CRediT.html#investigation",
    "title": "17  CRediT Framework",
    "section": "17.6 Investigation",
    "text": "17.6 Investigation\nConducting a research and investigation process, specifically performing the experiments, or data/evidence collection\nTegwen Marlais, Becca Handley"
  },
  {
    "objectID": "CRediT.html#resources",
    "href": "CRediT.html#resources",
    "title": "17  CRediT Framework",
    "section": "17.7 Resources",
    "text": "17.7 Resources\nProvision of study materials, reagents, materials, patients, laboratory samples, animals, instrumentation, computing resources, or other analysis tools\nChrissy Roberts, [Lao Clinical team names here]"
  },
  {
    "objectID": "CRediT.html#data-curation",
    "href": "CRediT.html#data-curation",
    "title": "17  CRediT Framework",
    "section": "17.8 Data curation",
    "text": "17.8 Data curation\nManagement activities to annotate (produce metadata), scrub data and maintain research data (including software code, where it is necessary for interpreting the data itself) for initial use and later reuse\nSham Lal, Chrissy Roberts, Tegwen Marlais"
  },
  {
    "objectID": "CRediT.html#writing-original-draft",
    "href": "CRediT.html#writing-original-draft",
    "title": "17  CRediT Framework",
    "section": "17.9 Writing – Original Draft",
    "text": "17.9 Writing – Original Draft\nPreparation, creation and/or presentation of the published work, specifically writing the initial draft (including substantive translation)\nChrissy Roberts, Tegwen Marlais"
  },
  {
    "objectID": "CRediT.html#writing-review-editing",
    "href": "CRediT.html#writing-review-editing",
    "title": "17  CRediT Framework",
    "section": "17.10 Writing – Review & Editing",
    "text": "17.10 Writing – Review & Editing\nPreparation, creation and/or presentation of the published work by those from the original research group, specifically critical review, commentary or revision – including pre- or postpublication stages\nChrissy Roberts, Tegwen Marlais - add team"
  },
  {
    "objectID": "CRediT.html#visualization",
    "href": "CRediT.html#visualization",
    "title": "17  CRediT Framework",
    "section": "17.11 Visualization",
    "text": "17.11 Visualization\nPreparation, creation and/or presentation of the published work, specifically visualization/ data presentation\nChrissy Roberts, Tegwen Marlais"
  },
  {
    "objectID": "CRediT.html#supervision",
    "href": "CRediT.html#supervision",
    "title": "17  CRediT Framework",
    "section": "17.12 Supervision",
    "text": "17.12 Supervision\nOversight and leadership responsibility for the research activity planning and execution, including mentorship external to the core team\nChrissy Roberts, David Mabey, Chris Drakeley"
  },
  {
    "objectID": "CRediT.html#project-administration",
    "href": "CRediT.html#project-administration",
    "title": "17  CRediT Framework",
    "section": "17.13 Project Administration",
    "text": "17.13 Project Administration\nManagement and coordination responsibility for the research activity planning and execution\nChrissy Roberts, David Mabey, Heidi Hopkins, Becca Handley"
  },
  {
    "objectID": "CRediT.html#funding-acquisition",
    "href": "CRediT.html#funding-acquisition",
    "title": "17  CRediT Framework",
    "section": "17.14 Funding acquisition",
    "text": "17.14 Funding acquisition\nAcquisition of the financial support for the project leading to this publication.\n\n\n\n\nBrand, Amy, Liz Allen, Micah Altman, Marjorie Hlava, and Jo Scott. 2015. “Beyond Authorship: Attribution, Contribution, Collaboration, and Credit.” Learned Publishing 28 (2): 151–55. https://doi.org/10.1087/20150211."
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "References",
    "section": "",
    "text": "Brand, Amy, Liz Allen, Micah Altman, Marjorie Hlava, and Jo Scott. 2015.\n“Beyond Authorship: Attribution, Contribution, Collaboration, and\nCredit.” Learned Publishing 28 (2): 151–55. https://doi.org/10.1087/20150211.\n\n\nBrouwers, Judith, Rintis Noviyanti, Rob Fijnheer, Philip G. de Groot,\nLeily Trianty, Siti Mudaliana, Mark Roest, Din Syafruddin, Andre van der\nVen, and Quirijn de Mast. 2013. “Platelet Activation Determines\nAngiopoietin-1 and VEGF Levels in Malaria: Implications for Their Use as\nBiomarkers.” Edited by Ana Paula Arez. PLoS ONE 8 (6):\ne64850. https://doi.org/10.1371/journal.pone.0064850.\n\n\nFisher, J., and A. Linder. 2017. “Heparin-Binding\nProtein: A Key Player in the Pathophysiology of Organ Dysfunction in\nSepsis.” Journal of Internal Medicine 281 (6): 562–74.\nhttps://doi.org/10.1111/joim.12604.\n\n\nHayney, Mary S., Kelsey M. Henriquez, Jodi H. Barnet, Tola Ewers,\nHeather M. Champion, Sean Flannery, and Bruce Barrett. 2017.\n“Serum IFN-γ-Induced Protein 10 (IP-10) as a Biomarker for\nSeverity of Acute Respiratory Infection in Healthy Adults.”\nJournal of Clinical Virology 90 (May): 32–37. https://doi.org/10.1016/j.jcv.2017.03.003.\n\n\nKim, Minah, Breanna Allen, Emilia A. Korhonen, Maximilian Nitschké, Hee\nWon Yang, Peter Baluk, Pipsa Saharinen, et al. 2016. “Opposing\nActions of Angiopoietin-2 on Tie2 Signaling and FOXO1\nActivation.” Journal of Clinical Investigation 126 (9):\n3511–25. https://doi.org/10.1172/jci84871.\n\n\nLei, Jie, Xiaowan Yin, Hong Shang, and Yongjun Jiang. 2019. “IP-10\nIs Highly Involved in HIV Infection.” Cytokine 115\n(March): 97–103. https://doi.org/10.1016/j.cyto.2018.11.018.\n\n\nLeligdowicz, Aleksandra, Melissa Richard-Greenblatt, Julie Wright,\nValerie M. Crowley, and Kevin C. Kain. 2018. “Endothelial\nActivation: The Ang/Tie Axis in Sepsis.” Frontiers in\nImmunology 9 (April). https://doi.org/10.3389/fimmu.2018.00838.\n\n\nMatsushima, Kouji, De Yang, and Joost J. Oppenheim. 2022.\n“Interleukin-8: An Evolving Chemokine.” Cytokine\n153 (May): 155828. https://doi.org/10.1016/j.cyto.2022.155828.\n\n\nZhao, Ting, Zhongping Su, Yingchang Li, Xiaoren Zhang, and Qiang You.\n2020. “Chitinase-3 Like-Protein-1 Function and Its Role in\nDiseases.” Signal Transduction and Targeted Therapy 5\n(1). https://doi.org/10.1038/s41392-020-00303-7."
  }
]